seed [1995]
devices_type ['1']
2025-11-07 00:21:10,582 [trainer.py] => config: ./exps/sdfourierft_inr.json
2025-11-07 00:21:10,582 [trainer.py] => seed: 1995
2025-11-07 00:21:10,582 [trainer.py] => prefix: reproduce
2025-11-07 00:21:10,582 [trainer.py] => dataset: imagenetr
2025-11-07 00:21:10,582 [trainer.py] => memory_size: 0
2025-11-07 00:21:10,582 [trainer.py] => memory_per_class: 0
2025-11-07 00:21:10,582 [trainer.py] => fixed_memory: False
2025-11-07 00:21:10,582 [trainer.py] => shuffle: True
2025-11-07 00:21:10,582 [trainer.py] => init_cls: 20
2025-11-07 00:21:10,582 [trainer.py] => increment: 20
2025-11-07 00:21:10,582 [trainer.py] => model_name: fourierft
2025-11-07 00:21:10,582 [trainer.py] => backbone_type: vit_base_patch16_224
2025-11-07 00:21:10,582 [trainer.py] => device: [device(type='cuda', index=1)]
2025-11-07 00:21:10,582 [trainer.py] => optimizer: adam
2025-11-07 00:21:10,582 [trainer.py] => scheduler: cosine
2025-11-07 00:21:10,582 [trainer.py] => filepath: ./data/imagenet-r
2025-11-07 00:21:10,582 [trainer.py] => init_epoch: 40
2025-11-07 00:21:10,582 [trainer.py] => init_lr: 0.01
2025-11-07 00:21:10,582 [trainer.py] => init_milestones: [10000]
2025-11-07 00:21:10,582 [trainer.py] => init_lr_decay: 0
2025-11-07 00:21:10,583 [trainer.py] => init_weight_decay: 0.0005
2025-11-07 00:21:10,583 [trainer.py] => epochs: 40
2025-11-07 00:21:10,583 [trainer.py] => lrate: 0.01
2025-11-07 00:21:10,583 [trainer.py] => milestones: [10000]
2025-11-07 00:21:10,583 [trainer.py] => lrate_decay: 0
2025-11-07 00:21:10,583 [trainer.py] => batch_size: 128
2025-11-07 00:21:10,583 [trainer.py] => weight_decay: 0.0002
2025-11-07 00:21:10,583 [trainer.py] => fourierft: {'n_frequency': 500, 'n_frequency_non_trainable': 0, 'scaling': 150.0, 'random_loc_seed': 42, 'init_weights': False, 'prefer': True, 'init_fc': 1, 'fourier_layer': None, 'target_modules': ['q', 'v'], 'bias': 'none', 'modules_to_save': ['classifier'], 'layers_to_transform': None, 'layers_pattern': None, 'n_frequency_pattern': {}, 'fan_in_fan_out': False}
2025-11-07 00:21:10,583 [trainer.py] => indices_file_path: ./results/fourierft_imagenetr
2025-11-07 00:21:10,583 [trainer.py] => reinit_num: 50
2025-11-07 00:21:10,583 [trainer.py] => round_number: 0
2025-11-07 00:21:10,583 [trainer.py] => task_specific_branches: True
2025-11-07 00:21:10,583 [trainer.py] => avoid_index_overlap: True
2025-11-07 00:21:10,583 [trainer.py] => merge_strategy: max
2025-11-07 00:21:10,583 [trainer.py] => merge_adapters: True
2025-11-07 00:21:10,583 [trainer.py] => dynamic_n_frequency: True
2025-11-07 00:21:10,636 [data_manager.py] => [146, 198, 169, 126, 142, 183, 108, 86, 79, 35, 112, 29, 0, 2, 59, 178, 143, 31, 147, 33, 123, 114, 194, 54, 138, 75, 158, 26, 131, 141, 180, 132, 22, 49, 116, 111, 24, 98, 107, 89, 151, 83, 185, 15, 27, 136, 65, 1, 82, 87, 99, 153, 47, 144, 145, 175, 155, 77, 191, 199, 46, 28, 76, 71, 93, 137, 5, 188, 187, 74, 103, 173, 18, 80, 88, 48, 109, 81, 91, 101, 43, 102, 61, 182, 3, 14, 40, 42, 167, 66, 57, 73, 135, 39, 45, 184, 161, 85, 148, 121, 8, 195, 21, 4, 106, 133, 118, 10, 176, 50, 36, 192, 162, 172, 96, 197, 20, 117, 140, 186, 92, 97, 44, 149, 13, 37, 170, 25, 181, 171, 23, 104, 189, 11, 159, 67, 94, 68, 55, 6, 150, 165, 120, 139, 72, 154, 115, 125, 53, 58, 16, 113, 41, 190, 174, 127, 110, 7, 38, 32, 95, 19, 196, 51, 78, 34, 122, 152, 119, 134, 129, 130, 128, 17, 30, 90, 124, 160, 100, 193, 12, 56, 64, 168, 105, 63, 177, 70, 60, 163, 9, 62, 156, 52, 84, 157, 69, 179, 166, 164]
!!!!!!! multiple_gpus [device(type='cuda', index=1)]
This is for the BaseNet initialization.
2025-11-07 00:21:12,053 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-11-07 00:21:12,736 [_client.py] => HTTP Request: HEAD https://huggingface.co/timm/vit_base_patch16_224.augreg2_in21k_ft_in1k/resolve/main/model.safetensors "HTTP/1.1 302 Found"
2025-11-07 00:21:12,738 [_hub.py] => [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
save_file ./results/fourierft_imagenetr
After BaseNet initialization.
task 0
2025-11-07 00:21:13,176 [sdfourier.py] => Learning on 0-20

  0%|          | 0/40 [00:00<?, ?it/s]
Task 0, Epoch 1/40 => Loss 2.041, Train_accy 45.27, Test_accy 79.58:   0%|          | 0/40 [00:13<?, ?it/s]
Task 0, Epoch 1/40 => Loss 2.041, Train_accy 45.27, Test_accy 79.58:   2%|▎         | 1/40 [00:13<08:35, 13.22s/it]
Task 0, Epoch 2/40 => Loss 0.909, Train_accy 73.79:   2%|▎         | 1/40 [00:24<08:35, 13.22s/it]                 
Task 0, Epoch 2/40 => Loss 0.909, Train_accy 73.79:   5%|▌         | 2/40 [00:24<07:37, 12.05s/it]
Task 0, Epoch 3/40 => Loss 0.681, Train_accy 80.05:   5%|▌         | 2/40 [00:35<07:37, 12.05s/it]
Task 0, Epoch 3/40 => Loss 0.681, Train_accy 80.05:   8%|▊         | 3/40 [00:35<07:08, 11.58s/it]
Task 0, Epoch 4/40 => Loss 0.613, Train_accy 82.17:   8%|▊         | 3/40 [00:47<07:08, 11.58s/it]
Task 0, Epoch 4/40 => Loss 0.613, Train_accy 82.17:  10%|█         | 4/40 [00:47<07:00, 11.68s/it]
Task 0, Epoch 5/40 => Loss 0.587, Train_accy 83.33:  10%|█         | 4/40 [00:58<07:00, 11.68s/it]
Task 0, Epoch 5/40 => Loss 0.587, Train_accy 83.33:  12%|█▎        | 5/40 [00:58<06:41, 11.48s/it]
Task 0, Epoch 6/40 => Loss 0.578, Train_accy 83.98, Test_accy 85.74:  12%|█▎        | 5/40 [01:12<06:41, 11.48s/it]
Task 0, Epoch 6/40 => Loss 0.578, Train_accy 83.98, Test_accy 85.74:  15%|█▌        | 6/40 [01:12<06:54, 12.19s/it]
Task 0, Epoch 7/40 => Loss 0.520, Train_accy 84.91:  15%|█▌        | 6/40 [01:23<06:54, 12.19s/it]                 
Task 0, Epoch 7/40 => Loss 0.520, Train_accy 84.91:  18%|█▊        | 7/40 [01:23<06:30, 11.83s/it]
Task 0, Epoch 8/40 => Loss 0.515, Train_accy 85.14:  18%|█▊        | 7/40 [01:34<06:30, 11.83s/it]
Task 0, Epoch 8/40 => Loss 0.515, Train_accy 85.14:  20%|██        | 8/40 [01:34<06:11, 11.60s/it]
Task 0, Epoch 9/40 => Loss 0.481, Train_accy 86.30:  20%|██        | 8/40 [01:45<06:11, 11.60s/it]
Task 0, Epoch 9/40 => Loss 0.481, Train_accy 86.30:  22%|██▎       | 9/40 [01:45<05:54, 11.45s/it]
Task 0, Epoch 10/40 => Loss 0.472, Train_accy 86.26:  22%|██▎       | 9/40 [01:56<05:54, 11.45s/it]
Task 0, Epoch 10/40 => Loss 0.472, Train_accy 86.26:  25%|██▌       | 10/40 [01:56<05:40, 11.34s/it]
Task 0, Epoch 11/40 => Loss 0.475, Train_accy 86.95, Test_accy 84.93:  25%|██▌       | 10/40 [02:09<05:40, 11.34s/it]
Task 0, Epoch 11/40 => Loss 0.475, Train_accy 86.95, Test_accy 84.93:  28%|██▊       | 11/40 [02:09<05:44, 11.88s/it]
Task 0, Epoch 12/40 => Loss 0.438, Train_accy 87.88:  28%|██▊       | 11/40 [02:20<05:44, 11.88s/it]                 
Task 0, Epoch 12/40 => Loss 0.438, Train_accy 87.88:  30%|███       | 12/40 [02:20<05:27, 11.69s/it]
Task 0, Epoch 13/40 => Loss 0.423, Train_accy 88.07:  30%|███       | 12/40 [02:31<05:27, 11.69s/it]
Task 0, Epoch 13/40 => Loss 0.423, Train_accy 88.07:  32%|███▎      | 13/40 [02:31<05:10, 11.51s/it]
Task 0, Epoch 14/40 => Loss 0.443, Train_accy 87.03:  32%|███▎      | 13/40 [02:42<05:10, 11.51s/it]
Task 0, Epoch 14/40 => Loss 0.443, Train_accy 87.03:  35%|███▌      | 14/40 [02:42<04:56, 11.39s/it]
Task 0, Epoch 15/40 => Loss 0.431, Train_accy 88.11:  35%|███▌      | 14/40 [02:54<04:56, 11.39s/it]
Task 0, Epoch 15/40 => Loss 0.431, Train_accy 88.11:  38%|███▊      | 15/40 [02:54<04:44, 11.36s/it]
Task 0, Epoch 16/40 => Loss 0.380, Train_accy 88.85, Test_accy 85.25:  38%|███▊      | 15/40 [03:07<04:44, 11.36s/it]
Task 0, Epoch 16/40 => Loss 0.380, Train_accy 88.85, Test_accy 85.25:  40%|████      | 16/40 [03:07<04:45, 11.90s/it]
Task 0, Epoch 17/40 => Loss 0.388, Train_accy 88.81:  40%|████      | 16/40 [03:18<04:45, 11.90s/it]                 
Task 0, Epoch 17/40 => Loss 0.388, Train_accy 88.81:  42%|████▎     | 17/40 [03:18<04:28, 11.68s/it]
Task 0, Epoch 18/40 => Loss 0.372, Train_accy 89.23:  42%|████▎     | 17/40 [03:29<04:28, 11.68s/it]
Task 0, Epoch 18/40 => Loss 0.372, Train_accy 89.23:  45%|████▌     | 18/40 [03:29<04:13, 11.51s/it]
Task 0, Epoch 19/40 => Loss 0.374, Train_accy 89.81:  45%|████▌     | 18/40 [03:40<04:13, 11.51s/it]
Task 0, Epoch 19/40 => Loss 0.374, Train_accy 89.81:  48%|████▊     | 19/40 [03:40<04:00, 11.44s/it]
Task 0, Epoch 20/40 => Loss 0.392, Train_accy 88.81:  48%|████▊     | 19/40 [03:52<04:00, 11.44s/it]
Task 0, Epoch 20/40 => Loss 0.392, Train_accy 88.81:  50%|█████     | 20/40 [03:52<03:47, 11.35s/it]
Task 0, Epoch 21/40 => Loss 0.369, Train_accy 89.50, Test_accy 85.58:  50%|█████     | 20/40 [04:05<03:47, 11.35s/it]
Task 0, Epoch 21/40 => Loss 0.369, Train_accy 89.50, Test_accy 85.58:  52%|█████▎    | 21/40 [04:05<03:46, 11.91s/it]
Task 0, Epoch 22/40 => Loss 0.372, Train_accy 89.77:  52%|█████▎    | 21/40 [04:19<03:46, 11.91s/it]                 
Task 0, Epoch 22/40 => Loss 0.372, Train_accy 89.77:  55%|█████▌    | 22/40 [04:19<03:46, 12.59s/it]
Task 0, Epoch 23/40 => Loss 0.354, Train_accy 90.24:  55%|█████▌    | 22/40 [04:38<03:46, 12.59s/it]
Task 0, Epoch 23/40 => Loss 0.354, Train_accy 90.24:  57%|█████▊    | 23/40 [04:38<04:07, 14.57s/it]
Task 0, Epoch 24/40 => Loss 0.368, Train_accy 89.93:  57%|█████▊    | 23/40 [04:55<04:07, 14.57s/it]
Task 0, Epoch 24/40 => Loss 0.368, Train_accy 89.93:  60%|██████    | 24/40 [04:55<04:03, 15.19s/it]
Task 0, Epoch 25/40 => Loss 0.350, Train_accy 89.97:  60%|██████    | 24/40 [05:07<04:03, 15.19s/it]
Task 0, Epoch 25/40 => Loss 0.350, Train_accy 89.97:  62%|██████▎   | 25/40 [05:07<03:32, 14.17s/it]
Task 0, Epoch 26/40 => Loss 0.383, Train_accy 89.77, Test_accy 85.09:  62%|██████▎   | 25/40 [05:20<03:32, 14.17s/it]
Task 0, Epoch 26/40 => Loss 0.383, Train_accy 89.77, Test_accy 85.09:  65%|██████▌   | 26/40 [05:20<03:14, 13.88s/it]
Task 0, Epoch 27/40 => Loss 0.366, Train_accy 89.73:  65%|██████▌   | 26/40 [05:31<03:14, 13.88s/it]                 
Task 0, Epoch 27/40 => Loss 0.366, Train_accy 89.73:  68%|██████▊   | 27/40 [05:31<02:50, 13.13s/it]
Task 0, Epoch 28/40 => Loss 0.327, Train_accy 91.20:  68%|██████▊   | 27/40 [05:42<02:50, 13.13s/it]
Task 0, Epoch 28/40 => Loss 0.327, Train_accy 91.20:  70%|███████   | 28/40 [05:42<02:30, 12.57s/it]
Task 0, Epoch 29/40 => Loss 0.334, Train_accy 90.62:  70%|███████   | 28/40 [05:54<02:30, 12.57s/it]
Task 0, Epoch 29/40 => Loss 0.334, Train_accy 90.62:  72%|███████▎  | 29/40 [05:54<02:13, 12.15s/it]
Task 0, Epoch 30/40 => Loss 0.337, Train_accy 90.81:  72%|███████▎  | 29/40 [06:05<02:13, 12.15s/it]
Task 0, Epoch 30/40 => Loss 0.337, Train_accy 90.81:  75%|███████▌  | 30/40 [06:05<01:58, 11.86s/it]
Task 0, Epoch 31/40 => Loss 0.334, Train_accy 90.97, Test_accy 85.41:  75%|███████▌  | 30/40 [06:18<01:58, 11.86s/it]
Task 0, Epoch 31/40 => Loss 0.334, Train_accy 90.97, Test_accy 85.41:  78%|███████▊  | 31/40 [06:18<01:50, 12.30s/it]
Task 0, Epoch 32/40 => Loss 0.347, Train_accy 90.43:  78%|███████▊  | 31/40 [06:29<01:50, 12.30s/it]                 
Task 0, Epoch 32/40 => Loss 0.347, Train_accy 90.43:  80%|████████  | 32/40 [06:29<01:36, 12.00s/it]
Task 0, Epoch 33/40 => Loss 0.336, Train_accy 90.12:  80%|████████  | 32/40 [06:41<01:36, 12.00s/it]
Task 0, Epoch 33/40 => Loss 0.336, Train_accy 90.12:  82%|████████▎ | 33/40 [06:41<01:22, 11.73s/it]
Task 0, Epoch 34/40 => Loss 0.352, Train_accy 90.35:  82%|████████▎ | 33/40 [06:52<01:22, 11.73s/it]
Task 0, Epoch 34/40 => Loss 0.352, Train_accy 90.35:  85%|████████▌ | 34/40 [06:52<01:09, 11.55s/it]
Task 0, Epoch 35/40 => Loss 0.365, Train_accy 90.62:  85%|████████▌ | 34/40 [07:03<01:09, 11.55s/it]
Task 0, Epoch 35/40 => Loss 0.365, Train_accy 90.62:  88%|████████▊ | 35/40 [07:03<00:57, 11.43s/it]
Task 0, Epoch 36/40 => Loss 0.395, Train_accy 89.15, Test_accy 85.41:  88%|████████▊ | 35/40 [07:16<00:57, 11.43s/it]
Task 0, Epoch 36/40 => Loss 0.395, Train_accy 89.15, Test_accy 85.41:  90%|█████████ | 36/40 [07:16<00:47, 11.94s/it]
Task 0, Epoch 37/40 => Loss 0.380, Train_accy 89.31:  90%|█████████ | 36/40 [07:27<00:47, 11.94s/it]                 
Task 0, Epoch 37/40 => Loss 0.380, Train_accy 89.31:  92%|█████████▎| 37/40 [07:27<00:35, 11.71s/it]
Task 0, Epoch 38/40 => Loss 0.366, Train_accy 91.01:  92%|█████████▎| 37/40 [07:38<00:35, 11.71s/it]
Task 0, Epoch 38/40 => Loss 0.366, Train_accy 91.01:  95%|█████████▌| 38/40 [07:38<00:23, 11.58s/it]
Task 0, Epoch 39/40 => Loss 0.372, Train_accy 89.81:  95%|█████████▌| 38/40 [07:50<00:23, 11.58s/it]
Task 0, Epoch 39/40 => Loss 0.372, Train_accy 89.81:  98%|█████████▊| 39/40 [07:50<00:11, 11.45s/it]
Task 0, Epoch 40/40 => Loss 0.339, Train_accy 91.01:  98%|█████████▊| 39/40 [08:01<00:11, 11.45s/it]
Task 0, Epoch 40/40 => Loss 0.339, Train_accy 91.01: 100%|██████████| 40/40 [08:01<00:00, 11.35s/it]
Task 0, Epoch 40/40 => Loss 0.339, Train_accy 91.01: 100%|██████████| 40/40 [08:01<00:00, 12.03s/it]
2025-11-07 00:29:15,078 [sdfourier.py] => Task 0, Epoch 40/40 => Loss 0.339, Train_accy 91.01
2025-11-07 00:29:16,929 [sdfourier.py] => Task 0, After merge adapters => Test_accy 85.25
2025-11-07 00:29:16,930 [trainer.py] => All params: 185781668
2025-11-07 00:29:16,931 [trainer.py] => Trainable params: 28580
/mnt/weitao/SD-Lora-CL-main/utils/toolkit.py:60: RuntimeWarning: invalid value encountered in scalar divide
  (y_pred[idxes] == y_true[idxes]).sum() * 100 / len(idxes), decimals=2
2025-11-07 00:29:18,803 [trainer.py] => No NME accuracy.
2025-11-07 00:29:18,803 [trainer.py] => CNN: {'total': np.float64(85.25), '00-19': np.float64(85.25), 'old': np.float64(85.25), 'new': np.float64(nan)}
2025-11-07 00:29:18,803 [trainer.py] => CNN top1 curve: [np.float64(85.25)]
2025-11-07 00:29:18,803 [trainer.py] => CNN top5 curve: [np.float64(95.14)]

Average Accuracy (CNN): 85.25
2025-11-07 00:29:18,803 [trainer.py] => Average Accuracy (CNN): 85.25 

task 1
2025-11-07 00:29:18,804 [sdfourier.py] => Learning on 20-40

总共重置了 12 个模块的qkv层权重

  0%|          | 0/40 [00:00<?, ?it/s]
Task 1, Epoch 1/40 => Loss 2.067, Train_accy 28.94, Test_accy 74.87:   0%|          | 0/40 [00:08<?, ?it/s]
Task 1, Epoch 1/40 => Loss 2.067, Train_accy 28.94, Test_accy 74.87:   2%|▎         | 1/40 [00:08<05:32,  8.52s/it]
Task 1, Epoch 2/40 => Loss 0.851, Train_accy 65.09:   2%|▎         | 1/40 [00:13<05:32,  8.52s/it]                 
Task 1, Epoch 2/40 => Loss 0.851, Train_accy 65.09:   5%|▌         | 2/40 [00:13<04:11,  6.62s/it]
Task 1, Epoch 3/40 => Loss 0.690, Train_accy 70.27:   5%|▌         | 2/40 [00:19<04:11,  6.62s/it]
Task 1, Epoch 3/40 => Loss 0.690, Train_accy 70.27:   8%|▊         | 3/40 [00:19<03:44,  6.07s/it]
Task 1, Epoch 4/40 => Loss 0.674, Train_accy 72.07:   8%|▊         | 3/40 [00:24<03:44,  6.07s/it]
Task 1, Epoch 4/40 => Loss 0.674, Train_accy 72.07:  10%|█         | 4/40 [00:24<03:29,  5.82s/it]
Task 1, Epoch 5/40 => Loss 0.573, Train_accy 73.46:  10%|█         | 4/40 [00:29<03:29,  5.82s/it]
Task 1, Epoch 5/40 => Loss 0.573, Train_accy 73.46:  12%|█▎        | 5/40 [00:29<03:16,  5.61s/it]
Task 1, Epoch 6/40 => Loss 0.586, Train_accy 74.85, Test_accy 79.13:  12%|█▎        | 5/40 [00:38<03:16,  5.61s/it]
Task 1, Epoch 6/40 => Loss 0.586, Train_accy 74.85, Test_accy 79.13:  15%|█▌        | 6/40 [00:38<03:43,  6.58s/it]
Task 1, Epoch 7/40 => Loss 0.533, Train_accy 76.01:  15%|█▌        | 6/40 [00:44<03:43,  6.58s/it]                 
Task 1, Epoch 7/40 => Loss 0.533, Train_accy 76.01:  18%|█▊        | 7/40 [00:44<03:27,  6.28s/it]
Task 1, Epoch 8/40 => Loss 0.523, Train_accy 76.54:  18%|█▊        | 7/40 [00:49<03:27,  6.28s/it]
Task 1, Epoch 8/40 => Loss 0.523, Train_accy 76.54:  20%|██        | 8/40 [00:49<03:10,  5.96s/it]
Task 1, Epoch 9/40 => Loss 0.528, Train_accy 77.44:  20%|██        | 8/40 [00:54<03:10,  5.96s/it]
Task 1, Epoch 9/40 => Loss 0.528, Train_accy 77.44:  22%|██▎       | 9/40 [00:54<02:58,  5.77s/it]
Task 1, Epoch 10/40 => Loss 0.447, Train_accy 79.99:  22%|██▎       | 9/40 [00:59<02:58,  5.77s/it]
Task 1, Epoch 10/40 => Loss 0.447, Train_accy 79.99:  25%|██▌       | 10/40 [00:59<02:48,  5.61s/it]
Task 1, Epoch 11/40 => Loss 0.457, Train_accy 78.98, Test_accy 79.13:  25%|██▌       | 10/40 [01:08<02:48,  5.61s/it]
Task 1, Epoch 11/40 => Loss 0.457, Train_accy 78.98, Test_accy 79.13:  28%|██▊       | 11/40 [01:08<03:08,  6.50s/it]
Task 1, Epoch 12/40 => Loss 0.439, Train_accy 79.92:  28%|██▊       | 11/40 [01:13<03:08,  6.50s/it]                 
Task 1, Epoch 12/40 => Loss 0.439, Train_accy 79.92:  30%|███       | 12/40 [01:13<02:51,  6.14s/it]
Task 1, Epoch 13/40 => Loss 0.433, Train_accy 80.29:  30%|███       | 12/40 [01:18<02:51,  6.14s/it]
Task 1, Epoch 13/40 => Loss 0.433, Train_accy 80.29:  32%|███▎      | 13/40 [01:18<02:38,  5.87s/it]
Task 1, Epoch 14/40 => Loss 0.424, Train_accy 80.89:  32%|███▎      | 13/40 [01:24<02:38,  5.87s/it]
Task 1, Epoch 14/40 => Loss 0.424, Train_accy 80.89:  35%|███▌      | 14/40 [01:24<02:27,  5.68s/it]
Task 1, Epoch 15/40 => Loss 0.419, Train_accy 81.08:  35%|███▌      | 14/40 [01:29<02:27,  5.68s/it]
Task 1, Epoch 15/40 => Loss 0.419, Train_accy 81.08:  38%|███▊      | 15/40 [01:29<02:19,  5.57s/it]
Task 1, Epoch 16/40 => Loss 0.404, Train_accy 81.16, Test_accy 80.05:  38%|███▊      | 15/40 [01:37<02:19,  5.57s/it]
Task 1, Epoch 16/40 => Loss 0.404, Train_accy 81.16, Test_accy 80.05:  40%|████      | 16/40 [01:37<02:34,  6.43s/it]
Task 1, Epoch 17/40 => Loss 0.396, Train_accy 81.38:  40%|████      | 16/40 [01:43<02:34,  6.43s/it]                 
Task 1, Epoch 17/40 => Loss 0.396, Train_accy 81.38:  42%|████▎     | 17/40 [01:43<02:21,  6.16s/it]
Task 1, Epoch 18/40 => Loss 0.421, Train_accy 82.09:  42%|████▎     | 17/40 [01:51<02:21,  6.16s/it]
Task 1, Epoch 18/40 => Loss 0.421, Train_accy 82.09:  45%|████▌     | 18/40 [01:51<02:30,  6.83s/it]
Task 1, Epoch 19/40 => Loss 0.413, Train_accy 82.09:  45%|████▌     | 18/40 [02:00<02:30,  6.83s/it]
Task 1, Epoch 19/40 => Loss 0.413, Train_accy 82.09:  48%|████▊     | 19/40 [02:00<02:35,  7.42s/it]
Task 1, Epoch 20/40 => Loss 0.375, Train_accy 82.62:  48%|████▊     | 19/40 [02:09<02:35,  7.42s/it]
Task 1, Epoch 20/40 => Loss 0.375, Train_accy 82.62:  50%|█████     | 20/40 [02:09<02:36,  7.85s/it]
Task 1, Epoch 21/40 => Loss 0.390, Train_accy 82.17, Test_accy 79.44:  50%|█████     | 20/40 [02:21<02:36,  7.85s/it]
Task 1, Epoch 21/40 => Loss 0.390, Train_accy 82.17, Test_accy 79.44:  52%|█████▎    | 21/40 [02:21<02:52,  9.10s/it]
Task 1, Epoch 22/40 => Loss 0.377, Train_accy 83.37:  52%|█████▎    | 21/40 [02:26<02:52,  9.10s/it]                 
Task 1, Epoch 22/40 => Loss 0.377, Train_accy 83.37:  55%|█████▌    | 22/40 [02:26<02:23,  7.99s/it]
Task 1, Epoch 23/40 => Loss 0.395, Train_accy 82.02:  55%|█████▌    | 22/40 [02:32<02:23,  7.99s/it]
Task 1, Epoch 23/40 => Loss 0.395, Train_accy 82.02:  57%|█████▊    | 23/40 [02:32<02:02,  7.19s/it]
Task 1, Epoch 24/40 => Loss 0.392, Train_accy 82.81:  57%|█████▊    | 23/40 [02:37<02:02,  7.19s/it]
Task 1, Epoch 24/40 => Loss 0.392, Train_accy 82.81:  60%|██████    | 24/40 [02:37<01:46,  6.67s/it]
Task 1, Epoch 25/40 => Loss 0.356, Train_accy 83.78:  60%|██████    | 24/40 [02:43<01:46,  6.67s/it]
Task 1, Epoch 25/40 => Loss 0.356, Train_accy 83.78:  62%|██████▎   | 25/40 [02:43<01:33,  6.26s/it]
Task 1, Epoch 26/40 => Loss 0.377, Train_accy 83.18, Test_accy 79.82:  62%|██████▎   | 25/40 [02:51<01:33,  6.26s/it]
Task 1, Epoch 26/40 => Loss 0.377, Train_accy 83.18, Test_accy 79.82:  65%|██████▌   | 26/40 [02:51<01:37,  6.96s/it]
Task 1, Epoch 27/40 => Loss 0.386, Train_accy 82.02:  65%|██████▌   | 26/40 [02:57<01:37,  6.96s/it]                 
Task 1, Epoch 27/40 => Loss 0.386, Train_accy 82.02:  68%|██████▊   | 27/40 [02:57<01:24,  6.50s/it]
Task 1, Epoch 28/40 => Loss 0.349, Train_accy 84.16:  68%|██████▊   | 27/40 [03:02<01:24,  6.50s/it]
Task 1, Epoch 28/40 => Loss 0.349, Train_accy 84.16:  70%|███████   | 28/40 [03:02<01:13,  6.12s/it]
Task 1, Epoch 29/40 => Loss 0.350, Train_accy 84.23:  70%|███████   | 28/40 [03:07<01:13,  6.12s/it]
Task 1, Epoch 29/40 => Loss 0.350, Train_accy 84.23:  72%|███████▎  | 29/40 [03:07<01:04,  5.90s/it]
Task 1, Epoch 30/40 => Loss 0.347, Train_accy 83.33:  72%|███████▎  | 29/40 [03:13<01:04,  5.90s/it]
Task 1, Epoch 30/40 => Loss 0.347, Train_accy 83.33:  75%|███████▌  | 30/40 [03:13<00:57,  5.80s/it]
Task 1, Epoch 31/40 => Loss 0.356, Train_accy 84.76, Test_accy 80.35:  75%|███████▌  | 30/40 [03:21<00:57,  5.80s/it]
Task 1, Epoch 31/40 => Loss 0.356, Train_accy 84.76, Test_accy 80.35:  78%|███████▊  | 31/40 [03:21<00:59,  6.63s/it]
Task 1, Epoch 32/40 => Loss 0.363, Train_accy 84.16:  78%|███████▊  | 31/40 [03:27<00:59,  6.63s/it]                 
Task 1, Epoch 32/40 => Loss 0.363, Train_accy 84.16:  80%|████████  | 32/40 [03:27<00:50,  6.29s/it]
Task 1, Epoch 33/40 => Loss 0.332, Train_accy 84.72:  80%|████████  | 32/40 [03:32<00:50,  6.29s/it]
Task 1, Epoch 33/40 => Loss 0.332, Train_accy 84.72:  82%|████████▎ | 33/40 [03:32<00:42,  6.03s/it]
Task 1, Epoch 34/40 => Loss 0.333, Train_accy 83.56:  82%|████████▎ | 33/40 [03:38<00:42,  6.03s/it]
Task 1, Epoch 34/40 => Loss 0.333, Train_accy 83.56:  85%|████████▌ | 34/40 [03:38<00:34,  5.83s/it]
Task 1, Epoch 35/40 => Loss 0.357, Train_accy 83.82:  85%|████████▌ | 34/40 [03:43<00:34,  5.83s/it]
Task 1, Epoch 35/40 => Loss 0.357, Train_accy 83.82:  88%|████████▊ | 35/40 [03:43<00:28,  5.71s/it]
Task 1, Epoch 36/40 => Loss 0.370, Train_accy 83.00, Test_accy 80.05:  88%|████████▊ | 35/40 [03:52<00:28,  5.71s/it]
Task 1, Epoch 36/40 => Loss 0.370, Train_accy 83.00, Test_accy 80.05:  90%|█████████ | 36/40 [03:52<00:26,  6.58s/it]
Task 1, Epoch 37/40 => Loss 0.386, Train_accy 83.26:  90%|█████████ | 36/40 [03:57<00:26,  6.58s/it]                 
Task 1, Epoch 37/40 => Loss 0.386, Train_accy 83.26:  92%|█████████▎| 37/40 [03:57<00:18,  6.30s/it]
Task 1, Epoch 38/40 => Loss 0.342, Train_accy 85.10:  92%|█████████▎| 37/40 [04:03<00:18,  6.30s/it]
Task 1, Epoch 38/40 => Loss 0.342, Train_accy 85.10:  95%|█████████▌| 38/40 [04:03<00:12,  6.06s/it]
Task 1, Epoch 39/40 => Loss 0.337, Train_accy 84.05:  95%|█████████▌| 38/40 [04:08<00:12,  6.06s/it]
Task 1, Epoch 39/40 => Loss 0.337, Train_accy 84.05:  98%|█████████▊| 39/40 [04:08<00:05,  5.88s/it]
Task 1, Epoch 40/40 => Loss 0.348, Train_accy 83.67:  98%|█████████▊| 39/40 [04:14<00:05,  5.88s/it]
Task 1, Epoch 40/40 => Loss 0.348, Train_accy 83.67: 100%|██████████| 40/40 [04:14<00:00,  5.71s/it]
Task 1, Epoch 40/40 => Loss 0.348, Train_accy 83.67: 100%|██████████| 40/40 [04:14<00:00,  6.35s/it]
2025-11-07 00:33:33,271 [sdfourier.py] => Task 1, Epoch 40/40 => Loss 0.348, Train_accy 83.67
2025-11-07 00:33:36,271 [sdfourier.py] => Task 1, After merge adapters => Test_accy 80.05
2025-11-07 00:33:36,272 [trainer.py] => All params: 185811448
2025-11-07 00:33:36,273 [trainer.py] => Trainable params: 43960
2025-11-07 00:33:39,281 [trainer.py] => No NME accuracy.
2025-11-07 00:33:39,281 [trainer.py] => CNN: {'total': np.float64(80.05), '00-19': np.float64(77.96), '20-39': np.float64(81.9), 'old': np.float64(80.05), 'new': np.float64(nan)}
2025-11-07 00:33:39,281 [trainer.py] => CNN top1 curve: [np.float64(85.25), np.float64(80.05)]
2025-11-07 00:33:39,281 [trainer.py] => CNN top5 curve: [np.float64(95.14), np.float64(92.61)]

Average Accuracy (CNN): 82.65
2025-11-07 00:33:39,281 [trainer.py] => Average Accuracy (CNN): 82.65 

task 2
2025-11-07 00:33:39,282 [sdfourier.py] => Learning on 40-60

总共重置了 12 个模块的qkv层权重

  0%|          | 0/40 [00:00<?, ?it/s]
Task 2, Epoch 1/40 => Loss 1.998, Train_accy 20.05, Test_accy 72.70:   0%|          | 0/40 [00:09<?, ?it/s]
Task 2, Epoch 1/40 => Loss 1.998, Train_accy 20.05, Test_accy 72.70:   2%|▎         | 1/40 [00:09<06:17,  9.69s/it]
Task 2, Epoch 2/40 => Loss 0.795, Train_accy 61.00:   2%|▎         | 1/40 [00:14<06:17,  9.69s/it]                 
Task 2, Epoch 2/40 => Loss 0.795, Train_accy 61.00:   5%|▌         | 2/40 [00:14<04:29,  7.10s/it]
Task 2, Epoch 3/40 => Loss 0.646, Train_accy 64.90:   5%|▌         | 2/40 [00:20<04:29,  7.10s/it]
Task 2, Epoch 3/40 => Loss 0.646, Train_accy 64.90:   8%|▊         | 3/40 [00:20<03:54,  6.33s/it]
Task 2, Epoch 4/40 => Loss 0.604, Train_accy 68.45:   8%|▊         | 3/40 [00:25<03:54,  6.33s/it]
Task 2, Epoch 4/40 => Loss 0.604, Train_accy 68.45:  10%|█         | 4/40 [00:25<03:32,  5.90s/it]
Task 2, Epoch 5/40 => Loss 0.523, Train_accy 70.28:  10%|█         | 4/40 [00:30<03:32,  5.90s/it]
Task 2, Epoch 5/40 => Loss 0.523, Train_accy 70.28:  12%|█▎        | 5/40 [00:30<03:18,  5.66s/it]
Task 2, Epoch 6/40 => Loss 0.507, Train_accy 70.40, Test_accy 76.89:  12%|█▎        | 5/40 [00:40<03:18,  5.66s/it]
Task 2, Epoch 6/40 => Loss 0.507, Train_accy 70.40, Test_accy 76.89:  15%|█▌        | 6/40 [00:40<04:00,  7.08s/it]
Task 2, Epoch 7/40 => Loss 0.485, Train_accy 72.50:  15%|█▌        | 6/40 [00:45<04:00,  7.08s/it]                 
Task 2, Epoch 7/40 => Loss 0.485, Train_accy 72.50:  18%|█▊        | 7/40 [00:45<03:33,  6.48s/it]
Task 2, Epoch 8/40 => Loss 0.493, Train_accy 72.46:  18%|█▊        | 7/40 [00:51<03:33,  6.48s/it]
Task 2, Epoch 8/40 => Loss 0.493, Train_accy 72.46:  20%|██        | 8/40 [00:51<03:14,  6.08s/it]
Task 2, Epoch 9/40 => Loss 0.453, Train_accy 73.53:  20%|██        | 8/40 [00:56<03:14,  6.08s/it]
Task 2, Epoch 9/40 => Loss 0.453, Train_accy 73.53:  22%|██▎       | 9/40 [00:56<03:01,  5.87s/it]
Task 2, Epoch 10/40 => Loss 0.405, Train_accy 74.52:  22%|██▎       | 9/40 [01:01<03:01,  5.87s/it]
Task 2, Epoch 10/40 => Loss 0.405, Train_accy 74.52:  25%|██▌       | 10/40 [01:01<02:50,  5.69s/it]
Task 2, Epoch 11/40 => Loss 0.408, Train_accy 76.20, Test_accy 77.40:  25%|██▌       | 10/40 [01:11<02:50,  5.69s/it]
Task 2, Epoch 11/40 => Loss 0.408, Train_accy 76.20, Test_accy 77.40:  28%|██▊       | 11/40 [01:11<03:19,  6.88s/it]
Task 2, Epoch 12/40 => Loss 0.411, Train_accy 75.86:  28%|██▊       | 11/40 [01:16<03:19,  6.88s/it]                 
Task 2, Epoch 12/40 => Loss 0.411, Train_accy 75.86:  30%|███       | 12/40 [01:16<02:59,  6.41s/it]
Task 2, Epoch 13/40 => Loss 0.390, Train_accy 77.77:  30%|███       | 12/40 [01:22<02:59,  6.41s/it]
Task 2, Epoch 13/40 => Loss 0.390, Train_accy 77.77:  32%|███▎      | 13/40 [01:22<02:44,  6.08s/it]
Task 2, Epoch 14/40 => Loss 0.330, Train_accy 78.72:  32%|███▎      | 13/40 [01:27<02:44,  6.08s/it]
Task 2, Epoch 14/40 => Loss 0.330, Train_accy 78.72:  35%|███▌      | 14/40 [01:27<02:31,  5.82s/it]
Task 2, Epoch 15/40 => Loss 0.346, Train_accy 78.61:  35%|███▌      | 14/40 [01:32<02:31,  5.82s/it]
Task 2, Epoch 15/40 => Loss 0.346, Train_accy 78.61:  38%|███▊      | 15/40 [01:32<02:20,  5.63s/it]
Task 2, Epoch 16/40 => Loss 0.360, Train_accy 78.07, Test_accy 77.40:  38%|███▊      | 15/40 [01:42<02:20,  5.63s/it]
Task 2, Epoch 16/40 => Loss 0.360, Train_accy 78.07, Test_accy 77.40:  40%|████      | 16/40 [01:42<02:45,  6.88s/it]
Task 2, Epoch 17/40 => Loss 0.367, Train_accy 78.34:  40%|████      | 16/40 [01:47<02:45,  6.88s/it]                 
Task 2, Epoch 17/40 => Loss 0.367, Train_accy 78.34:  42%|████▎     | 17/40 [01:47<02:26,  6.37s/it]
Task 2, Epoch 18/40 => Loss 0.354, Train_accy 78.92:  42%|████▎     | 17/40 [01:52<02:26,  6.37s/it]
Task 2, Epoch 18/40 => Loss 0.354, Train_accy 78.92:  45%|████▌     | 18/40 [01:52<02:13,  6.06s/it]
Task 2, Epoch 19/40 => Loss 0.371, Train_accy 79.07:  45%|████▌     | 18/40 [01:57<02:13,  6.06s/it]
Task 2, Epoch 19/40 => Loss 0.371, Train_accy 79.07:  48%|████▊     | 19/40 [01:57<02:01,  5.79s/it]
Task 2, Epoch 20/40 => Loss 0.337, Train_accy 79.07:  48%|████▊     | 19/40 [02:03<02:01,  5.79s/it]
Task 2, Epoch 20/40 => Loss 0.337, Train_accy 79.07:  50%|█████     | 20/40 [02:03<01:54,  5.74s/it]
Task 2, Epoch 21/40 => Loss 0.337, Train_accy 79.72, Test_accy 77.60:  50%|█████     | 20/40 [02:13<01:54,  5.74s/it]
Task 2, Epoch 21/40 => Loss 0.337, Train_accy 79.72, Test_accy 77.60:  52%|█████▎    | 21/40 [02:13<02:11,  6.94s/it]
Task 2, Epoch 22/40 => Loss 0.321, Train_accy 81.17:  52%|█████▎    | 21/40 [02:18<02:11,  6.94s/it]                 
Task 2, Epoch 22/40 => Loss 0.321, Train_accy 81.17:  55%|█████▌    | 22/40 [02:18<01:55,  6.42s/it]
Task 2, Epoch 23/40 => Loss 0.330, Train_accy 80.25:  55%|█████▌    | 22/40 [02:23<01:55,  6.42s/it]
Task 2, Epoch 23/40 => Loss 0.330, Train_accy 80.25:  57%|█████▊    | 23/40 [02:23<01:43,  6.06s/it]
Task 2, Epoch 24/40 => Loss 0.347, Train_accy 80.52:  57%|█████▊    | 23/40 [02:28<01:43,  6.06s/it]
Task 2, Epoch 24/40 => Loss 0.347, Train_accy 80.52:  60%|██████    | 24/40 [02:28<01:32,  5.79s/it]
Task 2, Epoch 25/40 => Loss 0.325, Train_accy 80.21:  60%|██████    | 24/40 [02:34<01:32,  5.79s/it]
Task 2, Epoch 25/40 => Loss 0.325, Train_accy 80.21:  62%|██████▎   | 25/40 [02:34<01:24,  5.66s/it]
Task 2, Epoch 26/40 => Loss 0.326, Train_accy 81.09, Test_accy 77.45:  62%|██████▎   | 25/40 [02:43<01:24,  5.66s/it]
Task 2, Epoch 26/40 => Loss 0.326, Train_accy 81.09, Test_accy 77.45:  65%|██████▌   | 26/40 [02:43<01:36,  6.87s/it]
Task 2, Epoch 27/40 => Loss 0.334, Train_accy 80.67:  65%|██████▌   | 26/40 [02:49<01:36,  6.87s/it]                 
Task 2, Epoch 27/40 => Loss 0.334, Train_accy 80.67:  68%|██████▊   | 27/40 [02:49<01:22,  6.38s/it]
Task 2, Epoch 28/40 => Loss 0.320, Train_accy 81.13:  68%|██████▊   | 27/40 [02:54<01:22,  6.38s/it]
Task 2, Epoch 28/40 => Loss 0.320, Train_accy 81.13:  70%|███████   | 28/40 [02:54<01:12,  6.02s/it]
Task 2, Epoch 29/40 => Loss 0.324, Train_accy 81.28:  70%|███████   | 28/40 [02:59<01:12,  6.02s/it]
Task 2, Epoch 29/40 => Loss 0.324, Train_accy 81.28:  72%|███████▎  | 29/40 [02:59<01:03,  5.76s/it]
Task 2, Epoch 30/40 => Loss 0.327, Train_accy 80.90:  72%|███████▎  | 29/40 [03:04<01:03,  5.76s/it]
Task 2, Epoch 30/40 => Loss 0.327, Train_accy 80.90:  75%|███████▌  | 30/40 [03:04<00:56,  5.65s/it]
Task 2, Epoch 31/40 => Loss 0.331, Train_accy 80.40, Test_accy 77.65:  75%|███████▌  | 30/40 [03:17<00:56,  5.65s/it]
Task 2, Epoch 31/40 => Loss 0.331, Train_accy 80.40, Test_accy 77.65:  78%|███████▊  | 31/40 [03:17<01:10,  7.78s/it]
Task 2, Epoch 32/40 => Loss 0.338, Train_accy 80.83:  78%|███████▊  | 31/40 [03:26<01:10,  7.78s/it]                 
Task 2, Epoch 32/40 => Loss 0.338, Train_accy 80.83:  80%|████████  | 32/40 [03:26<01:04,  8.05s/it]
Task 2, Epoch 33/40 => Loss 0.316, Train_accy 80.48:  80%|████████  | 32/40 [03:35<01:04,  8.05s/it]
Task 2, Epoch 33/40 => Loss 0.316, Train_accy 80.48:  82%|████████▎ | 33/40 [03:35<00:57,  8.25s/it]
Task 2, Epoch 34/40 => Loss 0.333, Train_accy 81.09:  82%|████████▎ | 33/40 [03:43<00:57,  8.25s/it]
Task 2, Epoch 34/40 => Loss 0.333, Train_accy 81.09:  85%|████████▌ | 34/40 [03:43<00:50,  8.40s/it]
Task 2, Epoch 35/40 => Loss 0.319, Train_accy 81.09:  85%|████████▌ | 34/40 [03:49<00:50,  8.40s/it]
Task 2, Epoch 35/40 => Loss 0.319, Train_accy 81.09:  88%|████████▊ | 35/40 [03:49<00:38,  7.72s/it]
Task 2, Epoch 36/40 => Loss 0.293, Train_accy 82.43, Test_accy 77.45:  88%|████████▊ | 35/40 [03:59<00:38,  7.72s/it]
Task 2, Epoch 36/40 => Loss 0.293, Train_accy 82.43, Test_accy 77.45:  90%|█████████ | 36/40 [03:59<00:33,  8.33s/it]
Task 2, Epoch 37/40 => Loss 0.298, Train_accy 81.74:  90%|█████████ | 36/40 [04:05<00:33,  8.33s/it]                 
Task 2, Epoch 37/40 => Loss 0.298, Train_accy 81.74:  92%|█████████▎| 37/40 [04:05<00:22,  7.46s/it]
Task 2, Epoch 38/40 => Loss 0.290, Train_accy 80.63:  92%|█████████▎| 37/40 [04:10<00:22,  7.46s/it]
Task 2, Epoch 38/40 => Loss 0.290, Train_accy 80.63:  95%|█████████▌| 38/40 [04:10<00:13,  6.86s/it]
Task 2, Epoch 39/40 => Loss 0.319, Train_accy 80.71:  95%|█████████▌| 38/40 [04:15<00:13,  6.86s/it]
Task 2, Epoch 39/40 => Loss 0.319, Train_accy 80.71:  98%|█████████▊| 39/40 [04:15<00:06,  6.37s/it]
Task 2, Epoch 40/40 => Loss 0.301, Train_accy 81.55:  98%|█████████▊| 39/40 [04:21<00:06,  6.37s/it]
Task 2, Epoch 40/40 => Loss 0.301, Train_accy 81.55: 100%|██████████| 40/40 [04:21<00:00,  6.04s/it]
Task 2, Epoch 40/40 => Loss 0.301, Train_accy 81.55: 100%|██████████| 40/40 [04:21<00:00,  6.53s/it]
2025-11-07 00:38:00,833 [sdfourier.py] => Task 2, Epoch 40/40 => Loss 0.301, Train_accy 81.55
2025-11-07 00:38:04,850 [sdfourier.py] => Task 2, After merge adapters => Test_accy 77.24
2025-11-07 00:38:04,851 [trainer.py] => All params: 185842428
2025-11-07 00:38:04,852 [trainer.py] => Trainable params: 59340
2025-11-07 00:38:08,730 [trainer.py] => No NME accuracy.
2025-11-07 00:38:08,730 [trainer.py] => CNN: {'total': np.float64(77.24), '00-19': np.float64(74.23), '20-39': np.float64(78.59), '40-59': np.float64(78.67), 'old': np.float64(77.24), 'new': np.float64(nan)}
2025-11-07 00:38:08,730 [trainer.py] => CNN top1 curve: [np.float64(85.25), np.float64(80.05), np.float64(77.24)]
2025-11-07 00:38:08,730 [trainer.py] => CNN top5 curve: [np.float64(95.14), np.float64(92.61), np.float64(90.92)]

Average Accuracy (CNN): 80.84666666666668
2025-11-07 00:38:08,730 [trainer.py] => Average Accuracy (CNN): 80.84666666666668 

task 3
2025-11-07 00:38:08,731 [sdfourier.py] => Learning on 60-80

总共重置了 12 个模块的qkv层权重

  0%|          | 0/40 [00:00<?, ?it/s]
Task 3, Epoch 1/40 => Loss 2.068, Train_accy 14.09, Test_accy 68.75:   0%|          | 0/40 [00:10<?, ?it/s]
Task 3, Epoch 1/40 => Loss 2.068, Train_accy 14.09, Test_accy 68.75:   2%|▎         | 1/40 [00:10<07:00, 10.79s/it]
Task 3, Epoch 2/40 => Loss 0.846, Train_accy 49.14:   2%|▎         | 1/40 [00:16<07:00, 10.79s/it]                 
Task 3, Epoch 2/40 => Loss 0.846, Train_accy 49.14:   5%|▌         | 2/40 [00:16<04:47,  7.56s/it]
Task 3, Epoch 3/40 => Loss 0.653, Train_accy 57.27:   5%|▌         | 2/40 [00:21<04:47,  7.56s/it]
Task 3, Epoch 3/40 => Loss 0.653, Train_accy 57.27:   8%|▊         | 3/40 [00:21<04:01,  6.51s/it]
Task 3, Epoch 4/40 => Loss 0.603, Train_accy 59.18:   8%|▊         | 3/40 [00:26<04:01,  6.51s/it]
Task 3, Epoch 4/40 => Loss 0.603, Train_accy 59.18:  10%|█         | 4/40 [00:26<03:39,  6.10s/it]
Task 3, Epoch 5/40 => Loss 0.523, Train_accy 61.88:  10%|█         | 4/40 [00:32<03:39,  6.10s/it]
Task 3, Epoch 5/40 => Loss 0.523, Train_accy 61.88:  12%|█▎        | 5/40 [00:32<03:23,  5.82s/it]
Task 3, Epoch 6/40 => Loss 0.526, Train_accy 61.88, Test_accy 73.01:  12%|█▎        | 5/40 [00:42<03:23,  5.82s/it]
Task 3, Epoch 6/40 => Loss 0.526, Train_accy 61.88, Test_accy 73.01:  15%|█▌        | 6/40 [00:42<04:15,  7.51s/it]
Task 3, Epoch 7/40 => Loss 0.509, Train_accy 62.97:  15%|█▌        | 6/40 [00:48<04:15,  7.51s/it]                 
Task 3, Epoch 7/40 => Loss 0.509, Train_accy 62.97:  18%|█▊        | 7/40 [00:48<03:44,  6.80s/it]
Task 3, Epoch 8/40 => Loss 0.499, Train_accy 62.44:  18%|█▊        | 7/40 [00:53<03:44,  6.80s/it]
Task 3, Epoch 8/40 => Loss 0.499, Train_accy 62.44:  20%|██        | 8/40 [00:53<03:23,  6.35s/it]
Task 3, Epoch 9/40 => Loss 0.496, Train_accy 64.62:  20%|██        | 8/40 [00:59<03:23,  6.35s/it]
Task 3, Epoch 9/40 => Loss 0.496, Train_accy 64.62:  22%|██▎       | 9/40 [00:59<03:08,  6.08s/it]
Task 3, Epoch 10/40 => Loss 0.455, Train_accy 65.85:  22%|██▎       | 9/40 [01:04<03:08,  6.08s/it]
Task 3, Epoch 10/40 => Loss 0.455, Train_accy 65.85:  25%|██▌       | 10/40 [01:04<02:56,  5.87s/it]
Task 3, Epoch 11/40 => Loss 0.428, Train_accy 65.40, Test_accy 73.85:  25%|██▌       | 10/40 [01:15<02:56,  5.87s/it]
Task 3, Epoch 11/40 => Loss 0.428, Train_accy 65.40, Test_accy 73.85:  28%|██▊       | 11/40 [01:15<03:36,  7.46s/it]
Task 3, Epoch 12/40 => Loss 0.439, Train_accy 67.20:  28%|██▊       | 11/40 [01:20<03:36,  7.46s/it]                 
Task 3, Epoch 12/40 => Loss 0.439, Train_accy 67.20:  30%|███       | 12/40 [01:20<03:10,  6.82s/it]
Task 3, Epoch 13/40 => Loss 0.413, Train_accy 67.54:  30%|███       | 12/40 [01:26<03:10,  6.82s/it]
Task 3, Epoch 13/40 => Loss 0.413, Train_accy 67.54:  32%|███▎      | 13/40 [01:26<02:52,  6.38s/it]
Task 3, Epoch 14/40 => Loss 0.398, Train_accy 68.93:  32%|███▎      | 13/40 [01:31<02:52,  6.38s/it]
Task 3, Epoch 14/40 => Loss 0.398, Train_accy 68.93:  35%|███▌      | 14/40 [01:31<02:38,  6.08s/it]
Task 3, Epoch 15/40 => Loss 0.385, Train_accy 69.23:  35%|███▌      | 14/40 [01:37<02:38,  6.08s/it]
Task 3, Epoch 15/40 => Loss 0.385, Train_accy 69.23:  38%|███▊      | 15/40 [01:37<02:27,  5.90s/it]
Task 3, Epoch 16/40 => Loss 0.383, Train_accy 69.08, Test_accy 73.81:  38%|███▊      | 15/40 [01:48<02:27,  5.90s/it]
Task 3, Epoch 16/40 => Loss 0.383, Train_accy 69.08, Test_accy 73.81:  40%|████      | 16/40 [01:48<02:57,  7.40s/it]
Task 3, Epoch 17/40 => Loss 0.365, Train_accy 70.88:  40%|████      | 16/40 [01:53<02:57,  7.40s/it]                 
Task 3, Epoch 17/40 => Loss 0.365, Train_accy 70.88:  42%|████▎     | 17/40 [01:53<02:36,  6.79s/it]
Task 3, Epoch 18/40 => Loss 0.408, Train_accy 68.74:  42%|████▎     | 17/40 [01:58<02:36,  6.79s/it]
Task 3, Epoch 18/40 => Loss 0.408, Train_accy 68.74:  45%|████▌     | 18/40 [01:58<02:19,  6.36s/it]
Task 3, Epoch 19/40 => Loss 0.358, Train_accy 70.95:  45%|████▌     | 18/40 [02:04<02:19,  6.36s/it]
Task 3, Epoch 19/40 => Loss 0.358, Train_accy 70.95:  48%|████▊     | 19/40 [02:04<02:07,  6.07s/it]
Task 3, Epoch 20/40 => Loss 0.380, Train_accy 70.39:  48%|████▊     | 19/40 [02:09<02:07,  6.07s/it]
Task 3, Epoch 20/40 => Loss 0.380, Train_accy 70.39:  50%|█████     | 20/40 [02:09<01:57,  5.87s/it]
Task 3, Epoch 21/40 => Loss 0.359, Train_accy 70.73, Test_accy 74.00:  50%|█████     | 20/40 [02:20<01:57,  5.87s/it]
Task 3, Epoch 21/40 => Loss 0.359, Train_accy 70.73, Test_accy 74.00:  52%|█████▎    | 21/40 [02:20<02:20,  7.37s/it]
Task 3, Epoch 22/40 => Loss 0.377, Train_accy 70.65:  52%|█████▎    | 21/40 [02:25<02:20,  7.37s/it]                 
Task 3, Epoch 22/40 => Loss 0.377, Train_accy 70.65:  55%|█████▌    | 22/40 [02:25<02:01,  6.78s/it]
Task 3, Epoch 23/40 => Loss 0.334, Train_accy 71.48:  55%|█████▌    | 22/40 [02:31<02:01,  6.78s/it]
Task 3, Epoch 23/40 => Loss 0.334, Train_accy 71.48:  57%|█████▊    | 23/40 [02:31<01:48,  6.37s/it]
Task 3, Epoch 24/40 => Loss 0.385, Train_accy 70.05:  57%|█████▊    | 23/40 [02:36<01:48,  6.37s/it]
Task 3, Epoch 24/40 => Loss 0.385, Train_accy 70.05:  60%|██████    | 24/40 [02:36<01:37,  6.08s/it]
Task 3, Epoch 25/40 => Loss 0.336, Train_accy 71.21:  60%|██████    | 24/40 [02:42<01:37,  6.08s/it]
Task 3, Epoch 25/40 => Loss 0.336, Train_accy 71.21:  62%|██████▎   | 25/40 [02:42<01:28,  5.88s/it]
Task 3, Epoch 26/40 => Loss 0.333, Train_accy 72.56, Test_accy 73.96:  62%|██████▎   | 25/40 [02:52<01:28,  5.88s/it]
Task 3, Epoch 26/40 => Loss 0.333, Train_accy 72.56, Test_accy 73.96:  65%|██████▌   | 26/40 [02:52<01:43,  7.36s/it]
Task 3, Epoch 27/40 => Loss 0.360, Train_accy 71.06:  65%|██████▌   | 26/40 [02:58<01:43,  7.36s/it]                 
Task 3, Epoch 27/40 => Loss 0.360, Train_accy 71.06:  68%|██████▊   | 27/40 [02:58<01:28,  6.78s/it]
Task 3, Epoch 28/40 => Loss 0.390, Train_accy 70.76:  68%|██████▊   | 27/40 [03:03<01:28,  6.78s/it]
Task 3, Epoch 28/40 => Loss 0.390, Train_accy 70.76:  70%|███████   | 28/40 [03:03<01:16,  6.36s/it]
Task 3, Epoch 29/40 => Loss 0.364, Train_accy 71.59:  70%|███████   | 28/40 [03:09<01:16,  6.36s/it]
Task 3, Epoch 29/40 => Loss 0.364, Train_accy 71.59:  72%|███████▎  | 29/40 [03:09<01:06,  6.05s/it]
Task 3, Epoch 30/40 => Loss 0.337, Train_accy 72.26:  72%|███████▎  | 29/40 [03:14<01:06,  6.05s/it]
Task 3, Epoch 30/40 => Loss 0.337, Train_accy 72.26:  75%|███████▌  | 30/40 [03:14<00:58,  5.85s/it]
Task 3, Epoch 31/40 => Loss 0.355, Train_accy 70.69, Test_accy 74.04:  75%|███████▌  | 30/40 [03:25<00:58,  5.85s/it]
Task 3, Epoch 31/40 => Loss 0.355, Train_accy 70.69, Test_accy 74.04:  78%|███████▊  | 31/40 [03:25<01:06,  7.38s/it]
Task 3, Epoch 32/40 => Loss 0.326, Train_accy 72.04:  78%|███████▊  | 31/40 [03:30<01:06,  7.38s/it]                 
Task 3, Epoch 32/40 => Loss 0.326, Train_accy 72.04:  80%|████████  | 32/40 [03:30<00:54,  6.77s/it]
Task 3, Epoch 33/40 => Loss 0.350, Train_accy 71.59:  80%|████████  | 32/40 [03:36<00:54,  6.77s/it]
Task 3, Epoch 33/40 => Loss 0.350, Train_accy 71.59:  82%|████████▎ | 33/40 [03:36<00:44,  6.36s/it]
Task 3, Epoch 34/40 => Loss 0.363, Train_accy 71.51:  82%|████████▎ | 33/40 [03:41<00:44,  6.36s/it]
Task 3, Epoch 34/40 => Loss 0.363, Train_accy 71.51:  85%|████████▌ | 34/40 [03:41<00:36,  6.08s/it]
Task 3, Epoch 35/40 => Loss 0.345, Train_accy 71.78:  85%|████████▌ | 34/40 [03:47<00:36,  6.08s/it]
Task 3, Epoch 35/40 => Loss 0.345, Train_accy 71.78:  88%|████████▊ | 35/40 [03:47<00:29,  5.90s/it]
Task 3, Epoch 36/40 => Loss 0.325, Train_accy 70.91, Test_accy 73.96:  88%|████████▊ | 35/40 [03:57<00:29,  5.90s/it]
Task 3, Epoch 36/40 => Loss 0.325, Train_accy 70.91, Test_accy 73.96:  90%|█████████ | 36/40 [03:57<00:29,  7.42s/it]
Task 3, Epoch 37/40 => Loss 0.351, Train_accy 70.65:  90%|█████████ | 36/40 [04:03<00:29,  7.42s/it]                 
Task 3, Epoch 37/40 => Loss 0.351, Train_accy 70.65:  92%|█████████▎| 37/40 [04:03<00:20,  6.79s/it]
Task 3, Epoch 38/40 => Loss 0.349, Train_accy 71.55:  92%|█████████▎| 37/40 [04:08<00:20,  6.79s/it]
Task 3, Epoch 38/40 => Loss 0.349, Train_accy 71.55:  95%|█████████▌| 38/40 [04:08<00:12,  6.38s/it]
Task 3, Epoch 39/40 => Loss 0.362, Train_accy 72.11:  95%|█████████▌| 38/40 [04:14<00:12,  6.38s/it]
Task 3, Epoch 39/40 => Loss 0.362, Train_accy 72.11:  98%|█████████▊| 39/40 [04:14<00:06,  6.10s/it]
Task 3, Epoch 40/40 => Loss 0.344, Train_accy 71.40:  98%|█████████▊| 39/40 [04:19<00:06,  6.10s/it]
Task 3, Epoch 40/40 => Loss 0.344, Train_accy 71.40: 100%|██████████| 40/40 [04:19<00:00,  5.87s/it]
Task 3, Epoch 40/40 => Loss 0.344, Train_accy 71.40: 100%|██████████| 40/40 [04:19<00:00,  6.49s/it]
2025-11-07 00:42:28,833 [sdfourier.py] => Task 3, Epoch 40/40 => Loss 0.344, Train_accy 71.40
2025-11-07 00:42:33,774 [sdfourier.py] => Task 3, After merge adapters => Test_accy 73.62
2025-11-07 00:42:33,776 [trainer.py] => All params: 185874608
2025-11-07 00:42:33,777 [trainer.py] => Trainable params: 74720
2025-11-07 00:42:38,701 [trainer.py] => No NME accuracy.
2025-11-07 00:42:38,702 [trainer.py] => CNN: {'total': np.float64(73.62), '00-19': np.float64(72.45), '20-39': np.float64(76.01), '40-59': np.float64(76.66), '60-79': np.float64(69.27), 'old': np.float64(73.62), 'new': np.float64(nan)}
2025-11-07 00:42:38,702 [trainer.py] => CNN top1 curve: [np.float64(85.25), np.float64(80.05), np.float64(77.24), np.float64(73.62)]
2025-11-07 00:42:38,702 [trainer.py] => CNN top5 curve: [np.float64(95.14), np.float64(92.61), np.float64(90.92), np.float64(88.35)]

Average Accuracy (CNN): 79.04
2025-11-07 00:42:38,702 [trainer.py] => Average Accuracy (CNN): 79.04 

task 4
2025-11-07 00:42:38,703 [sdfourier.py] => Learning on 80-100

总共重置了 12 个模块的qkv层权重

  0%|          | 0/40 [00:00<?, ?it/s]
Task 4, Epoch 1/40 => Loss 2.586, Train_accy 6.03, Test_accy 69.57:   0%|          | 0/40 [00:09<?, ?it/s]
Task 4, Epoch 1/40 => Loss 2.586, Train_accy 6.03, Test_accy 69.57:   2%|▎         | 1/40 [00:09<06:21,  9.78s/it]
Task 4, Epoch 2/40 => Loss 0.883, Train_accy 46.80:   2%|▎         | 1/40 [00:13<06:21,  9.78s/it]                
Task 4, Epoch 2/40 => Loss 0.883, Train_accy 46.80:   5%|▌         | 2/40 [00:13<03:51,  6.09s/it]
Task 4, Epoch 3/40 => Loss 0.699, Train_accy 59.11:   5%|▌         | 2/40 [00:16<03:51,  6.09s/it]
Task 4, Epoch 3/40 => Loss 0.699, Train_accy 59.11:   8%|▊         | 3/40 [00:16<03:02,  4.93s/it]
Task 4, Epoch 4/40 => Loss 0.558, Train_accy 62.56:   8%|▊         | 3/40 [00:20<03:02,  4.93s/it]
Task 4, Epoch 4/40 => Loss 0.558, Train_accy 62.56:  10%|█         | 4/40 [00:20<02:37,  4.37s/it]
Task 4, Epoch 5/40 => Loss 0.517, Train_accy 62.88:  10%|█         | 4/40 [00:23<02:37,  4.37s/it]
Task 4, Epoch 5/40 => Loss 0.517, Train_accy 62.88:  12%|█▎        | 5/40 [00:23<02:22,  4.08s/it]
Task 4, Epoch 6/40 => Loss 0.484, Train_accy 64.01, Test_accy 72.35:  12%|█▎        | 5/40 [00:33<02:22,  4.08s/it]
Task 4, Epoch 6/40 => Loss 0.484, Train_accy 64.01, Test_accy 72.35:  15%|█▌        | 6/40 [00:33<03:25,  6.06s/it]
Task 4, Epoch 7/40 => Loss 0.467, Train_accy 64.32:  15%|█▌        | 6/40 [00:37<03:25,  6.06s/it]                 
Task 4, Epoch 7/40 => Loss 0.467, Train_accy 64.32:  18%|█▊        | 7/40 [00:37<02:53,  5.26s/it]
Task 4, Epoch 8/40 => Loss 0.443, Train_accy 67.02:  18%|█▊        | 7/40 [00:41<02:53,  5.26s/it]
Task 4, Epoch 8/40 => Loss 0.443, Train_accy 67.02:  20%|██        | 8/40 [00:41<02:32,  4.75s/it]
Task 4, Epoch 9/40 => Loss 0.410, Train_accy 65.08:  20%|██        | 8/40 [00:44<02:32,  4.75s/it]
Task 4, Epoch 9/40 => Loss 0.410, Train_accy 65.08:  22%|██▎       | 9/40 [00:44<02:15,  4.37s/it]
Task 4, Epoch 10/40 => Loss 0.408, Train_accy 65.58:  22%|██▎       | 9/40 [00:48<02:15,  4.37s/it]
Task 4, Epoch 10/40 => Loss 0.408, Train_accy 65.58:  25%|██▌       | 10/40 [00:48<02:05,  4.19s/it]
Task 4, Epoch 11/40 => Loss 0.360, Train_accy 69.10, Test_accy 72.75:  25%|██▌       | 10/40 [00:58<02:05,  4.19s/it]
Task 4, Epoch 11/40 => Loss 0.360, Train_accy 69.10, Test_accy 72.75:  28%|██▊       | 11/40 [00:58<02:50,  5.89s/it]
Task 4, Epoch 12/40 => Loss 0.394, Train_accy 69.47:  28%|██▊       | 11/40 [01:01<02:50,  5.89s/it]                 
Task 4, Epoch 12/40 => Loss 0.394, Train_accy 69.47:  30%|███       | 12/40 [01:01<02:25,  5.18s/it]
Task 4, Epoch 13/40 => Loss 0.392, Train_accy 69.41:  30%|███       | 12/40 [01:05<02:25,  5.18s/it]
Task 4, Epoch 13/40 => Loss 0.392, Train_accy 69.41:  32%|███▎      | 13/40 [01:05<02:06,  4.69s/it]
Task 4, Epoch 14/40 => Loss 0.361, Train_accy 68.78:  32%|███▎      | 13/40 [01:08<02:06,  4.69s/it]
Task 4, Epoch 14/40 => Loss 0.361, Train_accy 68.78:  35%|███▌      | 14/40 [01:08<01:53,  4.36s/it]
Task 4, Epoch 15/40 => Loss 0.325, Train_accy 71.42:  35%|███▌      | 14/40 [01:12<01:53,  4.36s/it]
Task 4, Epoch 15/40 => Loss 0.325, Train_accy 71.42:  38%|███▊      | 15/40 [01:12<01:43,  4.12s/it]
Task 4, Epoch 16/40 => Loss 0.330, Train_accy 71.98, Test_accy 72.41:  38%|███▊      | 15/40 [01:22<01:43,  4.12s/it]
Task 4, Epoch 16/40 => Loss 0.330, Train_accy 71.98, Test_accy 72.41:  40%|████      | 16/40 [01:22<02:21,  5.88s/it]
Task 4, Epoch 17/40 => Loss 0.325, Train_accy 71.92:  40%|████      | 16/40 [01:25<02:21,  5.88s/it]                 
Task 4, Epoch 17/40 => Loss 0.325, Train_accy 71.92:  42%|████▎     | 17/40 [01:25<01:59,  5.19s/it]
Task 4, Epoch 18/40 => Loss 0.332, Train_accy 70.29:  42%|████▎     | 17/40 [01:29<01:59,  5.19s/it]
Task 4, Epoch 18/40 => Loss 0.332, Train_accy 70.29:  45%|████▌     | 18/40 [01:29<01:44,  4.75s/it]
Task 4, Epoch 19/40 => Loss 0.356, Train_accy 69.22:  45%|████▌     | 18/40 [01:33<01:44,  4.75s/it]
Task 4, Epoch 19/40 => Loss 0.356, Train_accy 69.22:  48%|████▊     | 19/40 [01:33<01:32,  4.40s/it]
Task 4, Epoch 20/40 => Loss 0.305, Train_accy 69.91:  48%|████▊     | 19/40 [01:36<01:32,  4.40s/it]
Task 4, Epoch 20/40 => Loss 0.305, Train_accy 69.91:  50%|█████     | 20/40 [01:36<01:23,  4.19s/it]
Task 4, Epoch 21/40 => Loss 0.318, Train_accy 71.29, Test_accy 72.48:  50%|█████     | 20/40 [01:46<01:23,  4.19s/it]
Task 4, Epoch 21/40 => Loss 0.318, Train_accy 71.29, Test_accy 72.48:  52%|█████▎    | 21/40 [01:46<01:52,  5.90s/it]
Task 4, Epoch 22/40 => Loss 0.320, Train_accy 71.92:  52%|█████▎    | 21/40 [01:50<01:52,  5.90s/it]                 
Task 4, Epoch 22/40 => Loss 0.320, Train_accy 71.92:  55%|█████▌    | 22/40 [01:50<01:33,  5.18s/it]
Task 4, Epoch 23/40 => Loss 0.337, Train_accy 71.42:  55%|█████▌    | 22/40 [01:53<01:33,  5.18s/it]
Task 4, Epoch 23/40 => Loss 0.337, Train_accy 71.42:  57%|█████▊    | 23/40 [01:53<01:19,  4.68s/it]
Task 4, Epoch 24/40 => Loss 0.299, Train_accy 72.49:  57%|█████▊    | 23/40 [01:57<01:19,  4.68s/it]
Task 4, Epoch 24/40 => Loss 0.299, Train_accy 72.49:  60%|██████    | 24/40 [01:57<01:09,  4.32s/it]
Task 4, Epoch 25/40 => Loss 0.327, Train_accy 71.36:  60%|██████    | 24/40 [02:00<01:09,  4.32s/it]
Task 4, Epoch 25/40 => Loss 0.327, Train_accy 71.36:  62%|██████▎   | 25/40 [02:00<01:01,  4.08s/it]
Task 4, Epoch 26/40 => Loss 0.315, Train_accy 72.80, Test_accy 72.45:  62%|██████▎   | 25/40 [02:10<01:01,  4.08s/it]
Task 4, Epoch 26/40 => Loss 0.315, Train_accy 72.80, Test_accy 72.45:  65%|██████▌   | 26/40 [02:10<01:20,  5.75s/it]
Task 4, Epoch 27/40 => Loss 0.310, Train_accy 71.55:  65%|██████▌   | 26/40 [02:14<01:20,  5.75s/it]                 
Task 4, Epoch 27/40 => Loss 0.310, Train_accy 71.55:  68%|██████▊   | 27/40 [02:14<01:06,  5.09s/it]
Task 4, Epoch 28/40 => Loss 0.302, Train_accy 73.87:  68%|██████▊   | 27/40 [02:17<01:06,  5.09s/it]
Task 4, Epoch 28/40 => Loss 0.302, Train_accy 73.87:  70%|███████   | 28/40 [02:17<00:56,  4.69s/it]
Task 4, Epoch 29/40 => Loss 0.329, Train_accy 72.11:  70%|███████   | 28/40 [02:21<00:56,  4.69s/it]
Task 4, Epoch 29/40 => Loss 0.329, Train_accy 72.11:  72%|███████▎  | 29/40 [02:21<00:48,  4.38s/it]
Task 4, Epoch 30/40 => Loss 0.337, Train_accy 72.86:  72%|███████▎  | 29/40 [02:25<00:48,  4.38s/it]
Task 4, Epoch 30/40 => Loss 0.337, Train_accy 72.86:  75%|███████▌  | 30/40 [02:25<00:41,  4.11s/it]
Task 4, Epoch 31/40 => Loss 0.288, Train_accy 72.80, Test_accy 72.51:  75%|███████▌  | 30/40 [02:34<00:41,  4.11s/it]
Task 4, Epoch 31/40 => Loss 0.288, Train_accy 72.80, Test_accy 72.51:  78%|███████▊  | 31/40 [02:34<00:52,  5.78s/it]
Task 4, Epoch 32/40 => Loss 0.301, Train_accy 72.74:  78%|███████▊  | 31/40 [02:38<00:52,  5.78s/it]                 
Task 4, Epoch 32/40 => Loss 0.301, Train_accy 72.74:  80%|████████  | 32/40 [02:38<00:40,  5.10s/it]
Task 4, Epoch 33/40 => Loss 0.280, Train_accy 73.43:  80%|████████  | 32/40 [02:41<00:40,  5.10s/it]
Task 4, Epoch 33/40 => Loss 0.280, Train_accy 73.43:  82%|████████▎ | 33/40 [02:41<00:32,  4.68s/it]
Task 4, Epoch 34/40 => Loss 0.269, Train_accy 75.38:  82%|████████▎ | 33/40 [02:45<00:32,  4.68s/it]
Task 4, Epoch 34/40 => Loss 0.269, Train_accy 75.38:  85%|████████▌ | 34/40 [02:45<00:26,  4.34s/it]
Task 4, Epoch 35/40 => Loss 0.298, Train_accy 75.25:  85%|████████▌ | 34/40 [02:49<00:26,  4.34s/it]
Task 4, Epoch 35/40 => Loss 0.298, Train_accy 75.25:  88%|████████▊ | 35/40 [02:49<00:20,  4.12s/it]
Task 4, Epoch 36/40 => Loss 0.324, Train_accy 73.05, Test_accy 72.51:  88%|████████▊ | 35/40 [02:58<00:20,  4.12s/it]
Task 4, Epoch 36/40 => Loss 0.324, Train_accy 73.05, Test_accy 72.51:  90%|█████████ | 36/40 [02:58<00:23,  5.77s/it]
Task 4, Epoch 37/40 => Loss 0.275, Train_accy 75.19:  90%|█████████ | 36/40 [03:02<00:23,  5.77s/it]                 
Task 4, Epoch 37/40 => Loss 0.275, Train_accy 75.19:  92%|█████████▎| 37/40 [03:02<00:15,  5.17s/it]
Task 4, Epoch 38/40 => Loss 0.283, Train_accy 73.43:  92%|█████████▎| 37/40 [03:06<00:15,  5.17s/it]
Task 4, Epoch 38/40 => Loss 0.283, Train_accy 73.43:  95%|█████████▌| 38/40 [03:06<00:09,  4.80s/it]
Task 4, Epoch 39/40 => Loss 0.287, Train_accy 71.67:  95%|█████████▌| 38/40 [03:09<00:09,  4.80s/it]
Task 4, Epoch 39/40 => Loss 0.287, Train_accy 71.67:  98%|█████████▊| 39/40 [03:09<00:04,  4.43s/it]
Task 4, Epoch 40/40 => Loss 0.302, Train_accy 72.93:  98%|█████████▊| 39/40 [03:13<00:04,  4.43s/it]
Task 4, Epoch 40/40 => Loss 0.302, Train_accy 72.93: 100%|██████████| 40/40 [03:13<00:00,  4.14s/it]
Task 4, Epoch 40/40 => Loss 0.302, Train_accy 72.93: 100%|██████████| 40/40 [03:13<00:00,  4.83s/it]
2025-11-07 00:45:52,772 [sdfourier.py] => Task 4, Epoch 40/40 => Loss 0.302, Train_accy 72.93
2025-11-07 00:45:58,307 [sdfourier.py] => Task 4, After merge adapters => Test_accy 72.05
2025-11-07 00:45:58,309 [trainer.py] => All params: 185907988
2025-11-07 00:45:58,310 [trainer.py] => Trainable params: 90100
2025-11-07 00:46:03,827 [trainer.py] => No NME accuracy.
2025-11-07 00:46:03,827 [trainer.py] => CNN: {'total': np.float64(72.05), '00-19': np.float64(70.34), '20-39': np.float64(75.0), '40-59': np.float64(75.73), '60-79': np.float64(68.52), '80-99': np.float64(69.5), 'old': np.float64(72.05), 'new': np.float64(nan)}
2025-11-07 00:46:03,827 [trainer.py] => CNN top1 curve: [np.float64(85.25), np.float64(80.05), np.float64(77.24), np.float64(73.62), np.float64(72.05)]
2025-11-07 00:46:03,827 [trainer.py] => CNN top5 curve: [np.float64(95.14), np.float64(92.61), np.float64(90.92), np.float64(88.35), np.float64(87.31)]

Average Accuracy (CNN): 77.64200000000001
2025-11-07 00:46:03,827 [trainer.py] => Average Accuracy (CNN): 77.64200000000001 

task 5
2025-11-07 00:46:03,828 [sdfourier.py] => Learning on 100-120

总共重置了 12 个模块的qkv层权重

  0%|          | 0/40 [00:00<?, ?it/s]
Task 5, Epoch 1/40 => Loss 2.146, Train_accy 16.13, Test_accy 68.42:   0%|          | 0/40 [00:12<?, ?it/s]
Task 5, Epoch 1/40 => Loss 2.146, Train_accy 16.13, Test_accy 68.42:   2%|▎         | 1/40 [00:12<08:01, 12.34s/it]
Task 5, Epoch 2/40 => Loss 0.843, Train_accy 51.14:   2%|▎         | 1/40 [00:17<08:01, 12.34s/it]                 
Task 5, Epoch 2/40 => Loss 0.843, Train_accy 51.14:   5%|▌         | 2/40 [00:17<05:05,  8.05s/it]
Task 5, Epoch 3/40 => Loss 0.696, Train_accy 57.65:   5%|▌         | 2/40 [00:22<05:05,  8.05s/it]
Task 5, Epoch 3/40 => Loss 0.696, Train_accy 57.65:   8%|▊         | 3/40 [00:22<04:08,  6.71s/it]
Task 5, Epoch 4/40 => Loss 0.637, Train_accy 59.07:   8%|▊         | 3/40 [00:27<04:08,  6.71s/it]
Task 5, Epoch 4/40 => Loss 0.637, Train_accy 59.07:  10%|█         | 4/40 [00:27<03:39,  6.09s/it]
Task 5, Epoch 5/40 => Loss 0.545, Train_accy 61.16:  10%|█         | 4/40 [00:32<03:39,  6.09s/it]
Task 5, Epoch 5/40 => Loss 0.545, Train_accy 61.16:  12%|█▎        | 5/40 [00:32<03:20,  5.74s/it]
Task 5, Epoch 6/40 => Loss 0.552, Train_accy 62.18, Test_accy 70.63:  12%|█▎        | 5/40 [00:45<03:20,  5.74s/it]
Task 5, Epoch 6/40 => Loss 0.552, Train_accy 62.18, Test_accy 70.63:  15%|█▌        | 6/40 [00:45<04:31,  7.99s/it]
Task 5, Epoch 7/40 => Loss 0.485, Train_accy 62.93:  15%|█▌        | 6/40 [00:50<04:31,  7.99s/it]                 
Task 5, Epoch 7/40 => Loss 0.485, Train_accy 62.93:  18%|█▊        | 7/40 [00:50<03:53,  7.07s/it]
Task 5, Epoch 8/40 => Loss 0.514, Train_accy 63.17:  18%|█▊        | 7/40 [00:55<03:53,  7.07s/it]
Task 5, Epoch 8/40 => Loss 0.514, Train_accy 63.17:  20%|██        | 8/40 [00:55<03:26,  6.44s/it]
Task 5, Epoch 9/40 => Loss 0.471, Train_accy 65.34:  20%|██        | 8/40 [01:00<03:26,  6.44s/it]
Task 5, Epoch 9/40 => Loss 0.471, Train_accy 65.34:  22%|██▎       | 9/40 [01:00<03:07,  6.05s/it]
Task 5, Epoch 10/40 => Loss 0.444, Train_accy 65.26:  22%|██▎       | 9/40 [01:05<03:07,  6.05s/it]
Task 5, Epoch 10/40 => Loss 0.444, Train_accy 65.26:  25%|██▌       | 10/40 [01:05<02:54,  5.82s/it]
Task 5, Epoch 11/40 => Loss 0.441, Train_accy 65.81, Test_accy 70.93:  25%|██▌       | 10/40 [01:18<02:54,  5.82s/it]
Task 5, Epoch 11/40 => Loss 0.441, Train_accy 65.81, Test_accy 70.93:  28%|██▊       | 11/40 [01:18<03:48,  7.86s/it]
Task 5, Epoch 12/40 => Loss 0.451, Train_accy 65.89:  28%|██▊       | 11/40 [01:23<03:48,  7.86s/it]                 
Task 5, Epoch 12/40 => Loss 0.451, Train_accy 65.89:  30%|███       | 12/40 [01:23<03:17,  7.04s/it]
Task 5, Epoch 13/40 => Loss 0.418, Train_accy 67.35:  30%|███       | 12/40 [01:28<03:17,  7.04s/it]
Task 5, Epoch 13/40 => Loss 0.418, Train_accy 67.35:  32%|███▎      | 13/40 [01:28<02:54,  6.47s/it]
Task 5, Epoch 14/40 => Loss 0.389, Train_accy 70.07:  32%|███▎      | 13/40 [01:33<02:54,  6.47s/it]
Task 5, Epoch 14/40 => Loss 0.389, Train_accy 70.07:  35%|███▌      | 14/40 [01:33<02:37,  6.05s/it]
Task 5, Epoch 15/40 => Loss 0.414, Train_accy 67.55:  35%|███▌      | 14/40 [01:38<02:37,  6.05s/it]
Task 5, Epoch 15/40 => Loss 0.414, Train_accy 67.55:  38%|███▊      | 15/40 [01:38<02:24,  5.76s/it]
Task 5, Epoch 16/40 => Loss 0.416, Train_accy 68.14, Test_accy 70.98:  38%|███▊      | 15/40 [01:51<02:24,  5.76s/it]
Task 5, Epoch 16/40 => Loss 0.416, Train_accy 68.14, Test_accy 70.98:  40%|████      | 16/40 [01:51<03:07,  7.80s/it]
Task 5, Epoch 17/40 => Loss 0.405, Train_accy 69.99:  40%|████      | 16/40 [01:56<03:07,  7.80s/it]                 
Task 5, Epoch 17/40 => Loss 0.405, Train_accy 69.99:  42%|████▎     | 17/40 [01:56<02:41,  7.02s/it]
Task 5, Epoch 18/40 => Loss 0.370, Train_accy 70.43:  42%|████▎     | 17/40 [02:01<02:41,  7.02s/it]
Task 5, Epoch 18/40 => Loss 0.370, Train_accy 70.43:  45%|████▌     | 18/40 [02:01<02:21,  6.44s/it]
Task 5, Epoch 19/40 => Loss 0.375, Train_accy 70.78:  45%|████▌     | 18/40 [02:07<02:21,  6.44s/it]
Task 5, Epoch 19/40 => Loss 0.375, Train_accy 70.78:  48%|████▊     | 19/40 [02:07<02:08,  6.12s/it]
Task 5, Epoch 20/40 => Loss 0.349, Train_accy 71.14:  48%|████▊     | 19/40 [02:12<02:08,  6.12s/it]
Task 5, Epoch 20/40 => Loss 0.349, Train_accy 71.14:  50%|█████     | 20/40 [02:12<01:56,  5.82s/it]
Task 5, Epoch 21/40 => Loss 0.349, Train_accy 70.35, Test_accy 71.01:  50%|█████     | 20/40 [02:24<01:56,  5.82s/it]
Task 5, Epoch 21/40 => Loss 0.349, Train_accy 70.35, Test_accy 71.01:  52%|█████▎    | 21/40 [02:24<02:28,  7.82s/it]
Task 5, Epoch 22/40 => Loss 0.388, Train_accy 70.98:  52%|█████▎    | 21/40 [02:31<02:28,  7.82s/it]                 
Task 5, Epoch 22/40 => Loss 0.388, Train_accy 70.98:  55%|█████▌    | 22/40 [02:31<02:17,  7.63s/it]
Task 5, Epoch 23/40 => Loss 0.362, Train_accy 72.04:  55%|█████▌    | 22/40 [02:40<02:17,  7.63s/it]
Task 5, Epoch 23/40 => Loss 0.362, Train_accy 72.04:  57%|█████▊    | 23/40 [02:40<02:13,  7.85s/it]
Task 5, Epoch 24/40 => Loss 0.340, Train_accy 72.04:  57%|█████▊    | 23/40 [02:48<02:13,  7.85s/it]
Task 5, Epoch 24/40 => Loss 0.340, Train_accy 72.04:  60%|██████    | 24/40 [02:48<02:08,  8.03s/it]
Task 5, Epoch 25/40 => Loss 0.385, Train_accy 70.86:  60%|██████    | 24/40 [02:57<02:08,  8.03s/it]
Task 5, Epoch 25/40 => Loss 0.385, Train_accy 70.86:  62%|██████▎   | 25/40 [02:57<02:02,  8.16s/it]
Task 5, Epoch 26/40 => Loss 0.340, Train_accy 71.33, Test_accy 70.93:  62%|██████▎   | 25/40 [03:11<02:02,  8.16s/it]
Task 5, Epoch 26/40 => Loss 0.340, Train_accy 71.33, Test_accy 70.93:  65%|██████▌   | 26/40 [03:11<02:19,  9.97s/it]
Task 5, Epoch 27/40 => Loss 0.343, Train_accy 71.45:  65%|██████▌   | 26/40 [03:16<02:19,  9.97s/it]                 
Task 5, Epoch 27/40 => Loss 0.343, Train_accy 71.45:  68%|██████▊   | 27/40 [03:16<01:50,  8.52s/it]
Task 5, Epoch 28/40 => Loss 0.349, Train_accy 72.00:  68%|██████▊   | 27/40 [03:21<01:50,  8.52s/it]
Task 5, Epoch 28/40 => Loss 0.349, Train_accy 72.00:  70%|███████   | 28/40 [03:21<01:29,  7.49s/it]
Task 5, Epoch 29/40 => Loss 0.340, Train_accy 71.96:  70%|███████   | 28/40 [03:26<01:29,  7.49s/it]
Task 5, Epoch 29/40 => Loss 0.340, Train_accy 71.96:  72%|███████▎  | 29/40 [03:26<01:14,  6.77s/it]
Task 5, Epoch 30/40 => Loss 0.342, Train_accy 72.16:  72%|███████▎  | 29/40 [03:31<01:14,  6.77s/it]
Task 5, Epoch 30/40 => Loss 0.342, Train_accy 72.16:  75%|███████▌  | 30/40 [03:31<01:02,  6.27s/it]
Task 5, Epoch 31/40 => Loss 0.334, Train_accy 73.54, Test_accy 71.15:  75%|███████▌  | 30/40 [03:44<01:02,  6.27s/it]
Task 5, Epoch 31/40 => Loss 0.334, Train_accy 73.54, Test_accy 71.15:  78%|███████▊  | 31/40 [03:44<01:13,  8.15s/it]
Task 5, Epoch 32/40 => Loss 0.354, Train_accy 70.90:  78%|███████▊  | 31/40 [03:49<01:13,  8.15s/it]                 
Task 5, Epoch 32/40 => Loss 0.354, Train_accy 70.90:  80%|████████  | 32/40 [03:49<00:57,  7.22s/it]
Task 5, Epoch 33/40 => Loss 0.363, Train_accy 71.10:  80%|████████  | 32/40 [03:54<00:57,  7.22s/it]
Task 5, Epoch 33/40 => Loss 0.363, Train_accy 71.10:  82%|████████▎ | 33/40 [03:54<00:46,  6.59s/it]
Task 5, Epoch 34/40 => Loss 0.343, Train_accy 73.38:  82%|████████▎ | 33/40 [03:59<00:46,  6.59s/it]
Task 5, Epoch 34/40 => Loss 0.343, Train_accy 73.38:  85%|████████▌ | 34/40 [03:59<00:36,  6.13s/it]
Task 5, Epoch 35/40 => Loss 0.334, Train_accy 72.40:  85%|████████▌ | 34/40 [04:04<00:36,  6.13s/it]
Task 5, Epoch 35/40 => Loss 0.334, Train_accy 72.40:  88%|████████▊ | 35/40 [04:04<00:29,  5.85s/it]
Task 5, Epoch 36/40 => Loss 0.337, Train_accy 72.83, Test_accy 70.96:  88%|████████▊ | 35/40 [04:17<00:29,  5.85s/it]
Task 5, Epoch 36/40 => Loss 0.337, Train_accy 72.83, Test_accy 70.96:  90%|█████████ | 36/40 [04:17<00:31,  7.79s/it]
Task 5, Epoch 37/40 => Loss 0.354, Train_accy 71.21:  90%|█████████ | 36/40 [04:22<00:31,  7.79s/it]                 
Task 5, Epoch 37/40 => Loss 0.354, Train_accy 71.21:  92%|█████████▎| 37/40 [04:22<00:20,  6.99s/it]
Task 5, Epoch 38/40 => Loss 0.302, Train_accy 72.20:  92%|█████████▎| 37/40 [04:27<00:20,  6.99s/it]
Task 5, Epoch 38/40 => Loss 0.302, Train_accy 72.20:  95%|█████████▌| 38/40 [04:27<00:12,  6.43s/it]
Task 5, Epoch 39/40 => Loss 0.332, Train_accy 72.79:  95%|█████████▌| 38/40 [04:32<00:12,  6.43s/it]
Task 5, Epoch 39/40 => Loss 0.332, Train_accy 72.79:  98%|█████████▊| 39/40 [04:32<00:06,  6.03s/it]
Task 5, Epoch 40/40 => Loss 0.310, Train_accy 72.87:  98%|█████████▊| 39/40 [04:37<00:06,  6.03s/it]
Task 5, Epoch 40/40 => Loss 0.310, Train_accy 72.87: 100%|██████████| 40/40 [04:37<00:00,  5.76s/it]
Task 5, Epoch 40/40 => Loss 0.310, Train_accy 72.87: 100%|██████████| 40/40 [04:37<00:00,  6.94s/it]
2025-11-07 00:50:42,128 [sdfourier.py] => Task 5, Epoch 40/40 => Loss 0.310, Train_accy 72.87
2025-11-07 00:50:48,765 [sdfourier.py] => Task 5, After merge adapters => Test_accy 70.25
2025-11-07 00:50:48,767 [trainer.py] => All params: 185942568
2025-11-07 00:50:48,768 [trainer.py] => Trainable params: 105480
2025-11-07 00:50:55,340 [trainer.py] => No NME accuracy.
2025-11-07 00:50:55,341 [trainer.py] => CNN: {'total': np.float64(70.25), '00-19': np.float64(69.37), '20-39': np.float64(73.42), '40-59': np.float64(73.72), '60-79': np.float64(66.57), '80-99': np.float64(68.25), '100-119': np.float64(69.22), 'old': np.float64(70.25), 'new': np.float64(nan)}
2025-11-07 00:50:55,341 [trainer.py] => CNN top1 curve: [np.float64(85.25), np.float64(80.05), np.float64(77.24), np.float64(73.62), np.float64(72.05), np.float64(70.25)]
2025-11-07 00:50:55,341 [trainer.py] => CNN top5 curve: [np.float64(95.14), np.float64(92.61), np.float64(90.92), np.float64(88.35), np.float64(87.31), np.float64(86.42)]

Average Accuracy (CNN): 76.41000000000001
2025-11-07 00:50:55,341 [trainer.py] => Average Accuracy (CNN): 76.41000000000001 

task 6
2025-11-07 00:50:55,342 [sdfourier.py] => Learning on 120-140

总共重置了 12 个模块的qkv层权重

  0%|          | 0/40 [00:00<?, ?it/s]
Task 6, Epoch 1/40 => Loss 2.485, Train_accy 8.57, Test_accy 65.83:   0%|          | 0/40 [00:12<?, ?it/s]
Task 6, Epoch 1/40 => Loss 2.485, Train_accy 8.57, Test_accy 65.83:   2%|▎         | 1/40 [00:12<08:09, 12.55s/it]
Task 6, Epoch 2/40 => Loss 0.994, Train_accy 39.66:   2%|▎         | 1/40 [00:17<08:09, 12.55s/it]                
Task 6, Epoch 2/40 => Loss 0.994, Train_accy 39.66:   5%|▌         | 2/40 [00:17<04:59,  7.89s/it]
Task 6, Epoch 3/40 => Loss 0.775, Train_accy 49.81:   5%|▌         | 2/40 [00:21<04:59,  7.89s/it]
Task 6, Epoch 3/40 => Loss 0.775, Train_accy 49.81:   8%|▊         | 3/40 [00:21<03:54,  6.33s/it]
Task 6, Epoch 4/40 => Loss 0.741, Train_accy 50.37:   8%|▊         | 3/40 [00:26<03:54,  6.33s/it]
Task 6, Epoch 4/40 => Loss 0.741, Train_accy 50.37:  10%|█         | 4/40 [00:26<03:21,  5.59s/it]
Task 6, Epoch 5/40 => Loss 0.669, Train_accy 52.00:  10%|█         | 4/40 [00:30<03:21,  5.59s/it]
Task 6, Epoch 5/40 => Loss 0.669, Train_accy 52.00:  12%|█▎        | 5/40 [00:30<03:02,  5.21s/it]
Task 6, Epoch 6/40 => Loss 0.586, Train_accy 53.35, Test_accy 68.51:  12%|█▎        | 5/40 [00:43<03:02,  5.21s/it]
Task 6, Epoch 6/40 => Loss 0.586, Train_accy 53.35, Test_accy 68.51:  15%|█▌        | 6/40 [00:43<04:24,  7.76s/it]
Task 6, Epoch 7/40 => Loss 0.552, Train_accy 54.61:  15%|█▌        | 6/40 [00:47<04:24,  7.76s/it]                 
Task 6, Epoch 7/40 => Loss 0.552, Train_accy 54.61:  18%|█▊        | 7/40 [00:47<03:40,  6.68s/it]
Task 6, Epoch 8/40 => Loss 0.566, Train_accy 54.75:  18%|█▊        | 7/40 [00:52<03:40,  6.68s/it]
Task 6, Epoch 8/40 => Loss 0.566, Train_accy 54.75:  20%|██        | 8/40 [00:52<03:13,  6.06s/it]
Task 6, Epoch 9/40 => Loss 0.524, Train_accy 55.82:  20%|██        | 8/40 [00:57<03:13,  6.06s/it]
Task 6, Epoch 9/40 => Loss 0.524, Train_accy 55.82:  22%|██▎       | 9/40 [00:57<02:52,  5.56s/it]
Task 6, Epoch 10/40 => Loss 0.483, Train_accy 58.01:  22%|██▎       | 9/40 [01:01<02:52,  5.56s/it]
Task 6, Epoch 10/40 => Loss 0.483, Train_accy 58.01:  25%|██▌       | 10/40 [01:01<02:38,  5.29s/it]
Task 6, Epoch 11/40 => Loss 0.478, Train_accy 59.45, Test_accy 68.72:  25%|██▌       | 10/40 [01:14<02:38,  5.29s/it]
Task 6, Epoch 11/40 => Loss 0.478, Train_accy 59.45, Test_accy 68.72:  28%|██▊       | 11/40 [01:14<03:40,  7.61s/it]
Task 6, Epoch 12/40 => Loss 0.467, Train_accy 59.12:  28%|██▊       | 11/40 [01:19<03:40,  7.61s/it]                 
Task 6, Epoch 12/40 => Loss 0.467, Train_accy 59.12:  30%|███       | 12/40 [01:19<03:06,  6.65s/it]
Task 6, Epoch 13/40 => Loss 0.468, Train_accy 59.78:  30%|███       | 12/40 [01:23<03:06,  6.65s/it]
Task 6, Epoch 13/40 => Loss 0.468, Train_accy 59.78:  32%|███▎      | 13/40 [01:23<02:42,  6.01s/it]
Task 6, Epoch 14/40 => Loss 0.474, Train_accy 59.59:  32%|███▎      | 13/40 [01:27<02:42,  6.01s/it]
Task 6, Epoch 14/40 => Loss 0.474, Train_accy 59.59:  35%|███▌      | 14/40 [01:27<02:23,  5.54s/it]
Task 6, Epoch 15/40 => Loss 0.454, Train_accy 60.20:  35%|███▌      | 14/40 [01:32<02:23,  5.54s/it]
Task 6, Epoch 15/40 => Loss 0.454, Train_accy 60.20:  38%|███▊      | 15/40 [01:32<02:11,  5.25s/it]
Task 6, Epoch 16/40 => Loss 0.428, Train_accy 61.41, Test_accy 68.79:  38%|███▊      | 15/40 [01:45<02:11,  5.25s/it]
Task 6, Epoch 16/40 => Loss 0.428, Train_accy 61.41, Test_accy 68.79:  40%|████      | 16/40 [01:45<03:02,  7.59s/it]
Task 6, Epoch 17/40 => Loss 0.459, Train_accy 60.20:  40%|████      | 16/40 [01:50<03:02,  7.59s/it]                 
Task 6, Epoch 17/40 => Loss 0.459, Train_accy 60.20:  42%|████▎     | 17/40 [01:50<02:32,  6.65s/it]
Task 6, Epoch 18/40 => Loss 0.441, Train_accy 62.48:  42%|████▎     | 17/40 [01:54<02:32,  6.65s/it]
Task 6, Epoch 18/40 => Loss 0.441, Train_accy 62.48:  45%|████▌     | 18/40 [01:54<02:13,  6.06s/it]
Task 6, Epoch 19/40 => Loss 0.452, Train_accy 61.55:  45%|████▌     | 18/40 [01:59<02:13,  6.06s/it]
Task 6, Epoch 19/40 => Loss 0.452, Train_accy 61.55:  48%|████▊     | 19/40 [01:59<01:58,  5.63s/it]
Task 6, Epoch 20/40 => Loss 0.389, Train_accy 62.57:  48%|████▊     | 19/40 [02:03<01:58,  5.63s/it]
Task 6, Epoch 20/40 => Loss 0.389, Train_accy 62.57:  50%|█████     | 20/40 [02:03<01:45,  5.28s/it]
Task 6, Epoch 21/40 => Loss 0.395, Train_accy 61.92, Test_accy 68.89:  50%|█████     | 20/40 [02:16<01:45,  5.28s/it]
Task 6, Epoch 21/40 => Loss 0.395, Train_accy 61.92, Test_accy 68.89:  52%|█████▎    | 21/40 [02:16<02:21,  7.47s/it]
Task 6, Epoch 22/40 => Loss 0.408, Train_accy 62.20:  52%|█████▎    | 21/40 [02:20<02:21,  7.47s/it]                 
Task 6, Epoch 22/40 => Loss 0.408, Train_accy 62.20:  55%|█████▌    | 22/40 [02:20<01:58,  6.59s/it]
Task 6, Epoch 23/40 => Loss 0.391, Train_accy 63.41:  55%|█████▌    | 22/40 [02:25<01:58,  6.59s/it]
Task 6, Epoch 23/40 => Loss 0.391, Train_accy 63.41:  57%|█████▊    | 23/40 [02:25<01:41,  5.94s/it]
Task 6, Epoch 24/40 => Loss 0.384, Train_accy 63.04:  57%|█████▊    | 23/40 [02:29<01:41,  5.94s/it]
Task 6, Epoch 24/40 => Loss 0.384, Train_accy 63.04:  60%|██████    | 24/40 [02:29<01:27,  5.49s/it]
Task 6, Epoch 25/40 => Loss 0.405, Train_accy 62.34:  60%|██████    | 24/40 [02:34<01:27,  5.49s/it]
Task 6, Epoch 25/40 => Loss 0.405, Train_accy 62.34:  62%|██████▎   | 25/40 [02:34<01:17,  5.15s/it]
Task 6, Epoch 26/40 => Loss 0.381, Train_accy 64.53, Test_accy 68.89:  62%|██████▎   | 25/40 [02:46<01:17,  5.15s/it]
Task 6, Epoch 26/40 => Loss 0.381, Train_accy 64.53, Test_accy 68.89:  65%|██████▌   | 26/40 [02:46<01:43,  7.42s/it]
Task 6, Epoch 27/40 => Loss 0.397, Train_accy 63.13:  65%|██████▌   | 26/40 [02:51<01:43,  7.42s/it]                 
Task 6, Epoch 27/40 => Loss 0.397, Train_accy 63.13:  68%|██████▊   | 27/40 [02:51<01:25,  6.55s/it]
Task 6, Epoch 28/40 => Loss 0.368, Train_accy 63.83:  68%|██████▊   | 27/40 [02:56<01:25,  6.55s/it]
Task 6, Epoch 28/40 => Loss 0.368, Train_accy 63.83:  70%|███████   | 28/40 [02:56<01:11,  5.97s/it]
Task 6, Epoch 29/40 => Loss 0.349, Train_accy 63.22:  70%|███████   | 28/40 [03:00<01:11,  5.97s/it]
Task 6, Epoch 29/40 => Loss 0.349, Train_accy 63.22:  72%|███████▎  | 29/40 [03:00<01:01,  5.60s/it]
Task 6, Epoch 30/40 => Loss 0.385, Train_accy 62.24:  72%|███████▎  | 29/40 [03:05<01:01,  5.60s/it]
Task 6, Epoch 30/40 => Loss 0.385, Train_accy 62.24:  75%|███████▌  | 30/40 [03:05<00:52,  5.27s/it]
Task 6, Epoch 31/40 => Loss 0.361, Train_accy 65.13, Test_accy 68.91:  75%|███████▌  | 30/40 [03:18<00:52,  5.27s/it]
Task 6, Epoch 31/40 => Loss 0.361, Train_accy 65.13, Test_accy 68.91:  78%|███████▊  | 31/40 [03:18<01:07,  7.51s/it]
Task 6, Epoch 32/40 => Loss 0.376, Train_accy 64.71:  78%|███████▊  | 31/40 [03:22<01:07,  7.51s/it]                 
Task 6, Epoch 32/40 => Loss 0.376, Train_accy 64.71:  80%|████████  | 32/40 [03:22<00:53,  6.63s/it]
Task 6, Epoch 33/40 => Loss 0.379, Train_accy 64.53:  80%|████████  | 32/40 [03:27<00:53,  6.63s/it]
Task 6, Epoch 33/40 => Loss 0.379, Train_accy 64.53:  82%|████████▎ | 33/40 [03:27<00:41,  5.97s/it]
Task 6, Epoch 34/40 => Loss 0.402, Train_accy 64.34:  82%|████████▎ | 33/40 [03:31<00:41,  5.97s/it]
Task 6, Epoch 34/40 => Loss 0.402, Train_accy 64.34:  85%|████████▌ | 34/40 [03:31<00:33,  5.52s/it]
Task 6, Epoch 35/40 => Loss 0.344, Train_accy 63.97:  85%|████████▌ | 34/40 [03:35<00:33,  5.52s/it]
Task 6, Epoch 35/40 => Loss 0.344, Train_accy 63.97:  88%|████████▊ | 35/40 [03:35<00:26,  5.20s/it]
Task 6, Epoch 36/40 => Loss 0.403, Train_accy 64.01, Test_accy 68.91:  88%|████████▊ | 35/40 [03:48<00:26,  5.20s/it]
Task 6, Epoch 36/40 => Loss 0.403, Train_accy 64.01, Test_accy 68.91:  90%|█████████ | 36/40 [03:48<00:29,  7.43s/it]
Task 6, Epoch 37/40 => Loss 0.358, Train_accy 64.85:  90%|█████████ | 36/40 [03:53<00:29,  7.43s/it]                 
Task 6, Epoch 37/40 => Loss 0.358, Train_accy 64.85:  92%|█████████▎| 37/40 [03:53<00:19,  6.54s/it]
Task 6, Epoch 38/40 => Loss 0.421, Train_accy 61.96:  92%|█████████▎| 37/40 [03:57<00:19,  6.54s/it]
Task 6, Epoch 38/40 => Loss 0.421, Train_accy 61.96:  95%|█████████▌| 38/40 [03:57<00:11,  5.93s/it]
Task 6, Epoch 39/40 => Loss 0.392, Train_accy 63.31:  95%|█████████▌| 38/40 [04:01<00:11,  5.93s/it]
Task 6, Epoch 39/40 => Loss 0.392, Train_accy 63.31:  98%|█████████▊| 39/40 [04:01<00:05,  5.48s/it]
Task 6, Epoch 40/40 => Loss 0.362, Train_accy 63.87:  98%|█████████▊| 39/40 [04:06<00:05,  5.48s/it]
Task 6, Epoch 40/40 => Loss 0.362, Train_accy 63.87: 100%|██████████| 40/40 [04:06<00:00,  5.18s/it]
Task 6, Epoch 40/40 => Loss 0.362, Train_accy 63.87: 100%|██████████| 40/40 [04:06<00:00,  6.16s/it]
2025-11-07 00:55:02,831 [sdfourier.py] => Task 6, Epoch 40/40 => Loss 0.362, Train_accy 63.87
2025-11-07 00:55:10,110 [sdfourier.py] => Task 6, After merge adapters => Test_accy 67.91
2025-11-07 00:55:10,112 [trainer.py] => All params: 185978348
2025-11-07 00:55:10,113 [trainer.py] => Trainable params: 120860
2025-11-07 00:55:17,382 [trainer.py] => No NME accuracy.
2025-11-07 00:55:17,383 [trainer.py] => CNN: {'total': np.float64(67.91), '00-19': np.float64(69.21), '20-39': np.float64(71.84), '40-59': np.float64(72.18), '60-79': np.float64(65.22), '80-99': np.float64(66.25), '100-119': np.float64(68.44), '120-139': np.float64(59.81), 'old': np.float64(67.91), 'new': np.float64(nan)}
2025-11-07 00:55:17,383 [trainer.py] => CNN top1 curve: [np.float64(85.25), np.float64(80.05), np.float64(77.24), np.float64(73.62), np.float64(72.05), np.float64(70.25), np.float64(67.91)]
2025-11-07 00:55:17,383 [trainer.py] => CNN top5 curve: [np.float64(95.14), np.float64(92.61), np.float64(90.92), np.float64(88.35), np.float64(87.31), np.float64(86.42), np.float64(84.67)]

Average Accuracy (CNN): 75.19571428571429
2025-11-07 00:55:17,383 [trainer.py] => Average Accuracy (CNN): 75.19571428571429 

task 7
2025-11-07 00:55:17,384 [sdfourier.py] => Learning on 140-160

总共重置了 12 个模块的qkv层权重

  0%|          | 0/40 [00:00<?, ?it/s]
Task 7, Epoch 1/40 => Loss 2.011, Train_accy 12.91, Test_accy 66.19:   0%|          | 0/40 [00:13<?, ?it/s]
Task 7, Epoch 1/40 => Loss 2.011, Train_accy 12.91, Test_accy 66.19:   2%|▎         | 1/40 [00:13<08:55, 13.74s/it]
Task 7, Epoch 2/40 => Loss 0.803, Train_accy 52.56:   2%|▎         | 1/40 [00:18<08:55, 13.74s/it]                 
Task 7, Epoch 2/40 => Loss 0.803, Train_accy 52.56:   5%|▌         | 2/40 [00:18<05:17,  8.35s/it]
Task 7, Epoch 3/40 => Loss 0.579, Train_accy 61.60:   5%|▌         | 2/40 [00:22<05:17,  8.35s/it]
Task 7, Epoch 3/40 => Loss 0.579, Train_accy 61.60:   8%|▊         | 3/40 [00:22<04:02,  6.56s/it]
Task 7, Epoch 4/40 => Loss 0.497, Train_accy 64.45:   8%|▊         | 3/40 [00:27<04:02,  6.56s/it]
Task 7, Epoch 4/40 => Loss 0.497, Train_accy 64.45:  10%|█         | 4/40 [00:27<03:27,  5.75s/it]
Task 7, Epoch 5/40 => Loss 0.457, Train_accy 64.54:  10%|█         | 4/40 [00:31<03:27,  5.75s/it]
Task 7, Epoch 5/40 => Loss 0.457, Train_accy 64.54:  12%|█▎        | 5/40 [00:31<03:05,  5.29s/it]
Task 7, Epoch 6/40 => Loss 0.458, Train_accy 65.47, Test_accy 68.65:  12%|█▎        | 5/40 [00:45<03:05,  5.29s/it]
Task 7, Epoch 6/40 => Loss 0.458, Train_accy 65.47, Test_accy 68.65:  15%|█▌        | 6/40 [00:45<04:42,  8.31s/it]
Task 7, Epoch 7/40 => Loss 0.489, Train_accy 64.91:  15%|█▌        | 6/40 [00:51<04:42,  8.31s/it]                 
Task 7, Epoch 7/40 => Loss 0.489, Train_accy 64.91:  18%|█▊        | 7/40 [00:51<04:06,  7.48s/it]
Task 7, Epoch 8/40 => Loss 0.423, Train_accy 66.36:  18%|█▊        | 7/40 [00:56<04:06,  7.48s/it]
Task 7, Epoch 8/40 => Loss 0.423, Train_accy 66.36:  20%|██        | 8/40 [00:56<03:29,  6.56s/it]
Task 7, Epoch 9/40 => Loss 0.419, Train_accy 66.31:  20%|██        | 8/40 [01:00<03:29,  6.56s/it]
Task 7, Epoch 9/40 => Loss 0.419, Train_accy 66.31:  22%|██▎       | 9/40 [01:00<03:03,  5.92s/it]
Task 7, Epoch 10/40 => Loss 0.379, Train_accy 67.71:  22%|██▎       | 9/40 [01:05<03:03,  5.92s/it]
Task 7, Epoch 10/40 => Loss 0.379, Train_accy 67.71:  25%|██▌       | 10/40 [01:05<02:43,  5.46s/it]
Task 7, Epoch 11/40 => Loss 0.386, Train_accy 67.10, Test_accy 68.74:  25%|██▌       | 10/40 [01:18<02:43,  5.46s/it]
Task 7, Epoch 11/40 => Loss 0.386, Train_accy 67.10, Test_accy 68.74:  28%|██▊       | 11/40 [01:18<03:51,  7.98s/it]
Task 7, Epoch 12/40 => Loss 0.365, Train_accy 69.38:  28%|██▊       | 11/40 [01:23<03:51,  7.98s/it]                 
Task 7, Epoch 12/40 => Loss 0.365, Train_accy 69.38:  30%|███       | 12/40 [01:23<03:13,  6.91s/it]
Task 7, Epoch 13/40 => Loss 0.337, Train_accy 69.66:  30%|███       | 12/40 [01:27<03:13,  6.91s/it]
Task 7, Epoch 13/40 => Loss 0.337, Train_accy 69.66:  32%|███▎      | 13/40 [01:27<02:46,  6.16s/it]
Task 7, Epoch 14/40 => Loss 0.332, Train_accy 69.38:  32%|███▎      | 13/40 [01:32<02:46,  6.16s/it]
Task 7, Epoch 14/40 => Loss 0.332, Train_accy 69.38:  35%|███▌      | 14/40 [01:32<02:27,  5.67s/it]
Task 7, Epoch 15/40 => Loss 0.328, Train_accy 69.99:  35%|███▌      | 14/40 [01:36<02:27,  5.67s/it]
Task 7, Epoch 15/40 => Loss 0.328, Train_accy 69.99:  38%|███▊      | 15/40 [01:36<02:13,  5.33s/it]
Task 7, Epoch 16/40 => Loss 0.364, Train_accy 70.88, Test_accy 68.84:  38%|███▊      | 15/40 [01:50<02:13,  5.33s/it]
Task 7, Epoch 16/40 => Loss 0.364, Train_accy 70.88, Test_accy 68.84:  40%|████      | 16/40 [01:50<03:11,  7.97s/it]
Task 7, Epoch 17/40 => Loss 0.374, Train_accy 69.80:  40%|████      | 16/40 [01:55<03:11,  7.97s/it]                 
Task 7, Epoch 17/40 => Loss 0.374, Train_accy 69.80:  42%|████▎     | 17/40 [01:55<02:39,  6.95s/it]
Task 7, Epoch 18/40 => Loss 0.312, Train_accy 71.44:  42%|████▎     | 17/40 [02:00<02:39,  6.95s/it]
Task 7, Epoch 18/40 => Loss 0.312, Train_accy 71.44:  45%|████▌     | 18/40 [02:00<02:17,  6.25s/it]
Task 7, Epoch 19/40 => Loss 0.309, Train_accy 72.13:  45%|████▌     | 18/40 [02:04<02:17,  6.25s/it]
Task 7, Epoch 19/40 => Loss 0.309, Train_accy 72.13:  48%|████▊     | 19/40 [02:04<01:59,  5.71s/it]
Task 7, Epoch 20/40 => Loss 0.284, Train_accy 73.53:  48%|████▊     | 19/40 [02:09<01:59,  5.71s/it]
Task 7, Epoch 20/40 => Loss 0.284, Train_accy 73.53:  50%|█████     | 20/40 [02:09<01:47,  5.37s/it]
Task 7, Epoch 21/40 => Loss 0.348, Train_accy 71.20, Test_accy 68.99:  50%|█████     | 20/40 [02:22<01:47,  5.37s/it]
Task 7, Epoch 21/40 => Loss 0.348, Train_accy 71.20, Test_accy 68.99:  52%|█████▎    | 21/40 [02:22<02:29,  7.85s/it]
Task 7, Epoch 22/40 => Loss 0.306, Train_accy 73.39:  52%|█████▎    | 21/40 [02:27<02:29,  7.85s/it]                 
Task 7, Epoch 22/40 => Loss 0.306, Train_accy 73.39:  55%|█████▌    | 22/40 [02:27<02:02,  6.82s/it]
Task 7, Epoch 23/40 => Loss 0.335, Train_accy 72.32:  55%|█████▌    | 22/40 [02:31<02:02,  6.82s/it]
Task 7, Epoch 23/40 => Loss 0.335, Train_accy 72.32:  57%|█████▊    | 23/40 [02:31<01:43,  6.10s/it]
Task 7, Epoch 24/40 => Loss 0.299, Train_accy 72.74:  57%|█████▊    | 23/40 [02:36<01:43,  6.10s/it]
Task 7, Epoch 24/40 => Loss 0.299, Train_accy 72.74:  60%|██████    | 24/40 [02:36<01:29,  5.62s/it]
Task 7, Epoch 25/40 => Loss 0.307, Train_accy 72.55:  60%|██████    | 24/40 [02:40<01:29,  5.62s/it]
Task 7, Epoch 25/40 => Loss 0.307, Train_accy 72.55:  62%|██████▎   | 25/40 [02:40<01:20,  5.33s/it]
Task 7, Epoch 26/40 => Loss 0.297, Train_accy 74.60, Test_accy 69.03:  62%|██████▎   | 25/40 [02:54<01:20,  5.33s/it]
Task 7, Epoch 26/40 => Loss 0.297, Train_accy 74.60, Test_accy 69.03:  65%|██████▌   | 26/40 [02:54<01:51,  7.97s/it]
Task 7, Epoch 27/40 => Loss 0.301, Train_accy 72.88:  65%|██████▌   | 26/40 [02:59<01:51,  7.97s/it]                 
Task 7, Epoch 27/40 => Loss 0.301, Train_accy 72.88:  68%|██████▊   | 27/40 [02:59<01:29,  6.90s/it]
Task 7, Epoch 28/40 => Loss 0.282, Train_accy 73.39:  68%|██████▊   | 27/40 [03:03<01:29,  6.90s/it]
Task 7, Epoch 28/40 => Loss 0.282, Train_accy 73.39:  70%|███████   | 28/40 [03:03<01:14,  6.19s/it]
Task 7, Epoch 29/40 => Loss 0.285, Train_accy 74.60:  70%|███████   | 28/40 [03:08<01:14,  6.19s/it]
Task 7, Epoch 29/40 => Loss 0.285, Train_accy 74.60:  72%|███████▎  | 29/40 [03:08<01:02,  5.68s/it]
Task 7, Epoch 30/40 => Loss 0.292, Train_accy 73.11:  72%|███████▎  | 29/40 [03:12<01:02,  5.68s/it]
Task 7, Epoch 30/40 => Loss 0.292, Train_accy 73.11:  75%|███████▌  | 30/40 [03:12<00:53,  5.33s/it]
Task 7, Epoch 31/40 => Loss 0.255, Train_accy 74.46, Test_accy 68.93:  75%|███████▌  | 30/40 [03:26<00:53,  5.33s/it]
Task 7, Epoch 31/40 => Loss 0.255, Train_accy 74.46, Test_accy 68.93:  78%|███████▊  | 31/40 [03:26<01:10,  7.80s/it]
Task 7, Epoch 32/40 => Loss 0.307, Train_accy 74.04:  78%|███████▊  | 31/40 [03:30<01:10,  7.80s/it]                 
Task 7, Epoch 32/40 => Loss 0.307, Train_accy 74.04:  80%|████████  | 32/40 [03:30<00:54,  6.79s/it]
Task 7, Epoch 33/40 => Loss 0.294, Train_accy 73.25:  80%|████████  | 32/40 [03:35<00:54,  6.79s/it]
Task 7, Epoch 33/40 => Loss 0.294, Train_accy 73.25:  82%|████████▎ | 33/40 [03:35<00:42,  6.08s/it]
Task 7, Epoch 34/40 => Loss 0.298, Train_accy 73.53:  82%|████████▎ | 33/40 [03:39<00:42,  6.08s/it]
Task 7, Epoch 34/40 => Loss 0.298, Train_accy 73.53:  85%|████████▌ | 34/40 [03:39<00:33,  5.60s/it]
Task 7, Epoch 35/40 => Loss 0.278, Train_accy 73.67:  85%|████████▌ | 34/40 [03:44<00:33,  5.60s/it]
Task 7, Epoch 35/40 => Loss 0.278, Train_accy 73.67:  88%|████████▊ | 35/40 [03:44<00:26,  5.33s/it]
Task 7, Epoch 36/40 => Loss 0.275, Train_accy 72.97, Test_accy 69.03:  88%|████████▊ | 35/40 [03:58<00:26,  5.33s/it]
Task 7, Epoch 36/40 => Loss 0.275, Train_accy 72.97, Test_accy 69.03:  90%|█████████ | 36/40 [03:58<00:31,  7.80s/it]
Task 7, Epoch 37/40 => Loss 0.299, Train_accy 72.97:  90%|█████████ | 36/40 [04:02<00:31,  7.80s/it]                 
Task 7, Epoch 37/40 => Loss 0.299, Train_accy 72.97:  92%|█████████▎| 37/40 [04:02<00:20,  6.83s/it]
Task 7, Epoch 38/40 => Loss 0.283, Train_accy 74.84:  92%|█████████▎| 37/40 [04:07<00:20,  6.83s/it]
Task 7, Epoch 38/40 => Loss 0.283, Train_accy 74.84:  95%|█████████▌| 38/40 [04:07<00:12,  6.10s/it]
Task 7, Epoch 39/40 => Loss 0.290, Train_accy 74.14:  95%|█████████▌| 38/40 [04:11<00:12,  6.10s/it]
Task 7, Epoch 39/40 => Loss 0.290, Train_accy 74.14:  98%|█████████▊| 39/40 [04:11<00:05,  5.64s/it]
Task 7, Epoch 40/40 => Loss 0.287, Train_accy 73.95:  98%|█████████▊| 39/40 [04:16<00:05,  5.64s/it]
Task 7, Epoch 40/40 => Loss 0.287, Train_accy 73.95: 100%|██████████| 40/40 [04:16<00:00,  5.30s/it]
Task 7, Epoch 40/40 => Loss 0.287, Train_accy 73.95: 100%|██████████| 40/40 [04:16<00:00,  6.40s/it]
2025-11-07 00:59:34,701 [sdfourier.py] => Task 7, Epoch 40/40 => Loss 0.287, Train_accy 73.95
2025-11-07 00:59:42,916 [sdfourier.py] => Task 7, After merge adapters => Test_accy 67.79
2025-11-07 00:59:42,917 [trainer.py] => All params: 186015328
2025-11-07 00:59:42,919 [trainer.py] => Trainable params: 136240
2025-11-07 00:59:51,071 [trainer.py] => No NME accuracy.
2025-11-07 00:59:51,071 [trainer.py] => CNN: {'total': np.float64(67.79), '00-19': np.float64(68.07), '20-39': np.float64(70.26), '40-59': np.float64(70.17), '60-79': np.float64(63.87), '80-99': np.float64(63.75), '100-119': np.float64(68.59), '120-139': np.float64(59.22), '140-159': np.float64(76.11), 'old': np.float64(67.79), 'new': np.float64(nan)}
2025-11-07 00:59:51,071 [trainer.py] => CNN top1 curve: [np.float64(85.25), np.float64(80.05), np.float64(77.24), np.float64(73.62), np.float64(72.05), np.float64(70.25), np.float64(67.91), np.float64(67.79)]
2025-11-07 00:59:51,071 [trainer.py] => CNN top5 curve: [np.float64(95.14), np.float64(92.61), np.float64(90.92), np.float64(88.35), np.float64(87.31), np.float64(86.42), np.float64(84.67), np.float64(84.22)]

Average Accuracy (CNN): 74.27
2025-11-07 00:59:51,071 [trainer.py] => Average Accuracy (CNN): 74.27 

task 8
2025-11-07 00:59:51,072 [sdfourier.py] => Learning on 160-180

总共重置了 12 个模块的qkv层权重

  0%|          | 0/40 [00:00<?, ?it/s]
Task 8, Epoch 1/40 => Loss 2.280, Train_accy 9.02, Test_accy 65.29:   0%|          | 0/40 [00:15<?, ?it/s]
Task 8, Epoch 1/40 => Loss 2.280, Train_accy 9.02, Test_accy 65.29:   2%|▎         | 1/40 [00:15<09:56, 15.29s/it]
Task 8, Epoch 2/40 => Loss 1.006, Train_accy 40.69:   2%|▎         | 1/40 [00:20<09:56, 15.29s/it]                
Task 8, Epoch 2/40 => Loss 1.006, Train_accy 40.69:   5%|▌         | 2/40 [00:20<05:48,  9.16s/it]
Task 8, Epoch 3/40 => Loss 0.830, Train_accy 49.33:   5%|▌         | 2/40 [00:25<05:48,  9.16s/it]
Task 8, Epoch 3/40 => Loss 0.830, Train_accy 49.33:   8%|▊         | 3/40 [00:25<04:28,  7.26s/it]
Task 8, Epoch 4/40 => Loss 0.745, Train_accy 50.46:   8%|▊         | 3/40 [00:30<04:28,  7.26s/it]
Task 8, Epoch 4/40 => Loss 0.745, Train_accy 50.46:  10%|█         | 4/40 [00:30<03:51,  6.43s/it]
Task 8, Epoch 5/40 => Loss 0.708, Train_accy 51.87:  10%|█         | 4/40 [00:35<03:51,  6.43s/it]
Task 8, Epoch 5/40 => Loss 0.708, Train_accy 51.87:  12%|█▎        | 5/40 [00:35<03:25,  5.86s/it]
Task 8, Epoch 6/40 => Loss 0.662, Train_accy 52.45, Test_accy 67.09:  12%|█▎        | 5/40 [00:50<03:25,  5.86s/it]
Task 8, Epoch 6/40 => Loss 0.662, Train_accy 52.45, Test_accy 67.09:  15%|█▌        | 6/40 [00:50<05:07,  9.03s/it]
Task 8, Epoch 7/40 => Loss 0.615, Train_accy 53.57:  15%|█▌        | 6/40 [00:55<05:07,  9.03s/it]                 
Task 8, Epoch 7/40 => Loss 0.615, Train_accy 53.57:  18%|█▊        | 7/40 [00:55<04:13,  7.67s/it]
Task 8, Epoch 8/40 => Loss 0.581, Train_accy 54.70:  18%|█▊        | 7/40 [01:00<04:13,  7.67s/it]
Task 8, Epoch 8/40 => Loss 0.581, Train_accy 54.70:  20%|██        | 8/40 [01:00<03:36,  6.77s/it]
Task 8, Epoch 9/40 => Loss 0.552, Train_accy 56.03:  20%|██        | 8/40 [01:05<03:36,  6.77s/it]
Task 8, Epoch 9/40 => Loss 0.552, Train_accy 56.03:  22%|██▎       | 9/40 [01:05<03:12,  6.20s/it]
Task 8, Epoch 10/40 => Loss 0.553, Train_accy 57.65:  22%|██▎       | 9/40 [01:09<03:12,  6.20s/it]
Task 8, Epoch 10/40 => Loss 0.553, Train_accy 57.65:  25%|██▌       | 10/40 [01:09<02:53,  5.80s/it]
Task 8, Epoch 11/40 => Loss 0.577, Train_accy 55.74, Test_accy 67.33:  25%|██▌       | 10/40 [01:25<02:53,  5.80s/it]
Task 8, Epoch 11/40 => Loss 0.577, Train_accy 55.74, Test_accy 67.33:  28%|██▊       | 11/40 [01:25<04:12,  8.70s/it]
Task 8, Epoch 12/40 => Loss 0.537, Train_accy 56.28:  28%|██▊       | 11/40 [01:30<04:12,  8.70s/it]                 
Task 8, Epoch 12/40 => Loss 0.537, Train_accy 56.28:  30%|███       | 12/40 [01:30<03:32,  7.58s/it]
Task 8, Epoch 13/40 => Loss 0.495, Train_accy 59.56:  30%|███       | 12/40 [01:35<03:32,  7.58s/it]
Task 8, Epoch 13/40 => Loss 0.495, Train_accy 59.56:  32%|███▎      | 13/40 [01:35<03:02,  6.76s/it]
Task 8, Epoch 14/40 => Loss 0.453, Train_accy 60.76:  32%|███▎      | 13/40 [01:40<03:02,  6.76s/it]
Task 8, Epoch 14/40 => Loss 0.453, Train_accy 60.76:  35%|███▌      | 14/40 [01:40<02:42,  6.24s/it]
Task 8, Epoch 15/40 => Loss 0.500, Train_accy 58.98:  35%|███▌      | 14/40 [01:44<02:42,  6.24s/it]
Task 8, Epoch 15/40 => Loss 0.500, Train_accy 58.98:  38%|███▊      | 15/40 [01:44<02:25,  5.83s/it]
Task 8, Epoch 16/40 => Loss 0.482, Train_accy 60.68, Test_accy 67.22:  38%|███▊      | 15/40 [02:00<02:25,  5.83s/it]
Task 8, Epoch 16/40 => Loss 0.482, Train_accy 60.68, Test_accy 67.22:  40%|████      | 16/40 [02:00<03:27,  8.66s/it]
Task 8, Epoch 17/40 => Loss 0.476, Train_accy 61.35:  40%|████      | 16/40 [02:05<03:27,  8.66s/it]                 
Task 8, Epoch 17/40 => Loss 0.476, Train_accy 61.35:  42%|████▎     | 17/40 [02:05<02:53,  7.54s/it]
Task 8, Epoch 18/40 => Loss 0.468, Train_accy 61.72:  42%|████▎     | 17/40 [02:10<02:53,  7.54s/it]
Task 8, Epoch 18/40 => Loss 0.468, Train_accy 61.72:  45%|████▌     | 18/40 [02:10<02:28,  6.74s/it]
Task 8, Epoch 19/40 => Loss 0.440, Train_accy 61.72:  45%|████▌     | 18/40 [02:14<02:28,  6.74s/it]
Task 8, Epoch 19/40 => Loss 0.440, Train_accy 61.72:  48%|████▊     | 19/40 [02:14<02:10,  6.20s/it]
Task 8, Epoch 20/40 => Loss 0.415, Train_accy 63.13:  48%|████▊     | 19/40 [02:19<02:10,  6.20s/it]
Task 8, Epoch 20/40 => Loss 0.415, Train_accy 63.13:  50%|█████     | 20/40 [02:19<01:56,  5.82s/it]
Task 8, Epoch 21/40 => Loss 0.461, Train_accy 61.06, Test_accy 67.33:  50%|█████     | 20/40 [02:35<01:56,  5.82s/it]
Task 8, Epoch 21/40 => Loss 0.461, Train_accy 61.06, Test_accy 67.33:  52%|█████▎    | 21/40 [02:35<02:45,  8.69s/it]
Task 8, Epoch 22/40 => Loss 0.418, Train_accy 62.18:  52%|█████▎    | 21/40 [02:40<02:45,  8.69s/it]                 
Task 8, Epoch 22/40 => Loss 0.418, Train_accy 62.18:  55%|█████▌    | 22/40 [02:40<02:15,  7.55s/it]
Task 8, Epoch 23/40 => Loss 0.462, Train_accy 61.18:  55%|█████▌    | 22/40 [02:45<02:15,  7.55s/it]
Task 8, Epoch 23/40 => Loss 0.462, Train_accy 61.18:  57%|█████▊    | 23/40 [02:45<01:55,  6.79s/it]
Task 8, Epoch 24/40 => Loss 0.415, Train_accy 63.09:  57%|█████▊    | 23/40 [02:50<01:55,  6.79s/it]
Task 8, Epoch 24/40 => Loss 0.415, Train_accy 63.09:  60%|██████    | 24/40 [02:50<01:39,  6.22s/it]
Task 8, Epoch 25/40 => Loss 0.459, Train_accy 62.88:  60%|██████    | 24/40 [02:54<01:39,  6.22s/it]
Task 8, Epoch 25/40 => Loss 0.459, Train_accy 62.88:  62%|██████▎   | 25/40 [02:54<01:27,  5.81s/it]
Task 8, Epoch 26/40 => Loss 0.418, Train_accy 63.97, Test_accy 67.37:  62%|██████▎   | 25/40 [03:10<01:27,  5.81s/it]
Task 8, Epoch 26/40 => Loss 0.418, Train_accy 63.97, Test_accy 67.37:  65%|██████▌   | 26/40 [03:10<02:00,  8.61s/it]
Task 8, Epoch 27/40 => Loss 0.409, Train_accy 63.84:  65%|██████▌   | 26/40 [03:14<02:00,  8.61s/it]                 
Task 8, Epoch 27/40 => Loss 0.409, Train_accy 63.84:  68%|██████▊   | 27/40 [03:14<01:37,  7.49s/it]
Task 8, Epoch 28/40 => Loss 0.405, Train_accy 63.67:  68%|██████▊   | 27/40 [03:19<01:37,  7.49s/it]
Task 8, Epoch 28/40 => Loss 0.405, Train_accy 63.67:  70%|███████   | 28/40 [03:19<01:20,  6.71s/it]
Task 8, Epoch 29/40 => Loss 0.425, Train_accy 64.71:  70%|███████   | 28/40 [03:24<01:20,  6.71s/it]
Task 8, Epoch 29/40 => Loss 0.425, Train_accy 64.71:  72%|███████▎  | 29/40 [03:24<01:07,  6.16s/it]
Task 8, Epoch 30/40 => Loss 0.407, Train_accy 64.59:  72%|███████▎  | 29/40 [03:29<01:07,  6.16s/it]
Task 8, Epoch 30/40 => Loss 0.407, Train_accy 64.59:  75%|███████▌  | 30/40 [03:29<00:57,  5.77s/it]
Task 8, Epoch 31/40 => Loss 0.383, Train_accy 63.84, Test_accy 67.45:  75%|███████▌  | 30/40 [03:44<00:57,  5.77s/it]
Task 8, Epoch 31/40 => Loss 0.383, Train_accy 63.84, Test_accy 67.45:  78%|███████▊  | 31/40 [03:44<01:17,  8.60s/it]
Task 8, Epoch 32/40 => Loss 0.425, Train_accy 62.84:  78%|███████▊  | 31/40 [03:49<01:17,  8.60s/it]                 
Task 8, Epoch 32/40 => Loss 0.425, Train_accy 62.84:  80%|████████  | 32/40 [03:49<00:59,  7.48s/it]
Task 8, Epoch 33/40 => Loss 0.403, Train_accy 64.13:  80%|████████  | 32/40 [03:54<00:59,  7.48s/it]
Task 8, Epoch 33/40 => Loss 0.403, Train_accy 64.13:  82%|████████▎ | 33/40 [03:54<00:47,  6.78s/it]
Task 8, Epoch 34/40 => Loss 0.397, Train_accy 63.63:  82%|████████▎ | 33/40 [03:59<00:47,  6.78s/it]
Task 8, Epoch 34/40 => Loss 0.397, Train_accy 63.63:  85%|████████▌ | 34/40 [03:59<00:37,  6.26s/it]
Task 8, Epoch 35/40 => Loss 0.412, Train_accy 64.09:  85%|████████▌ | 34/40 [04:04<00:37,  6.26s/it]
Task 8, Epoch 35/40 => Loss 0.412, Train_accy 64.09:  88%|████████▊ | 35/40 [04:04<00:29,  5.91s/it]
Task 8, Epoch 36/40 => Loss 0.401, Train_accy 64.09, Test_accy 67.50:  88%|████████▊ | 35/40 [04:20<00:29,  5.91s/it]
Task 8, Epoch 36/40 => Loss 0.401, Train_accy 64.09, Test_accy 67.50:  90%|█████████ | 36/40 [04:20<00:34,  8.72s/it]
Task 8, Epoch 37/40 => Loss 0.393, Train_accy 65.34:  90%|█████████ | 36/40 [04:25<00:34,  8.72s/it]                 
Task 8, Epoch 37/40 => Loss 0.393, Train_accy 65.34:  92%|█████████▎| 37/40 [04:25<00:22,  7.60s/it]
Task 8, Epoch 38/40 => Loss 0.392, Train_accy 65.92:  92%|█████████▎| 37/40 [04:30<00:22,  7.60s/it]
Task 8, Epoch 38/40 => Loss 0.392, Train_accy 65.92:  95%|█████████▌| 38/40 [04:30<00:13,  6.76s/it]
Task 8, Epoch 39/40 => Loss 0.417, Train_accy 64.21:  95%|█████████▌| 38/40 [04:35<00:13,  6.76s/it]
Task 8, Epoch 39/40 => Loss 0.417, Train_accy 64.21:  98%|█████████▊| 39/40 [04:35<00:06,  6.24s/it]
Task 8, Epoch 40/40 => Loss 0.400, Train_accy 64.34:  98%|█████████▊| 39/40 [04:39<00:06,  6.24s/it]
Task 8, Epoch 40/40 => Loss 0.400, Train_accy 64.34: 100%|██████████| 40/40 [04:39<00:00,  5.82s/it]
Task 8, Epoch 40/40 => Loss 0.400, Train_accy 64.34: 100%|██████████| 40/40 [04:39<00:00,  7.00s/it]
2025-11-07 01:04:32,425 [sdfourier.py] => Task 8, Epoch 40/40 => Loss 0.400, Train_accy 64.34
2025-11-07 01:04:41,529 [sdfourier.py] => Task 8, After merge adapters => Test_accy 66.14
2025-11-07 01:04:41,531 [trainer.py] => All params: 186053508
2025-11-07 01:04:41,532 [trainer.py] => Trainable params: 151620
2025-11-07 01:04:50,577 [trainer.py] => No NME accuracy.
2025-11-07 01:04:50,577 [trainer.py] => CNN: {'total': np.float64(66.14), '00-19': np.float64(67.42), '20-39': np.float64(68.82), '40-59': np.float64(70.02), '60-79': np.float64(63.42), '80-99': np.float64(63.5), '100-119': np.float64(66.56), '120-139': np.float64(58.06), '140-159': np.float64(75.04), '160-179': np.float64(60.37), 'old': np.float64(66.14), 'new': np.float64(nan)}
2025-11-07 01:04:50,577 [trainer.py] => CNN top1 curve: [np.float64(85.25), np.float64(80.05), np.float64(77.24), np.float64(73.62), np.float64(72.05), np.float64(70.25), np.float64(67.91), np.float64(67.79), np.float64(66.14)]
2025-11-07 01:04:50,577 [trainer.py] => CNN top5 curve: [np.float64(95.14), np.float64(92.61), np.float64(90.92), np.float64(88.35), np.float64(87.31), np.float64(86.42), np.float64(84.67), np.float64(84.22), np.float64(82.49)]

Average Accuracy (CNN): 73.36666666666666
2025-11-07 01:04:50,577 [trainer.py] => Average Accuracy (CNN): 73.36666666666666 

task 9
2025-11-07 01:04:50,578 [sdfourier.py] => Learning on 180-200

总共重置了 12 个模块的qkv层权重

  0%|          | 0/40 [00:00<?, ?it/s]
Task 9, Epoch 1/40 => Loss 1.845, Train_accy 16.84, Test_accy 65.28:   0%|          | 0/40 [00:16<?, ?it/s]
Task 9, Epoch 1/40 => Loss 1.845, Train_accy 16.84, Test_accy 65.28:   2%|▎         | 1/40 [00:16<10:51, 16.71s/it]
Task 9, Epoch 2/40 => Loss 0.690, Train_accy 49.52:   2%|▎         | 1/40 [00:22<10:51, 16.71s/it]                 
Task 9, Epoch 2/40 => Loss 0.690, Train_accy 49.52:   5%|▌         | 2/40 [00:22<06:21, 10.05s/it]
Task 9, Epoch 3/40 => Loss 0.575, Train_accy 56.29:   5%|▌         | 2/40 [00:27<06:21, 10.05s/it]
Task 9, Epoch 3/40 => Loss 0.575, Train_accy 56.29:   8%|▊         | 3/40 [00:27<04:54,  7.95s/it]
Task 9, Epoch 4/40 => Loss 0.537, Train_accy 57.43:   8%|▊         | 3/40 [00:32<04:54,  7.95s/it]
Task 9, Epoch 4/40 => Loss 0.537, Train_accy 57.43:  10%|█         | 4/40 [00:32<04:09,  6.92s/it]
Task 9, Epoch 5/40 => Loss 0.483, Train_accy 59.06:  10%|█         | 4/40 [00:38<04:09,  6.92s/it]
Task 9, Epoch 5/40 => Loss 0.483, Train_accy 59.06:  12%|█▎        | 5/40 [00:38<03:41,  6.32s/it]
Task 9, Epoch 6/40 => Loss 0.467, Train_accy 59.10, Test_accy 67.10:  12%|█▎        | 5/40 [00:54<03:41,  6.32s/it]
Task 9, Epoch 6/40 => Loss 0.467, Train_accy 59.10, Test_accy 67.10:  15%|█▌        | 6/40 [00:54<05:35,  9.86s/it]
Task 9, Epoch 7/40 => Loss 0.410, Train_accy 60.70:  15%|█▌        | 6/40 [01:00<05:35,  9.86s/it]                 
Task 9, Epoch 7/40 => Loss 0.410, Train_accy 60.70:  18%|█▊        | 7/40 [01:00<04:35,  8.36s/it]
Task 9, Epoch 8/40 => Loss 0.389, Train_accy 61.61:  18%|█▊        | 7/40 [01:05<04:35,  8.36s/it]
Task 9, Epoch 8/40 => Loss 0.389, Train_accy 61.61:  20%|██        | 8/40 [01:05<03:56,  7.38s/it]
Task 9, Epoch 9/40 => Loss 0.382, Train_accy 61.50:  20%|██        | 8/40 [01:10<03:56,  7.38s/it]
Task 9, Epoch 9/40 => Loss 0.382, Train_accy 61.50:  22%|██▎       | 9/40 [01:10<03:28,  6.74s/it]
Task 9, Epoch 10/40 => Loss 0.406, Train_accy 61.80:  22%|██▎       | 9/40 [01:16<03:28,  6.74s/it]
Task 9, Epoch 10/40 => Loss 0.406, Train_accy 61.80:  25%|██▌       | 10/40 [01:16<03:09,  6.31s/it]
Task 9, Epoch 11/40 => Loss 0.370, Train_accy 64.69, Test_accy 67.15:  25%|██▌       | 10/40 [01:32<03:09,  6.31s/it]
Task 9, Epoch 11/40 => Loss 0.370, Train_accy 64.69, Test_accy 67.15:  28%|██▊       | 11/40 [01:32<04:34,  9.46s/it]
Task 9, Epoch 12/40 => Loss 0.364, Train_accy 63.89:  28%|██▊       | 11/40 [01:37<04:34,  9.46s/it]                 
Task 9, Epoch 12/40 => Loss 0.364, Train_accy 63.89:  30%|███       | 12/40 [01:37<03:49,  8.18s/it]
Task 9, Epoch 13/40 => Loss 0.367, Train_accy 64.99:  30%|███       | 12/40 [01:43<03:49,  8.18s/it]
Task 9, Epoch 13/40 => Loss 0.367, Train_accy 64.99:  32%|███▎      | 13/40 [01:43<03:17,  7.31s/it]
Task 9, Epoch 14/40 => Loss 0.336, Train_accy 64.35:  32%|███▎      | 13/40 [01:48<03:17,  7.31s/it]
Task 9, Epoch 14/40 => Loss 0.336, Train_accy 64.35:  35%|███▌      | 14/40 [01:48<02:56,  6.78s/it]
Task 9, Epoch 15/40 => Loss 0.344, Train_accy 64.42:  35%|███▌      | 14/40 [01:54<02:56,  6.78s/it]
Task 9, Epoch 15/40 => Loss 0.344, Train_accy 64.42:  38%|███▊      | 15/40 [01:54<02:38,  6.33s/it]
Task 9, Epoch 16/40 => Loss 0.344, Train_accy 64.77, Test_accy 67.13:  38%|███▊      | 15/40 [02:10<02:38,  6.33s/it]
Task 9, Epoch 16/40 => Loss 0.344, Train_accy 64.77, Test_accy 67.13:  40%|████      | 16/40 [02:10<03:46,  9.44s/it]
Task 9, Epoch 17/40 => Loss 0.351, Train_accy 65.15:  40%|████      | 16/40 [02:16<03:46,  9.44s/it]                 
Task 9, Epoch 17/40 => Loss 0.351, Train_accy 65.15:  42%|████▎     | 17/40 [02:16<03:10,  8.27s/it]
Task 9, Epoch 18/40 => Loss 0.348, Train_accy 66.59:  42%|████▎     | 17/40 [02:21<03:10,  8.27s/it]
Task 9, Epoch 18/40 => Loss 0.348, Train_accy 66.59:  45%|████▌     | 18/40 [02:21<02:42,  7.37s/it]
Task 9, Epoch 19/40 => Loss 0.309, Train_accy 65.98:  45%|████▌     | 18/40 [02:26<02:42,  7.37s/it]
Task 9, Epoch 19/40 => Loss 0.309, Train_accy 65.98:  48%|████▊     | 19/40 [02:26<02:21,  6.73s/it]
Task 9, Epoch 20/40 => Loss 0.343, Train_accy 66.70:  48%|████▊     | 19/40 [02:32<02:21,  6.73s/it]
Task 9, Epoch 20/40 => Loss 0.343, Train_accy 66.70:  50%|█████     | 20/40 [02:32<02:07,  6.38s/it]
Task 9, Epoch 21/40 => Loss 0.319, Train_accy 66.40, Test_accy 67.17:  50%|█████     | 20/40 [02:48<02:07,  6.38s/it]
Task 9, Epoch 21/40 => Loss 0.319, Train_accy 66.40, Test_accy 67.17:  52%|█████▎    | 21/40 [02:48<02:59,  9.45s/it]
Task 9, Epoch 22/40 => Loss 0.280, Train_accy 68.26:  52%|█████▎    | 21/40 [02:54<02:59,  9.45s/it]                 
Task 9, Epoch 22/40 => Loss 0.280, Train_accy 68.26:  55%|█████▌    | 22/40 [02:54<02:27,  8.19s/it]
Task 9, Epoch 23/40 => Loss 0.283, Train_accy 68.42:  55%|█████▌    | 22/40 [02:59<02:27,  8.19s/it]
Task 9, Epoch 23/40 => Loss 0.283, Train_accy 68.42:  57%|█████▊    | 23/40 [02:59<02:04,  7.33s/it]
Task 9, Epoch 24/40 => Loss 0.312, Train_accy 64.92:  57%|█████▊    | 23/40 [03:04<02:04,  7.33s/it]
Task 9, Epoch 24/40 => Loss 0.312, Train_accy 64.92:  60%|██████    | 24/40 [03:04<01:47,  6.70s/it]
Task 9, Epoch 25/40 => Loss 0.293, Train_accy 67.05:  60%|██████    | 24/40 [03:10<01:47,  6.70s/it]
Task 9, Epoch 25/40 => Loss 0.293, Train_accy 67.05:  62%|██████▎   | 25/40 [03:10<01:35,  6.35s/it]
Task 9, Epoch 26/40 => Loss 0.303, Train_accy 67.24, Test_accy 67.23:  62%|██████▎   | 25/40 [03:26<01:35,  6.35s/it]
Task 9, Epoch 26/40 => Loss 0.303, Train_accy 67.24, Test_accy 67.23:  65%|██████▌   | 26/40 [03:26<02:11,  9.42s/it]
Task 9, Epoch 27/40 => Loss 0.259, Train_accy 68.38:  65%|██████▌   | 26/40 [03:32<02:11,  9.42s/it]                 
Task 9, Epoch 27/40 => Loss 0.259, Train_accy 68.38:  68%|██████▊   | 27/40 [03:32<01:46,  8.16s/it]
Task 9, Epoch 28/40 => Loss 0.310, Train_accy 67.31:  68%|██████▊   | 27/40 [03:37<01:46,  8.16s/it]
Task 9, Epoch 28/40 => Loss 0.310, Train_accy 67.31:  70%|███████   | 28/40 [03:37<01:27,  7.31s/it]
Task 9, Epoch 29/40 => Loss 0.289, Train_accy 68.38:  70%|███████   | 28/40 [03:42<01:27,  7.31s/it]
Task 9, Epoch 29/40 => Loss 0.289, Train_accy 68.38:  72%|███████▎  | 29/40 [03:42<01:13,  6.70s/it]
Task 9, Epoch 30/40 => Loss 0.279, Train_accy 68.83:  72%|███████▎  | 29/40 [03:48<01:13,  6.70s/it]
Task 9, Epoch 30/40 => Loss 0.279, Train_accy 68.83:  75%|███████▌  | 30/40 [03:48<01:03,  6.30s/it]
Task 9, Epoch 31/40 => Loss 0.297, Train_accy 68.42, Test_accy 67.10:  75%|███████▌  | 30/40 [04:04<01:03,  6.30s/it]
Task 9, Epoch 31/40 => Loss 0.297, Train_accy 68.42, Test_accy 67.10:  78%|███████▊  | 31/40 [04:04<01:24,  9.40s/it]
Task 9, Epoch 32/40 => Loss 0.264, Train_accy 69.25:  78%|███████▊  | 31/40 [04:10<01:24,  9.40s/it]                 
Task 9, Epoch 32/40 => Loss 0.264, Train_accy 69.25:  80%|████████  | 32/40 [04:10<01:05,  8.16s/it]
Task 9, Epoch 33/40 => Loss 0.283, Train_accy 69.40:  80%|████████  | 32/40 [04:15<01:05,  8.16s/it]
Task 9, Epoch 33/40 => Loss 0.283, Train_accy 69.40:  82%|████████▎ | 33/40 [04:15<00:51,  7.30s/it]
Task 9, Epoch 34/40 => Loss 0.294, Train_accy 68.00:  82%|████████▎ | 33/40 [04:20<00:51,  7.30s/it]
Task 9, Epoch 34/40 => Loss 0.294, Train_accy 68.00:  85%|████████▌ | 34/40 [04:20<00:40,  6.69s/it]
Task 9, Epoch 35/40 => Loss 0.283, Train_accy 68.72:  85%|████████▌ | 34/40 [04:25<00:40,  6.69s/it]
Task 9, Epoch 35/40 => Loss 0.283, Train_accy 68.72:  88%|████████▊ | 35/40 [04:25<00:31,  6.27s/it]
Task 9, Epoch 36/40 => Loss 0.288, Train_accy 67.69, Test_accy 67.17:  88%|████████▊ | 35/40 [04:42<00:31,  6.27s/it]
Task 9, Epoch 36/40 => Loss 0.288, Train_accy 67.69, Test_accy 67.17:  90%|█████████ | 36/40 [04:42<00:37,  9.35s/it]
Task 9, Epoch 37/40 => Loss 0.312, Train_accy 68.15:  90%|█████████ | 36/40 [04:47<00:37,  9.35s/it]                 
Task 9, Epoch 37/40 => Loss 0.312, Train_accy 68.15:  92%|█████████▎| 37/40 [04:47<00:24,  8.13s/it]
Task 9, Epoch 38/40 => Loss 0.308, Train_accy 68.95:  92%|█████████▎| 37/40 [04:52<00:24,  8.13s/it]
Task 9, Epoch 38/40 => Loss 0.308, Train_accy 68.95:  95%|█████████▌| 38/40 [04:52<00:14,  7.27s/it]
Task 9, Epoch 39/40 => Loss 0.286, Train_accy 68.42:  95%|█████████▌| 38/40 [04:58<00:14,  7.27s/it]
Task 9, Epoch 39/40 => Loss 0.286, Train_accy 68.42:  98%|█████████▊| 39/40 [04:58<00:06,  6.67s/it]
Task 9, Epoch 40/40 => Loss 0.294, Train_accy 66.59:  98%|█████████▊| 39/40 [05:03<00:06,  6.67s/it]
Task 9, Epoch 40/40 => Loss 0.294, Train_accy 66.59: 100%|██████████| 40/40 [05:03<00:00,  6.26s/it]
Task 9, Epoch 40/40 => Loss 0.294, Train_accy 66.59: 100%|██████████| 40/40 [05:03<00:00,  7.59s/it]
2025-11-07 01:09:55,823 [sdfourier.py] => Task 9, Epoch 40/40 => Loss 0.294, Train_accy 66.59
2025-11-07 01:10:05,911 [sdfourier.py] => Task 9, After merge adapters => Test_accy 65.73
2025-11-07 01:10:05,913 [trainer.py] => All params: 186092888
2025-11-07 01:10:05,914 [trainer.py] => Trainable params: 167000
2025-11-07 01:10:15,979 [trainer.py] => No NME accuracy.
2025-11-07 01:10:15,980 [trainer.py] => CNN: {'total': np.float64(65.73), '00-19': np.float64(65.15), '20-39': np.float64(69.25), '40-59': np.float64(68.32), '60-79': np.float64(62.67), '80-99': np.float64(63.5), '100-119': np.float64(64.69), '120-139': np.float64(57.67), '140-159': np.float64(74.51), '160-179': np.float64(59.7), '180-199': np.float64(69.77), 'old': np.float64(65.73), 'new': np.float64(nan)}
2025-11-07 01:10:15,980 [trainer.py] => CNN top1 curve: [np.float64(85.25), np.float64(80.05), np.float64(77.24), np.float64(73.62), np.float64(72.05), np.float64(70.25), np.float64(67.91), np.float64(67.79), np.float64(66.14), np.float64(65.73)]
2025-11-07 01:10:15,980 [trainer.py] => CNN top5 curve: [np.float64(95.14), np.float64(92.61), np.float64(90.92), np.float64(88.35), np.float64(87.31), np.float64(86.42), np.float64(84.67), np.float64(84.22), np.float64(82.49), np.float64(81.7)]

Average Accuracy (CNN): 72.603
2025-11-07 01:10:15,980 [trainer.py] => Average Accuracy (CNN): 72.603 

Accuracy Matrix (CNN):
[[85.25 77.96 74.23 72.45 70.34 69.37 69.21 68.07 67.42 65.15]
 [ 0.   81.9  78.59 76.01 75.   69.22 68.44 68.59 66.56 64.69]
 [ 0.    0.   78.67 76.66 75.73 73.42 59.81 59.22 58.06 57.67]
 [ 0.    0.    0.   69.27 68.52 73.72 71.84 76.11 75.04 74.51]
 [ 0.    0.    0.    0.   69.5  66.57 72.18 70.26 60.37 59.7 ]
 [ 0.    0.    0.    0.    0.   68.25 65.22 70.17 68.82 69.77]
 [ 0.    0.    0.    0.    0.    0.   66.25 63.87 70.02 69.25]
 [ 0.    0.    0.    0.    0.    0.    0.   63.75 63.42 68.32]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   63.5  62.67]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   63.5 ]]
2025-11-07 01:10:15,981 [trainer.py] => Forgetting (CNN): 8.265555555555556
seed [1995]
devices_type ['1']
2025-11-08 00:12:07,309 [trainer.py] => config: ./exps/sdfourierft_inr.json
2025-11-08 00:12:07,309 [trainer.py] => seed: 1995
2025-11-08 00:12:07,309 [trainer.py] => prefix: reproduce
2025-11-08 00:12:07,309 [trainer.py] => dataset: imagenetr
2025-11-08 00:12:07,309 [trainer.py] => memory_size: 0
2025-11-08 00:12:07,309 [trainer.py] => memory_per_class: 0
2025-11-08 00:12:07,309 [trainer.py] => fixed_memory: False
2025-11-08 00:12:07,309 [trainer.py] => shuffle: True
2025-11-08 00:12:07,309 [trainer.py] => init_cls: 20
2025-11-08 00:12:07,309 [trainer.py] => increment: 20
2025-11-08 00:12:07,309 [trainer.py] => model_name: fourierft
2025-11-08 00:12:07,309 [trainer.py] => backbone_type: vit_base_patch16_224
2025-11-08 00:12:07,309 [trainer.py] => device: [device(type='cuda', index=1)]
2025-11-08 00:12:07,309 [trainer.py] => optimizer: adam
2025-11-08 00:12:07,309 [trainer.py] => scheduler: cosine
2025-11-08 00:12:07,309 [trainer.py] => filepath: ./data/imagenet-r
2025-11-08 00:12:07,309 [trainer.py] => init_epoch: 40
2025-11-08 00:12:07,309 [trainer.py] => init_lr: 0.01
2025-11-08 00:12:07,309 [trainer.py] => init_milestones: [10000]
2025-11-08 00:12:07,309 [trainer.py] => init_lr_decay: 0
2025-11-08 00:12:07,309 [trainer.py] => init_weight_decay: 0.0005
2025-11-08 00:12:07,309 [trainer.py] => epochs: 40
2025-11-08 00:12:07,309 [trainer.py] => lrate: 0.01
2025-11-08 00:12:07,309 [trainer.py] => milestones: [10000]
2025-11-08 00:12:07,309 [trainer.py] => lrate_decay: 0
2025-11-08 00:12:07,309 [trainer.py] => batch_size: 128
2025-11-08 00:12:07,309 [trainer.py] => weight_decay: 0.0002
2025-11-08 00:12:07,309 [trainer.py] => fourierft: {'n_frequency': 600, 'n_frequency_non_trainable': 0, 'scaling': 150.0, 'random_loc_seed': 42, 'init_weights': False, 'prefer': True, 'init_fc': 1, 'fourier_layer': None, 'target_modules': ['q', 'v'], 'bias': 'none', 'modules_to_save': ['classifier'], 'layers_to_transform': None, 'layers_pattern': None, 'n_frequency_pattern': {}, 'fan_in_fan_out': False}
2025-11-08 00:12:07,309 [trainer.py] => indices_file_path: ./results/fourierft_imagenetr
2025-11-08 00:12:07,309 [trainer.py] => reinit_num: 60
2025-11-08 00:12:07,310 [trainer.py] => round_number: 0
2025-11-08 00:12:07,310 [trainer.py] => task_specific_branches: True
2025-11-08 00:12:07,310 [trainer.py] => avoid_index_overlap: True
2025-11-08 00:12:07,310 [trainer.py] => merge_strategy: max
2025-11-08 00:12:07,310 [trainer.py] => merge_adapters: True
2025-11-08 00:12:07,310 [trainer.py] => dynamic_n_frequency: True
2025-11-08 00:12:07,361 [data_manager.py] => [146, 198, 169, 126, 142, 183, 108, 86, 79, 35, 112, 29, 0, 2, 59, 178, 143, 31, 147, 33, 123, 114, 194, 54, 138, 75, 158, 26, 131, 141, 180, 132, 22, 49, 116, 111, 24, 98, 107, 89, 151, 83, 185, 15, 27, 136, 65, 1, 82, 87, 99, 153, 47, 144, 145, 175, 155, 77, 191, 199, 46, 28, 76, 71, 93, 137, 5, 188, 187, 74, 103, 173, 18, 80, 88, 48, 109, 81, 91, 101, 43, 102, 61, 182, 3, 14, 40, 42, 167, 66, 57, 73, 135, 39, 45, 184, 161, 85, 148, 121, 8, 195, 21, 4, 106, 133, 118, 10, 176, 50, 36, 192, 162, 172, 96, 197, 20, 117, 140, 186, 92, 97, 44, 149, 13, 37, 170, 25, 181, 171, 23, 104, 189, 11, 159, 67, 94, 68, 55, 6, 150, 165, 120, 139, 72, 154, 115, 125, 53, 58, 16, 113, 41, 190, 174, 127, 110, 7, 38, 32, 95, 19, 196, 51, 78, 34, 122, 152, 119, 134, 129, 130, 128, 17, 30, 90, 124, 160, 100, 193, 12, 56, 64, 168, 105, 63, 177, 70, 60, 163, 9, 62, 156, 52, 84, 157, 69, 179, 166, 164]
!!!!!!! multiple_gpus [device(type='cuda', index=1)]
This is for the BaseNet initialization.
2025-11-08 00:12:08,630 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-11-08 00:12:09,501 [_client.py] => HTTP Request: HEAD https://huggingface.co/timm/vit_base_patch16_224.augreg2_in21k_ft_in1k/resolve/main/model.safetensors "HTTP/1.1 302 Found"
2025-11-08 00:12:09,503 [_hub.py] => [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
save_file ./results/fourierft_imagenetr
After BaseNet initialization.
task 0
2025-11-08 00:12:09,927 [sdfourier.py] => Learning on 0-20

  0%|          | 0/40 [00:00<?, ?it/s]
Task 0, Epoch 1/40 => Loss 2.115, Train_accy 42.69, Test_accy 80.06:   0%|          | 0/40 [00:25<?, ?it/s]
Task 0, Epoch 1/40 => Loss 2.115, Train_accy 42.69, Test_accy 80.06:   2%|▎         | 1/40 [00:25<16:38, 25.59s/it]
Task 0, Epoch 2/40 => Loss 0.872, Train_accy 75.49:   2%|▎         | 1/40 [00:47<16:38, 25.59s/it]                 
Task 0, Epoch 2/40 => Loss 0.872, Train_accy 75.49:   5%|▌         | 2/40 [00:47<14:45, 23.31s/it]
Task 0, Epoch 3/40 => Loss 0.715, Train_accy 78.93:   5%|▌         | 2/40 [01:09<14:45, 23.31s/it]
Task 0, Epoch 3/40 => Loss 0.715, Train_accy 78.93:   8%|▊         | 3/40 [01:09<13:55, 22.58s/it]
Task 0, Epoch 4/40 => Loss 0.646, Train_accy 81.71:   8%|▊         | 3/40 [01:30<13:55, 22.58s/it]
Task 0, Epoch 4/40 => Loss 0.646, Train_accy 81.71:  10%|█         | 4/40 [01:30<13:21, 22.27s/it]
Task 0, Epoch 5/40 => Loss 0.625, Train_accy 82.52:  10%|█         | 4/40 [01:52<13:21, 22.27s/it]
Task 0, Epoch 5/40 => Loss 0.625, Train_accy 82.52:  12%|█▎        | 5/40 [01:52<12:52, 22.08s/it]
Task 0, Epoch 6/40 => Loss 0.601, Train_accy 83.64, Test_accy 83.47:  12%|█▎        | 5/40 [02:17<12:52, 22.08s/it]
Task 0, Epoch 6/40 => Loss 0.601, Train_accy 83.64, Test_accy 83.47:  15%|█▌        | 6/40 [02:17<13:07, 23.16s/it]
Task 0, Epoch 7/40 => Loss 0.567, Train_accy 84.06:  15%|█▌        | 6/40 [02:39<13:07, 23.16s/it]                 
Task 0, Epoch 7/40 => Loss 0.567, Train_accy 84.06:  18%|█▊        | 7/40 [02:39<12:26, 22.64s/it]
Task 0, Epoch 8/40 => Loss 0.515, Train_accy 86.38:  18%|█▊        | 7/40 [03:01<12:26, 22.64s/it]
Task 0, Epoch 8/40 => Loss 0.515, Train_accy 86.38:  20%|██        | 8/40 [03:01<11:55, 22.36s/it]
Task 0, Epoch 9/40 => Loss 0.463, Train_accy 87.11:  20%|██        | 8/40 [03:22<11:55, 22.36s/it]
Task 0, Epoch 9/40 => Loss 0.463, Train_accy 87.11:  22%|██▎       | 9/40 [03:22<11:26, 22.14s/it]
Task 0, Epoch 10/40 => Loss 0.498, Train_accy 86.34:  22%|██▎       | 9/40 [03:44<11:26, 22.14s/it]
Task 0, Epoch 10/40 => Loss 0.498, Train_accy 86.34:  25%|██▌       | 10/40 [03:44<10:59, 21.98s/it]
Task 0, Epoch 11/40 => Loss 0.484, Train_accy 86.30, Test_accy 85.09:  25%|██▌       | 10/40 [04:09<10:59, 21.98s/it]
Task 0, Epoch 11/40 => Loss 0.484, Train_accy 86.30, Test_accy 85.09:  28%|██▊       | 11/40 [04:09<11:00, 22.79s/it]
Task 0, Epoch 12/40 => Loss 0.423, Train_accy 87.53:  28%|██▊       | 11/40 [04:30<11:00, 22.79s/it]                 
Task 0, Epoch 12/40 => Loss 0.423, Train_accy 87.53:  30%|███       | 12/40 [04:30<10:28, 22.46s/it]
Task 0, Epoch 13/40 => Loss 0.400, Train_accy 88.54:  30%|███       | 12/40 [04:52<10:28, 22.46s/it]
Task 0, Epoch 13/40 => Loss 0.400, Train_accy 88.54:  32%|███▎      | 13/40 [04:52<09:58, 22.18s/it]
Task 0, Epoch 14/40 => Loss 0.442, Train_accy 87.50:  32%|███▎      | 13/40 [05:13<09:58, 22.18s/it]
Task 0, Epoch 14/40 => Loss 0.442, Train_accy 87.50:  35%|███▌      | 14/40 [05:13<09:32, 22.00s/it]
Task 0, Epoch 15/40 => Loss 0.434, Train_accy 86.92:  35%|███▌      | 14/40 [05:35<09:32, 22.00s/it]
Task 0, Epoch 15/40 => Loss 0.434, Train_accy 86.92:  38%|███▊      | 15/40 [05:35<09:06, 21.86s/it]
Task 0, Epoch 16/40 => Loss 0.438, Train_accy 87.57, Test_accy 83.95:  38%|███▊      | 15/40 [06:00<09:06, 21.86s/it]
Task 0, Epoch 16/40 => Loss 0.438, Train_accy 87.57, Test_accy 83.95:  40%|████      | 16/40 [06:00<09:04, 22.70s/it]
Task 0, Epoch 17/40 => Loss 0.384, Train_accy 89.27:  40%|████      | 16/40 [06:21<09:04, 22.70s/it]                 
Task 0, Epoch 17/40 => Loss 0.384, Train_accy 89.27:  42%|████▎     | 17/40 [06:21<08:34, 22.36s/it]
Task 0, Epoch 18/40 => Loss 0.419, Train_accy 88.77:  42%|████▎     | 17/40 [06:43<08:34, 22.36s/it]
Task 0, Epoch 18/40 => Loss 0.419, Train_accy 88.77:  45%|████▌     | 18/40 [06:43<08:08, 22.20s/it]
Task 0, Epoch 19/40 => Loss 0.419, Train_accy 88.73:  45%|████▌     | 18/40 [07:05<08:08, 22.20s/it]
Task 0, Epoch 19/40 => Loss 0.419, Train_accy 88.73:  48%|████▊     | 19/40 [07:05<07:42, 22.02s/it]
Task 0, Epoch 20/40 => Loss 0.408, Train_accy 89.66:  48%|████▊     | 19/40 [07:26<07:42, 22.02s/it]
Task 0, Epoch 20/40 => Loss 0.408, Train_accy 89.66:  50%|█████     | 20/40 [07:26<07:19, 21.95s/it]
Task 0, Epoch 21/40 => Loss 0.387, Train_accy 89.46, Test_accy 84.12:  50%|█████     | 20/40 [07:51<07:19, 21.95s/it]
Task 0, Epoch 21/40 => Loss 0.387, Train_accy 89.46, Test_accy 84.12:  52%|█████▎    | 21/40 [07:51<07:13, 22.82s/it]
Task 0, Epoch 22/40 => Loss 0.409, Train_accy 89.04:  52%|█████▎    | 21/40 [08:13<07:13, 22.82s/it]                 
Task 0, Epoch 22/40 => Loss 0.409, Train_accy 89.04:  55%|█████▌    | 22/40 [08:13<06:44, 22.46s/it]
Task 0, Epoch 23/40 => Loss 0.406, Train_accy 88.88:  55%|█████▌    | 22/40 [08:34<06:44, 22.46s/it]
Task 0, Epoch 23/40 => Loss 0.406, Train_accy 88.88:  57%|█████▊    | 23/40 [08:34<06:17, 22.19s/it]
Task 0, Epoch 24/40 => Loss 0.374, Train_accy 89.58:  57%|█████▊    | 23/40 [08:56<06:17, 22.19s/it]
Task 0, Epoch 24/40 => Loss 0.374, Train_accy 89.58:  60%|██████    | 24/40 [08:56<05:52, 22.06s/it]
Task 0, Epoch 25/40 => Loss 0.357, Train_accy 90.00:  60%|██████    | 24/40 [09:18<05:52, 22.06s/it]
Task 0, Epoch 25/40 => Loss 0.357, Train_accy 90.00:  62%|██████▎   | 25/40 [09:18<05:29, 21.95s/it]
Task 0, Epoch 26/40 => Loss 0.342, Train_accy 90.12, Test_accy 84.44:  62%|██████▎   | 25/40 [09:42<05:29, 21.95s/it]
Task 0, Epoch 26/40 => Loss 0.342, Train_accy 90.12, Test_accy 84.44:  65%|██████▌   | 26/40 [09:42<05:18, 22.75s/it]
Task 0, Epoch 27/40 => Loss 0.386, Train_accy 89.46:  65%|██████▌   | 26/40 [10:04<05:18, 22.75s/it]                 
Task 0, Epoch 27/40 => Loss 0.386, Train_accy 89.46:  68%|██████▊   | 27/40 [10:04<04:51, 22.43s/it]
Task 0, Epoch 28/40 => Loss 0.352, Train_accy 90.27:  68%|██████▊   | 27/40 [10:26<04:51, 22.43s/it]
Task 0, Epoch 28/40 => Loss 0.352, Train_accy 90.27:  70%|███████   | 28/40 [10:26<04:25, 22.14s/it]
Task 0, Epoch 29/40 => Loss 0.358, Train_accy 90.51:  70%|███████   | 28/40 [10:47<04:25, 22.14s/it]
Task 0, Epoch 29/40 => Loss 0.358, Train_accy 90.51:  72%|███████▎  | 29/40 [10:47<04:01, 21.99s/it]
Task 0, Epoch 30/40 => Loss 0.391, Train_accy 90.16:  72%|███████▎  | 29/40 [11:09<04:01, 21.99s/it]
Task 0, Epoch 30/40 => Loss 0.391, Train_accy 90.16:  75%|███████▌  | 30/40 [11:09<03:38, 21.87s/it]
Task 0, Epoch 31/40 => Loss 0.369, Train_accy 90.24, Test_accy 84.60:  75%|███████▌  | 30/40 [11:34<03:38, 21.87s/it]
Task 0, Epoch 31/40 => Loss 0.369, Train_accy 90.24, Test_accy 84.60:  78%|███████▊  | 31/40 [11:34<03:25, 22.79s/it]
Task 0, Epoch 32/40 => Loss 0.375, Train_accy 89.97:  78%|███████▊  | 31/40 [11:55<03:25, 22.79s/it]                 
Task 0, Epoch 32/40 => Loss 0.375, Train_accy 89.97:  80%|████████  | 32/40 [11:55<02:59, 22.46s/it]
Task 0, Epoch 33/40 => Loss 0.345, Train_accy 90.35:  80%|████████  | 32/40 [12:17<02:59, 22.46s/it]
Task 0, Epoch 33/40 => Loss 0.345, Train_accy 90.35:  82%|████████▎ | 33/40 [12:17<02:35, 22.22s/it]
Task 0, Epoch 34/40 => Loss 0.368, Train_accy 89.66:  82%|████████▎ | 33/40 [12:39<02:35, 22.22s/it]
Task 0, Epoch 34/40 => Loss 0.368, Train_accy 89.66:  85%|████████▌ | 34/40 [12:39<02:12, 22.01s/it]
Task 0, Epoch 35/40 => Loss 0.355, Train_accy 89.70:  85%|████████▌ | 34/40 [13:00<02:12, 22.01s/it]
Task 0, Epoch 35/40 => Loss 0.355, Train_accy 89.70:  88%|████████▊ | 35/40 [13:00<01:49, 21.89s/it]
Task 0, Epoch 36/40 => Loss 0.362, Train_accy 89.85, Test_accy 84.76:  88%|████████▊ | 35/40 [13:25<01:49, 21.89s/it]
Task 0, Epoch 36/40 => Loss 0.362, Train_accy 89.85, Test_accy 84.76:  90%|█████████ | 36/40 [13:25<01:31, 22.86s/it]
Task 0, Epoch 37/40 => Loss 0.345, Train_accy 90.43:  90%|█████████ | 36/40 [13:47<01:31, 22.86s/it]                 
Task 0, Epoch 37/40 => Loss 0.345, Train_accy 90.43:  92%|█████████▎| 37/40 [13:47<01:07, 22.50s/it]
Task 0, Epoch 38/40 => Loss 0.339, Train_accy 91.35:  92%|█████████▎| 37/40 [14:09<01:07, 22.50s/it]
Task 0, Epoch 38/40 => Loss 0.339, Train_accy 91.35:  95%|█████████▌| 38/40 [14:09<00:44, 22.23s/it]
Task 0, Epoch 39/40 => Loss 0.355, Train_accy 89.73:  95%|█████████▌| 38/40 [14:31<00:44, 22.23s/it]
Task 0, Epoch 39/40 => Loss 0.355, Train_accy 89.73:  98%|█████████▊| 39/40 [14:31<00:22, 22.14s/it]
Task 0, Epoch 40/40 => Loss 0.392, Train_accy 89.15:  98%|█████████▊| 39/40 [14:52<00:22, 22.14s/it]
Task 0, Epoch 40/40 => Loss 0.392, Train_accy 89.15: 100%|██████████| 40/40 [14:52<00:00, 21.99s/it]
Task 0, Epoch 40/40 => Loss 0.392, Train_accy 89.15: 100%|██████████| 40/40 [14:52<00:00, 22.32s/it]
2025-11-08 00:27:03,864 [sdfourier.py] => Task 0, Epoch 40/40 => Loss 0.392, Train_accy 89.15
2025-11-08 00:27:06,634 [sdfourier.py] => Task 0, After merge adapters => Test_accy 84.76
2025-11-08 00:27:06,636 [trainer.py] => All params: 185784308
2025-11-08 00:27:06,637 [trainer.py] => Trainable params: 31220
/mnt/weitao/SD-Lora-CL-main/utils/toolkit.py:60: RuntimeWarning: invalid value encountered in scalar divide
  (y_pred[idxes] == y_true[idxes]).sum() * 100 / len(idxes), decimals=2
2025-11-08 00:27:09,380 [trainer.py] => No NME accuracy.
2025-11-08 00:27:09,380 [trainer.py] => CNN: {'total': np.float64(84.76), '00-19': np.float64(84.76), 'old': np.float64(84.76), 'new': np.float64(nan)}
2025-11-08 00:27:09,380 [trainer.py] => CNN top1 curve: [np.float64(84.76)]
2025-11-08 00:27:09,380 [trainer.py] => CNN top5 curve: [np.float64(95.79)]

Average Accuracy (CNN): 84.76
2025-11-08 00:27:09,380 [trainer.py] => Average Accuracy (CNN): 84.76 

task 1
2025-11-08 00:27:09,382 [sdfourier.py] => Learning on 20-40

总共重置了 12 个模块的qkv层权重

  0%|          | 0/40 [00:00<?, ?it/s]
Task 1, Epoch 1/40 => Loss 2.111, Train_accy 25.90, Test_accy 72.73:   0%|          | 0/40 [00:15<?, ?it/s]
Task 1, Epoch 1/40 => Loss 2.111, Train_accy 25.90, Test_accy 72.73:   2%|▎         | 1/40 [00:15<10:06, 15.55s/it]
Task 1, Epoch 2/40 => Loss 0.866, Train_accy 62.09:   2%|▎         | 1/40 [00:25<10:06, 15.55s/it]                 
Task 1, Epoch 2/40 => Loss 0.866, Train_accy 62.09:   5%|▌         | 2/40 [00:25<07:43, 12.19s/it]
Task 1, Epoch 3/40 => Loss 0.730, Train_accy 66.03:   5%|▌         | 2/40 [00:35<07:43, 12.19s/it]
Task 1, Epoch 3/40 => Loss 0.730, Train_accy 66.03:   8%|▊         | 3/40 [00:35<06:52, 11.14s/it]
Task 1, Epoch 4/40 => Loss 0.670, Train_accy 68.88:   8%|▊         | 3/40 [00:45<06:52, 11.14s/it]
Task 1, Epoch 4/40 => Loss 0.670, Train_accy 68.88:  10%|█         | 4/40 [00:45<06:22, 10.61s/it]
Task 1, Epoch 5/40 => Loss 0.607, Train_accy 70.61:  10%|█         | 4/40 [00:54<06:22, 10.61s/it]
Task 1, Epoch 5/40 => Loss 0.607, Train_accy 70.61:  12%|█▎        | 5/40 [00:54<06:01, 10.31s/it]
Task 1, Epoch 6/40 => Loss 0.568, Train_accy 73.50, Test_accy 78.83:  12%|█▎        | 5/40 [01:09<06:01, 10.31s/it]
Task 1, Epoch 6/40 => Loss 0.568, Train_accy 73.50, Test_accy 78.83:  15%|█▌        | 6/40 [01:09<06:45, 11.94s/it]
Task 1, Epoch 7/40 => Loss 0.524, Train_accy 73.31:  15%|█▌        | 6/40 [01:19<06:45, 11.94s/it]                 
Task 1, Epoch 7/40 => Loss 0.524, Train_accy 73.31:  18%|█▊        | 7/40 [01:19<06:11, 11.26s/it]
Task 1, Epoch 8/40 => Loss 0.536, Train_accy 73.50:  18%|█▊        | 7/40 [01:29<06:11, 11.26s/it]
Task 1, Epoch 8/40 => Loss 0.536, Train_accy 73.50:  20%|██        | 8/40 [01:29<05:47, 10.86s/it]
Task 1, Epoch 9/40 => Loss 0.517, Train_accy 73.95:  20%|██        | 8/40 [01:39<05:47, 10.86s/it]
Task 1, Epoch 9/40 => Loss 0.517, Train_accy 73.95:  22%|██▎       | 9/40 [01:39<05:27, 10.57s/it]
Task 1, Epoch 10/40 => Loss 0.517, Train_accy 74.06:  22%|██▎       | 9/40 [01:49<05:27, 10.57s/it]
Task 1, Epoch 10/40 => Loss 0.517, Train_accy 74.06:  25%|██▌       | 10/40 [01:49<05:10, 10.36s/it]
Task 1, Epoch 11/40 => Loss 0.472, Train_accy 76.46, Test_accy 79.06:  25%|██▌       | 10/40 [02:04<05:10, 10.36s/it]
Task 1, Epoch 11/40 => Loss 0.472, Train_accy 76.46, Test_accy 79.06:  28%|██▊       | 11/40 [02:04<05:43, 11.84s/it]
Task 1, Epoch 12/40 => Loss 0.448, Train_accy 76.43:  28%|██▊       | 11/40 [02:14<05:43, 11.84s/it]                 
Task 1, Epoch 12/40 => Loss 0.448, Train_accy 76.43:  30%|███       | 12/40 [02:14<05:16, 11.30s/it]
Task 1, Epoch 13/40 => Loss 0.477, Train_accy 77.44:  30%|███       | 12/40 [02:24<05:16, 11.30s/it]
Task 1, Epoch 13/40 => Loss 0.477, Train_accy 77.44:  32%|███▎      | 13/40 [02:24<04:53, 10.86s/it]
Task 1, Epoch 14/40 => Loss 0.454, Train_accy 77.97:  32%|███▎      | 13/40 [02:34<04:53, 10.86s/it]
Task 1, Epoch 14/40 => Loss 0.454, Train_accy 77.97:  35%|███▌      | 14/40 [02:34<04:34, 10.57s/it]
Task 1, Epoch 15/40 => Loss 0.433, Train_accy 78.68:  35%|███▌      | 14/40 [02:44<04:34, 10.57s/it]
Task 1, Epoch 15/40 => Loss 0.433, Train_accy 78.68:  38%|███▊      | 15/40 [02:44<04:20, 10.40s/it]
Task 1, Epoch 16/40 => Loss 0.425, Train_accy 79.24, Test_accy 79.06:  38%|███▊      | 15/40 [02:59<04:20, 10.40s/it]
Task 1, Epoch 16/40 => Loss 0.425, Train_accy 79.24, Test_accy 79.06:  40%|████      | 16/40 [02:59<04:45, 11.88s/it]
Task 1, Epoch 17/40 => Loss 0.423, Train_accy 78.15:  40%|████      | 16/40 [03:09<04:45, 11.88s/it]                 
Task 1, Epoch 17/40 => Loss 0.423, Train_accy 78.15:  42%|████▎     | 17/40 [03:09<04:19, 11.27s/it]
Task 1, Epoch 18/40 => Loss 0.430, Train_accy 79.62:  42%|████▎     | 17/40 [03:19<04:19, 11.27s/it]
Task 1, Epoch 18/40 => Loss 0.430, Train_accy 79.62:  45%|████▌     | 18/40 [03:19<03:58, 10.83s/it]
Task 1, Epoch 19/40 => Loss 0.407, Train_accy 79.88:  45%|████▌     | 18/40 [03:29<03:58, 10.83s/it]
Task 1, Epoch 19/40 => Loss 0.407, Train_accy 79.88:  48%|████▊     | 19/40 [03:29<03:40, 10.51s/it]
Task 1, Epoch 20/40 => Loss 0.415, Train_accy 80.03:  48%|████▊     | 19/40 [03:39<03:40, 10.51s/it]
Task 1, Epoch 20/40 => Loss 0.415, Train_accy 80.03:  50%|█████     | 20/40 [03:39<03:25, 10.29s/it]
Task 1, Epoch 21/40 => Loss 0.405, Train_accy 79.02, Test_accy 79.44:  50%|█████     | 20/40 [03:54<03:25, 10.29s/it]
Task 1, Epoch 21/40 => Loss 0.405, Train_accy 79.02, Test_accy 79.44:  52%|█████▎    | 21/40 [03:54<03:42, 11.73s/it]
Task 1, Epoch 22/40 => Loss 0.411, Train_accy 80.33:  52%|█████▎    | 21/40 [04:04<03:42, 11.73s/it]                 
Task 1, Epoch 22/40 => Loss 0.411, Train_accy 80.33:  55%|█████▌    | 22/40 [04:04<03:21, 11.18s/it]
Task 1, Epoch 23/40 => Loss 0.389, Train_accy 80.48:  55%|█████▌    | 22/40 [04:14<03:21, 11.18s/it]
Task 1, Epoch 23/40 => Loss 0.389, Train_accy 80.48:  57%|█████▊    | 23/40 [04:14<03:03, 10.79s/it]
Task 1, Epoch 24/40 => Loss 0.385, Train_accy 80.18:  57%|█████▊    | 23/40 [04:23<03:03, 10.79s/it]
Task 1, Epoch 24/40 => Loss 0.385, Train_accy 80.18:  60%|██████    | 24/40 [04:23<02:47, 10.50s/it]
Task 1, Epoch 25/40 => Loss 0.360, Train_accy 81.46:  60%|██████    | 24/40 [04:33<02:47, 10.50s/it]
Task 1, Epoch 25/40 => Loss 0.360, Train_accy 81.46:  62%|██████▎   | 25/40 [04:33<02:34, 10.29s/it]
Task 1, Epoch 26/40 => Loss 0.386, Train_accy 80.56, Test_accy 79.74:  62%|██████▎   | 25/40 [04:48<02:34, 10.29s/it]
Task 1, Epoch 26/40 => Loss 0.386, Train_accy 80.56, Test_accy 79.74:  65%|██████▌   | 26/40 [04:48<02:44, 11.77s/it]
Task 1, Epoch 27/40 => Loss 0.357, Train_accy 81.98:  65%|██████▌   | 26/40 [04:58<02:44, 11.77s/it]                 
Task 1, Epoch 27/40 => Loss 0.357, Train_accy 81.98:  68%|██████▊   | 27/40 [04:58<02:25, 11.18s/it]
Task 1, Epoch 28/40 => Loss 0.391, Train_accy 80.29:  68%|██████▊   | 27/40 [05:08<02:25, 11.18s/it]
Task 1, Epoch 28/40 => Loss 0.391, Train_accy 80.29:  70%|███████   | 28/40 [05:08<02:09, 10.77s/it]
Task 1, Epoch 29/40 => Loss 0.399, Train_accy 80.74:  70%|███████   | 28/40 [05:18<02:09, 10.77s/it]
Task 1, Epoch 29/40 => Loss 0.399, Train_accy 80.74:  72%|███████▎  | 29/40 [05:18<01:55, 10.47s/it]
Task 1, Epoch 30/40 => Loss 0.353, Train_accy 81.57:  72%|███████▎  | 29/40 [05:28<01:55, 10.47s/it]
Task 1, Epoch 30/40 => Loss 0.353, Train_accy 81.57:  75%|███████▌  | 30/40 [05:28<01:43, 10.31s/it]
Task 1, Epoch 31/40 => Loss 0.373, Train_accy 81.64, Test_accy 79.89:  75%|███████▌  | 30/40 [05:43<01:43, 10.31s/it]
Task 1, Epoch 31/40 => Loss 0.373, Train_accy 81.64, Test_accy 79.89:  78%|███████▊  | 31/40 [05:43<01:47, 11.95s/it]
Task 1, Epoch 32/40 => Loss 0.333, Train_accy 82.70:  78%|███████▊  | 31/40 [05:53<01:47, 11.95s/it]                 
Task 1, Epoch 32/40 => Loss 0.333, Train_accy 82.70:  80%|████████  | 32/40 [05:53<01:30, 11.30s/it]
Task 1, Epoch 33/40 => Loss 0.390, Train_accy 81.04:  80%|████████  | 32/40 [06:03<01:30, 11.30s/it]
Task 1, Epoch 33/40 => Loss 0.390, Train_accy 81.04:  82%|████████▎ | 33/40 [06:03<01:15, 10.84s/it]
Task 1, Epoch 34/40 => Loss 0.358, Train_accy 82.96:  82%|████████▎ | 33/40 [06:13<01:15, 10.84s/it]
Task 1, Epoch 34/40 => Loss 0.358, Train_accy 82.96:  85%|████████▌ | 34/40 [06:13<01:03, 10.56s/it]
Task 1, Epoch 35/40 => Loss 0.362, Train_accy 81.68:  85%|████████▌ | 34/40 [06:23<01:03, 10.56s/it]
Task 1, Epoch 35/40 => Loss 0.362, Train_accy 81.68:  88%|████████▊ | 35/40 [06:23<00:51, 10.31s/it]
Task 1, Epoch 36/40 => Loss 0.385, Train_accy 80.78, Test_accy 79.59:  88%|████████▊ | 35/40 [06:38<00:51, 10.31s/it]
Task 1, Epoch 36/40 => Loss 0.385, Train_accy 80.78, Test_accy 79.59:  90%|█████████ | 36/40 [06:38<00:47, 11.75s/it]
Task 1, Epoch 37/40 => Loss 0.365, Train_accy 81.19:  90%|█████████ | 36/40 [06:48<00:47, 11.75s/it]                 
Task 1, Epoch 37/40 => Loss 0.365, Train_accy 81.19:  92%|█████████▎| 37/40 [06:48<00:33, 11.16s/it]
Task 1, Epoch 38/40 => Loss 0.367, Train_accy 81.61:  92%|█████████▎| 37/40 [06:57<00:33, 11.16s/it]
Task 1, Epoch 38/40 => Loss 0.367, Train_accy 81.61:  95%|█████████▌| 38/40 [06:57<00:21, 10.75s/it]
Task 1, Epoch 39/40 => Loss 0.366, Train_accy 81.19:  95%|█████████▌| 38/40 [07:07<00:21, 10.75s/it]
Task 1, Epoch 39/40 => Loss 0.366, Train_accy 81.19:  98%|█████████▊| 39/40 [07:07<00:10, 10.50s/it]
Task 1, Epoch 40/40 => Loss 0.374, Train_accy 80.63:  98%|█████████▊| 39/40 [07:17<00:10, 10.50s/it]
Task 1, Epoch 40/40 => Loss 0.374, Train_accy 80.63: 100%|██████████| 40/40 [07:17<00:00, 10.28s/it]
Task 1, Epoch 40/40 => Loss 0.374, Train_accy 80.63: 100%|██████████| 40/40 [07:17<00:00, 10.94s/it]
2025-11-08 00:34:27,453 [sdfourier.py] => Task 1, Epoch 40/40 => Loss 0.374, Train_accy 80.63
2025-11-08 00:34:32,378 [sdfourier.py] => Task 1, After merge adapters => Test_accy 79.21
2025-11-08 00:34:32,380 [trainer.py] => All params: 185816968
2025-11-08 00:34:32,381 [trainer.py] => Trainable params: 46600
2025-11-08 00:34:37,158 [trainer.py] => No NME accuracy.
2025-11-08 00:34:37,159 [trainer.py] => CNN: {'total': np.float64(79.21), '00-19': np.float64(78.77), '20-39': np.float64(79.6), 'old': np.float64(79.21), 'new': np.float64(nan)}
2025-11-08 00:34:37,159 [trainer.py] => CNN top1 curve: [np.float64(84.76), np.float64(79.21)]
2025-11-08 00:34:37,159 [trainer.py] => CNN top5 curve: [np.float64(95.79), np.float64(92.08)]

Average Accuracy (CNN): 81.985
2025-11-08 00:34:37,159 [trainer.py] => Average Accuracy (CNN): 81.985 

task 2
2025-11-08 00:34:37,161 [sdfourier.py] => Learning on 40-60

总共重置了 12 个模块的qkv层权重

  0%|          | 0/40 [00:00<?, ?it/s]
Task 2, Epoch 1/40 => Loss 2.036, Train_accy 23.22, Test_accy 72.86:   0%|          | 0/40 [00:17<?, ?it/s]
Task 2, Epoch 1/40 => Loss 2.036, Train_accy 23.22, Test_accy 72.86:   2%|▎         | 1/40 [00:17<11:18, 17.39s/it]
Task 2, Epoch 2/40 => Loss 0.834, Train_accy 62.38:   2%|▎         | 1/40 [00:27<11:18, 17.39s/it]                 
Task 2, Epoch 2/40 => Loss 0.834, Train_accy 62.38:   5%|▌         | 2/40 [00:27<08:10, 12.92s/it]
Task 2, Epoch 3/40 => Loss 0.659, Train_accy 67.76:   5%|▌         | 2/40 [00:36<08:10, 12.92s/it]
Task 2, Epoch 3/40 => Loss 0.659, Train_accy 67.76:   8%|▊         | 3/40 [00:36<07:04, 11.46s/it]
Task 2, Epoch 4/40 => Loss 0.567, Train_accy 71.24:   8%|▊         | 3/40 [00:46<07:04, 11.46s/it]
Task 2, Epoch 4/40 => Loss 0.567, Train_accy 71.24:  10%|█         | 4/40 [00:46<06:28, 10.79s/it]
Task 2, Epoch 5/40 => Loss 0.533, Train_accy 72.19:  10%|█         | 4/40 [00:56<06:28, 10.79s/it]
Task 2, Epoch 5/40 => Loss 0.533, Train_accy 72.19:  12%|█▎        | 5/40 [00:56<06:03, 10.39s/it]
Task 2, Epoch 6/40 => Loss 0.510, Train_accy 73.87, Test_accy 76.58:  12%|█▎        | 5/40 [01:13<06:03, 10.39s/it]
Task 2, Epoch 6/40 => Loss 0.510, Train_accy 73.87, Test_accy 76.58:  15%|█▌        | 6/40 [01:13<07:15, 12.80s/it]
Task 2, Epoch 7/40 => Loss 0.488, Train_accy 74.29:  15%|█▌        | 6/40 [01:23<07:15, 12.80s/it]                 
Task 2, Epoch 7/40 => Loss 0.488, Train_accy 74.29:  18%|█▊        | 7/40 [01:23<06:30, 11.82s/it]
Task 2, Epoch 8/40 => Loss 0.458, Train_accy 75.63:  18%|█▊        | 7/40 [01:33<06:30, 11.82s/it]
Task 2, Epoch 8/40 => Loss 0.458, Train_accy 75.63:  20%|██        | 8/40 [01:33<05:57, 11.17s/it]
Task 2, Epoch 9/40 => Loss 0.446, Train_accy 75.90:  20%|██        | 8/40 [01:42<05:57, 11.17s/it]
Task 2, Epoch 9/40 => Loss 0.446, Train_accy 75.90:  22%|██▎       | 9/40 [01:42<05:30, 10.67s/it]
Task 2, Epoch 10/40 => Loss 0.441, Train_accy 77.12:  22%|██▎       | 9/40 [01:52<05:30, 10.67s/it]
Task 2, Epoch 10/40 => Loss 0.441, Train_accy 77.12:  25%|██▌       | 10/40 [01:52<05:11, 10.39s/it]
Task 2, Epoch 11/40 => Loss 0.404, Train_accy 78.50, Test_accy 77.14:  25%|██▌       | 10/40 [02:10<05:11, 10.39s/it]
Task 2, Epoch 11/40 => Loss 0.404, Train_accy 78.50, Test_accy 77.14:  28%|██▊       | 11/40 [02:10<06:03, 12.55s/it]
Task 2, Epoch 12/40 => Loss 0.390, Train_accy 77.77:  28%|██▊       | 11/40 [02:19<06:03, 12.55s/it]                 
Task 2, Epoch 12/40 => Loss 0.390, Train_accy 77.77:  30%|███       | 12/40 [02:19<05:27, 11.71s/it]
Task 2, Epoch 13/40 => Loss 0.402, Train_accy 77.62:  30%|███       | 12/40 [02:29<05:27, 11.71s/it]
Task 2, Epoch 13/40 => Loss 0.402, Train_accy 77.62:  32%|███▎      | 13/40 [02:29<05:00, 11.14s/it]
Task 2, Epoch 14/40 => Loss 0.382, Train_accy 79.14:  32%|███▎      | 13/40 [02:39<05:00, 11.14s/it]
Task 2, Epoch 14/40 => Loss 0.382, Train_accy 79.14:  35%|███▌      | 14/40 [02:39<04:37, 10.67s/it]
Task 2, Epoch 15/40 => Loss 0.382, Train_accy 79.26:  35%|███▌      | 14/40 [02:49<04:37, 10.67s/it]
Task 2, Epoch 15/40 => Loss 0.382, Train_accy 79.26:  38%|███▊      | 15/40 [02:49<04:19, 10.39s/it]
Task 2, Epoch 16/40 => Loss 0.388, Train_accy 79.30, Test_accy 77.65:  38%|███▊      | 15/40 [03:06<04:19, 10.39s/it]
Task 2, Epoch 16/40 => Loss 0.388, Train_accy 79.30, Test_accy 77.65:  40%|████      | 16/40 [03:06<04:59, 12.48s/it]
Task 2, Epoch 17/40 => Loss 0.349, Train_accy 80.86:  40%|████      | 16/40 [03:16<04:59, 12.48s/it]                 
Task 2, Epoch 17/40 => Loss 0.349, Train_accy 80.86:  42%|████▎     | 17/40 [03:16<04:27, 11.64s/it]
Task 2, Epoch 18/40 => Loss 0.352, Train_accy 81.28:  42%|████▎     | 17/40 [03:25<04:27, 11.64s/it]
Task 2, Epoch 18/40 => Loss 0.352, Train_accy 81.28:  45%|████▌     | 18/40 [03:25<04:02, 11.04s/it]
Task 2, Epoch 19/40 => Loss 0.363, Train_accy 81.17:  45%|████▌     | 18/40 [03:35<04:02, 11.04s/it]
Task 2, Epoch 19/40 => Loss 0.363, Train_accy 81.17:  48%|████▊     | 19/40 [03:35<03:44, 10.67s/it]
Task 2, Epoch 20/40 => Loss 0.320, Train_accy 81.97:  48%|████▊     | 19/40 [03:45<03:44, 10.67s/it]
Task 2, Epoch 20/40 => Loss 0.320, Train_accy 81.97:  50%|█████     | 20/40 [03:45<03:27, 10.39s/it]
Task 2, Epoch 21/40 => Loss 0.366, Train_accy 81.21, Test_accy 77.60:  50%|█████     | 20/40 [04:02<03:27, 10.39s/it]
Task 2, Epoch 21/40 => Loss 0.366, Train_accy 81.21, Test_accy 77.60:  52%|█████▎    | 21/40 [04:02<03:58, 12.54s/it]
Task 2, Epoch 22/40 => Loss 0.332, Train_accy 82.47:  52%|█████▎    | 21/40 [04:12<03:58, 12.54s/it]                 
Task 2, Epoch 22/40 => Loss 0.332, Train_accy 82.47:  55%|█████▌    | 22/40 [04:12<03:30, 11.70s/it]
Task 2, Epoch 23/40 => Loss 0.307, Train_accy 82.93:  55%|█████▌    | 22/40 [04:22<03:30, 11.70s/it]
Task 2, Epoch 23/40 => Loss 0.307, Train_accy 82.93:  57%|█████▊    | 23/40 [04:22<03:08, 11.10s/it]
Task 2, Epoch 24/40 => Loss 0.337, Train_accy 82.20:  57%|█████▊    | 23/40 [04:32<03:08, 11.10s/it]
Task 2, Epoch 24/40 => Loss 0.337, Train_accy 82.20:  60%|██████    | 24/40 [04:32<02:51, 10.70s/it]
Task 2, Epoch 25/40 => Loss 0.331, Train_accy 82.96:  60%|██████    | 24/40 [04:41<02:51, 10.70s/it]
Task 2, Epoch 25/40 => Loss 0.331, Train_accy 82.96:  62%|██████▎   | 25/40 [04:41<02:36, 10.43s/it]
Task 2, Epoch 26/40 => Loss 0.327, Train_accy 82.62, Test_accy 78.06:  62%|██████▎   | 25/40 [04:59<02:36, 10.43s/it]
Task 2, Epoch 26/40 => Loss 0.327, Train_accy 82.62, Test_accy 78.06:  65%|██████▌   | 26/40 [04:59<02:56, 12.59s/it]
Task 2, Epoch 27/40 => Loss 0.342, Train_accy 81.51:  65%|██████▌   | 26/40 [05:09<02:56, 12.59s/it]                 
Task 2, Epoch 27/40 => Loss 0.342, Train_accy 81.51:  68%|██████▊   | 27/40 [05:09<02:33, 11.77s/it]
Task 2, Epoch 28/40 => Loss 0.346, Train_accy 81.25:  68%|██████▊   | 27/40 [05:19<02:33, 11.77s/it]
Task 2, Epoch 28/40 => Loss 0.346, Train_accy 81.25:  70%|███████   | 28/40 [05:19<02:13, 11.13s/it]
Task 2, Epoch 29/40 => Loss 0.335, Train_accy 81.55:  70%|███████   | 28/40 [05:28<02:13, 11.13s/it]
Task 2, Epoch 29/40 => Loss 0.335, Train_accy 81.55:  72%|███████▎  | 29/40 [05:28<01:57, 10.71s/it]
Task 2, Epoch 30/40 => Loss 0.316, Train_accy 82.12:  72%|███████▎  | 29/40 [05:38<01:57, 10.71s/it]
Task 2, Epoch 30/40 => Loss 0.316, Train_accy 82.12:  75%|███████▌  | 30/40 [05:38<01:43, 10.38s/it]
Task 2, Epoch 31/40 => Loss 0.313, Train_accy 82.31, Test_accy 77.86:  75%|███████▌  | 30/40 [05:55<01:43, 10.38s/it]
Task 2, Epoch 31/40 => Loss 0.313, Train_accy 82.31, Test_accy 77.86:  78%|███████▊  | 31/40 [05:55<01:51, 12.44s/it]
Task 2, Epoch 32/40 => Loss 0.317, Train_accy 82.43:  78%|███████▊  | 31/40 [06:05<01:51, 12.44s/it]                 
Task 2, Epoch 32/40 => Loss 0.317, Train_accy 82.43:  80%|████████  | 32/40 [06:05<01:33, 11.64s/it]
Task 2, Epoch 33/40 => Loss 0.319, Train_accy 82.28:  80%|████████  | 32/40 [06:15<01:33, 11.64s/it]
Task 2, Epoch 33/40 => Loss 0.319, Train_accy 82.28:  82%|████████▎ | 33/40 [06:15<01:17, 11.06s/it]
Task 2, Epoch 34/40 => Loss 0.316, Train_accy 83.19:  82%|████████▎ | 33/40 [06:25<01:17, 11.06s/it]
Task 2, Epoch 34/40 => Loss 0.316, Train_accy 83.19:  85%|████████▌ | 34/40 [06:25<01:04, 10.75s/it]
Task 2, Epoch 35/40 => Loss 0.311, Train_accy 82.47:  85%|████████▌ | 34/40 [06:34<01:04, 10.75s/it]
Task 2, Epoch 35/40 => Loss 0.311, Train_accy 82.47:  88%|████████▊ | 35/40 [06:34<00:52, 10.46s/it]
Task 2, Epoch 36/40 => Loss 0.314, Train_accy 83.38, Test_accy 77.91:  88%|████████▊ | 35/40 [06:52<00:52, 10.46s/it]
Task 2, Epoch 36/40 => Loss 0.314, Train_accy 83.38, Test_accy 77.91:  90%|█████████ | 36/40 [06:52<00:50, 12.52s/it]
Task 2, Epoch 37/40 => Loss 0.292, Train_accy 82.77:  90%|█████████ | 36/40 [07:01<00:50, 12.52s/it]                 
Task 2, Epoch 37/40 => Loss 0.292, Train_accy 82.77:  92%|█████████▎| 37/40 [07:01<00:35, 11.68s/it]
Task 2, Epoch 38/40 => Loss 0.283, Train_accy 84.00:  92%|█████████▎| 37/40 [07:11<00:35, 11.68s/it]
Task 2, Epoch 38/40 => Loss 0.283, Train_accy 84.00:  95%|█████████▌| 38/40 [07:11<00:22, 11.08s/it]
Task 2, Epoch 39/40 => Loss 0.319, Train_accy 81.93:  95%|█████████▌| 38/40 [07:21<00:22, 11.08s/it]
Task 2, Epoch 39/40 => Loss 0.319, Train_accy 81.93:  98%|█████████▊| 39/40 [07:21<00:10, 10.70s/it]
Task 2, Epoch 40/40 => Loss 0.311, Train_accy 82.96:  98%|█████████▊| 39/40 [07:31<00:10, 10.70s/it]
Task 2, Epoch 40/40 => Loss 0.311, Train_accy 82.96: 100%|██████████| 40/40 [07:31<00:00, 10.39s/it]
Task 2, Epoch 40/40 => Loss 0.311, Train_accy 82.96: 100%|██████████| 40/40 [07:31<00:00, 11.28s/it]
2025-11-08 00:42:08,900 [sdfourier.py] => Task 2, Epoch 40/40 => Loss 0.311, Train_accy 82.96
2025-11-08 00:42:15,784 [sdfourier.py] => Task 2, After merge adapters => Test_accy 77.65
2025-11-08 00:42:15,786 [trainer.py] => All params: 185851068
2025-11-08 00:42:15,787 [trainer.py] => Trainable params: 61980
2025-11-08 00:42:22,570 [trainer.py] => No NME accuracy.
2025-11-08 00:42:22,570 [trainer.py] => CNN: {'total': np.float64(77.65), '00-19': np.float64(75.36), '20-39': np.float64(77.44), '40-59': np.float64(80.06), 'old': np.float64(77.65), 'new': np.float64(nan)}
2025-11-08 00:42:22,570 [trainer.py] => CNN top1 curve: [np.float64(84.76), np.float64(79.21), np.float64(77.65)]
2025-11-08 00:42:22,570 [trainer.py] => CNN top5 curve: [np.float64(95.79), np.float64(92.08), np.float64(91.12)]

Average Accuracy (CNN): 80.54
2025-11-08 00:42:22,571 [trainer.py] => Average Accuracy (CNN): 80.54 

task 3
2025-11-08 00:42:22,573 [sdfourier.py] => Learning on 60-80

总共重置了 12 个模块的qkv层权重

  0%|          | 0/40 [00:00<?, ?it/s]
Task 3, Epoch 1/40 => Loss 2.025, Train_accy 13.83, Test_accy 69.01:   0%|          | 0/40 [00:19<?, ?it/s]
Task 3, Epoch 1/40 => Loss 2.025, Train_accy 13.83, Test_accy 69.01:   2%|▎         | 1/40 [00:19<12:51, 19.78s/it]
Task 3, Epoch 2/40 => Loss 0.844, Train_accy 49.85:   2%|▎         | 1/40 [00:29<12:51, 19.78s/it]                 
Task 3, Epoch 2/40 => Loss 0.844, Train_accy 49.85:   5%|▌         | 2/40 [00:29<08:50, 13.97s/it]
Task 3, Epoch 3/40 => Loss 0.668, Train_accy 55.96:   5%|▌         | 2/40 [00:39<08:50, 13.97s/it]
Task 3, Epoch 3/40 => Loss 0.668, Train_accy 55.96:   8%|▊         | 3/40 [00:39<07:29, 12.14s/it]
Task 3, Epoch 4/40 => Loss 0.614, Train_accy 58.25:   8%|▊         | 3/40 [00:49<07:29, 12.14s/it]
Task 3, Epoch 4/40 => Loss 0.614, Train_accy 58.25:  10%|█         | 4/40 [00:49<06:45, 11.27s/it]
Task 3, Epoch 5/40 => Loss 0.558, Train_accy 59.90:  10%|█         | 4/40 [00:59<06:45, 11.27s/it]
Task 3, Epoch 5/40 => Loss 0.558, Train_accy 59.90:  12%|█▎        | 5/40 [00:59<06:15, 10.74s/it]
Task 3, Epoch 6/40 => Loss 0.556, Train_accy 60.31, Test_accy 73.20:  12%|█▎        | 5/40 [01:19<06:15, 10.74s/it]
Task 3, Epoch 6/40 => Loss 0.556, Train_accy 60.31, Test_accy 73.20:  15%|█▌        | 6/40 [01:19<07:48, 13.78s/it]
Task 3, Epoch 7/40 => Loss 0.495, Train_accy 62.74:  15%|█▌        | 6/40 [01:29<07:48, 13.78s/it]                 
Task 3, Epoch 7/40 => Loss 0.495, Train_accy 62.74:  18%|█▊        | 7/40 [01:29<06:54, 12.55s/it]
Task 3, Epoch 8/40 => Loss 0.507, Train_accy 63.08:  18%|█▊        | 7/40 [01:38<06:54, 12.55s/it]
Task 3, Epoch 8/40 => Loss 0.507, Train_accy 63.08:  20%|██        | 8/40 [01:38<06:14, 11.70s/it]
Task 3, Epoch 9/40 => Loss 0.500, Train_accy 63.46:  20%|██        | 8/40 [01:48<06:14, 11.70s/it]
Task 3, Epoch 9/40 => Loss 0.500, Train_accy 63.46:  22%|██▎       | 9/40 [01:48<05:44, 11.10s/it]
Task 3, Epoch 10/40 => Loss 0.501, Train_accy 62.59:  22%|██▎       | 9/40 [01:58<05:44, 11.10s/it]
Task 3, Epoch 10/40 => Loss 0.501, Train_accy 62.59:  25%|██▌       | 10/40 [01:58<05:22, 10.76s/it]
Task 3, Epoch 11/40 => Loss 0.493, Train_accy 63.19, Test_accy 73.62:  25%|██▌       | 10/40 [02:18<05:22, 10.76s/it]
Task 3, Epoch 11/40 => Loss 0.493, Train_accy 63.19, Test_accy 73.62:  28%|██▊       | 11/40 [02:18<06:34, 13.59s/it]
Task 3, Epoch 12/40 => Loss 0.426, Train_accy 66.30:  28%|██▊       | 11/40 [02:28<06:34, 13.59s/it]                 
Task 3, Epoch 12/40 => Loss 0.426, Train_accy 66.30:  30%|███       | 12/40 [02:28<05:49, 12.49s/it]
Task 3, Epoch 13/40 => Loss 0.434, Train_accy 66.19:  30%|███       | 12/40 [02:38<05:49, 12.49s/it]
Task 3, Epoch 13/40 => Loss 0.434, Train_accy 66.19:  32%|███▎      | 13/40 [02:38<05:15, 11.68s/it]
Task 3, Epoch 14/40 => Loss 0.422, Train_accy 65.85:  32%|███▎      | 13/40 [02:48<05:15, 11.68s/it]
Task 3, Epoch 14/40 => Loss 0.422, Train_accy 65.85:  35%|███▌      | 14/40 [02:48<04:50, 11.17s/it]
Task 3, Epoch 15/40 => Loss 0.464, Train_accy 65.40:  35%|███▌      | 14/40 [02:58<04:50, 11.17s/it]
Task 3, Epoch 15/40 => Loss 0.464, Train_accy 65.40:  38%|███▊      | 15/40 [02:58<04:29, 10.78s/it]
Task 3, Epoch 16/40 => Loss 0.413, Train_accy 67.28, Test_accy 74.15:  38%|███▊      | 15/40 [03:18<04:29, 10.78s/it]
Task 3, Epoch 16/40 => Loss 0.413, Train_accy 67.28, Test_accy 74.15:  40%|████      | 16/40 [03:18<05:25, 13.56s/it]
Task 3, Epoch 17/40 => Loss 0.383, Train_accy 67.69:  40%|████      | 16/40 [03:28<05:25, 13.56s/it]                 
Task 3, Epoch 17/40 => Loss 0.383, Train_accy 67.69:  42%|████▎     | 17/40 [03:28<04:46, 12.48s/it]
Task 3, Epoch 18/40 => Loss 0.415, Train_accy 67.09:  42%|████▎     | 17/40 [03:38<04:46, 12.48s/it]
Task 3, Epoch 18/40 => Loss 0.415, Train_accy 67.09:  45%|████▌     | 18/40 [03:38<04:17, 11.71s/it]
Task 3, Epoch 19/40 => Loss 0.406, Train_accy 67.65:  45%|████▌     | 18/40 [03:48<04:17, 11.71s/it]
Task 3, Epoch 19/40 => Loss 0.406, Train_accy 67.65:  48%|████▊     | 19/40 [03:48<03:54, 11.18s/it]
Task 3, Epoch 20/40 => Loss 0.381, Train_accy 68.18:  48%|████▊     | 19/40 [03:58<03:54, 11.18s/it]
Task 3, Epoch 20/40 => Loss 0.381, Train_accy 68.18:  50%|█████     | 20/40 [03:58<03:35, 10.79s/it]
Task 3, Epoch 21/40 => Loss 0.392, Train_accy 67.47, Test_accy 74.42:  50%|█████     | 20/40 [04:17<03:35, 10.79s/it]
Task 3, Epoch 21/40 => Loss 0.392, Train_accy 67.47, Test_accy 74.42:  52%|█████▎    | 21/40 [04:17<04:16, 13.49s/it]
Task 3, Epoch 22/40 => Loss 0.373, Train_accy 68.97:  52%|█████▎    | 21/40 [04:27<04:16, 13.49s/it]                 
Task 3, Epoch 22/40 => Loss 0.373, Train_accy 68.97:  55%|█████▌    | 22/40 [04:27<03:44, 12.45s/it]
Task 3, Epoch 23/40 => Loss 0.364, Train_accy 68.48:  55%|█████▌    | 22/40 [04:38<03:44, 12.45s/it]
Task 3, Epoch 23/40 => Loss 0.364, Train_accy 68.48:  57%|█████▊    | 23/40 [04:38<03:20, 11.79s/it]
Task 3, Epoch 24/40 => Loss 0.375, Train_accy 68.48:  57%|█████▊    | 23/40 [04:48<03:20, 11.79s/it]
Task 3, Epoch 24/40 => Loss 0.375, Train_accy 68.48:  60%|██████    | 24/40 [04:48<02:59, 11.22s/it]
Task 3, Epoch 25/40 => Loss 0.379, Train_accy 69.04:  60%|██████    | 24/40 [04:58<02:59, 11.22s/it]
Task 3, Epoch 25/40 => Loss 0.379, Train_accy 69.04:  62%|██████▎   | 25/40 [04:58<02:43, 10.87s/it]
Task 3, Epoch 26/40 => Loss 0.364, Train_accy 70.09, Test_accy 74.27:  62%|██████▎   | 25/40 [05:17<02:43, 10.87s/it]
Task 3, Epoch 26/40 => Loss 0.364, Train_accy 70.09, Test_accy 74.27:  65%|██████▌   | 26/40 [05:17<03:09, 13.55s/it]
Task 3, Epoch 27/40 => Loss 0.364, Train_accy 69.27:  65%|██████▌   | 26/40 [05:27<03:09, 13.55s/it]                 
Task 3, Epoch 27/40 => Loss 0.364, Train_accy 69.27:  68%|██████▊   | 27/40 [05:27<02:41, 12.45s/it]
Task 3, Epoch 28/40 => Loss 0.357, Train_accy 70.58:  68%|██████▊   | 27/40 [05:37<02:41, 12.45s/it]
Task 3, Epoch 28/40 => Loss 0.357, Train_accy 70.58:  70%|███████   | 28/40 [05:37<02:20, 11.68s/it]
Task 3, Epoch 29/40 => Loss 0.331, Train_accy 70.61:  70%|███████   | 28/40 [05:47<02:20, 11.68s/it]
Task 3, Epoch 29/40 => Loss 0.331, Train_accy 70.61:  72%|███████▎  | 29/40 [05:47<02:02, 11.14s/it]
Task 3, Epoch 30/40 => Loss 0.360, Train_accy 70.54:  72%|███████▎  | 29/40 [05:57<02:02, 11.14s/it]
Task 3, Epoch 30/40 => Loss 0.360, Train_accy 70.54:  75%|███████▌  | 30/40 [05:57<01:47, 10.78s/it]
Task 3, Epoch 31/40 => Loss 0.347, Train_accy 70.99, Test_accy 74.72:  75%|███████▌  | 30/40 [06:17<01:47, 10.78s/it]
Task 3, Epoch 31/40 => Loss 0.347, Train_accy 70.99, Test_accy 74.72:  78%|███████▊  | 31/40 [06:17<02:00, 13.44s/it]
Task 3, Epoch 32/40 => Loss 0.363, Train_accy 69.23:  78%|███████▊  | 31/40 [06:27<02:00, 13.44s/it]                 
Task 3, Epoch 32/40 => Loss 0.363, Train_accy 69.23:  80%|████████  | 32/40 [06:27<01:39, 12.43s/it]
Task 3, Epoch 33/40 => Loss 0.344, Train_accy 69.12:  80%|████████  | 32/40 [06:37<01:39, 12.43s/it]
Task 3, Epoch 33/40 => Loss 0.344, Train_accy 69.12:  82%|████████▎ | 33/40 [06:37<01:21, 11.68s/it]
Task 3, Epoch 34/40 => Loss 0.352, Train_accy 69.68:  82%|████████▎ | 33/40 [06:46<01:21, 11.68s/it]
Task 3, Epoch 34/40 => Loss 0.352, Train_accy 69.68:  85%|████████▌ | 34/40 [06:46<01:06, 11.13s/it]
Task 3, Epoch 35/40 => Loss 0.370, Train_accy 69.57:  85%|████████▌ | 34/40 [06:56<01:06, 11.13s/it]
Task 3, Epoch 35/40 => Loss 0.370, Train_accy 69.57:  88%|████████▊ | 35/40 [06:56<00:53, 10.76s/it]
Task 3, Epoch 36/40 => Loss 0.362, Train_accy 69.45, Test_accy 74.61:  88%|████████▊ | 35/40 [07:16<00:53, 10.76s/it]
Task 3, Epoch 36/40 => Loss 0.362, Train_accy 69.45, Test_accy 74.61:  90%|█████████ | 36/40 [07:16<00:53, 13.45s/it]
Task 3, Epoch 37/40 => Loss 0.349, Train_accy 70.54:  90%|█████████ | 36/40 [07:26<00:53, 13.45s/it]                 
Task 3, Epoch 37/40 => Loss 0.349, Train_accy 70.54:  92%|█████████▎| 37/40 [07:26<00:37, 12.40s/it]
Task 3, Epoch 38/40 => Loss 0.329, Train_accy 70.73:  92%|█████████▎| 37/40 [07:36<00:37, 12.40s/it]
Task 3, Epoch 38/40 => Loss 0.329, Train_accy 70.73:  95%|█████████▌| 38/40 [07:36<00:23, 11.66s/it]
Task 3, Epoch 39/40 => Loss 0.350, Train_accy 70.69:  95%|█████████▌| 38/40 [07:46<00:23, 11.66s/it]
Task 3, Epoch 39/40 => Loss 0.350, Train_accy 70.69:  98%|█████████▊| 39/40 [07:46<00:11, 11.11s/it]
Task 3, Epoch 40/40 => Loss 0.337, Train_accy 70.80:  98%|█████████▊| 39/40 [07:56<00:11, 11.11s/it]
Task 3, Epoch 40/40 => Loss 0.337, Train_accy 70.80: 100%|██████████| 40/40 [07:56<00:00, 10.73s/it]
Task 3, Epoch 40/40 => Loss 0.337, Train_accy 70.80: 100%|██████████| 40/40 [07:56<00:00, 11.90s/it]
2025-11-08 00:50:19,533 [sdfourier.py] => Task 3, Epoch 40/40 => Loss 0.337, Train_accy 70.80
2025-11-08 00:50:28,587 [sdfourier.py] => Task 3, After merge adapters => Test_accy 73.96
2025-11-08 00:50:28,589 [trainer.py] => All params: 185886608
2025-11-08 00:50:28,590 [trainer.py] => Trainable params: 77360
2025-11-08 00:50:37,253 [trainer.py] => No NME accuracy.
2025-11-08 00:50:37,253 [trainer.py] => CNN: {'total': np.float64(73.96), '00-19': np.float64(75.2), '20-39': np.float64(75.29), '40-59': np.float64(77.74), '60-79': np.float64(67.77), 'old': np.float64(73.96), 'new': np.float64(nan)}
2025-11-08 00:50:37,253 [trainer.py] => CNN top1 curve: [np.float64(84.76), np.float64(79.21), np.float64(77.65), np.float64(73.96)]
2025-11-08 00:50:37,253 [trainer.py] => CNN top5 curve: [np.float64(95.79), np.float64(92.08), np.float64(91.12), np.float64(88.81)]

Average Accuracy (CNN): 78.895
2025-11-08 00:50:37,253 [trainer.py] => Average Accuracy (CNN): 78.895 

task 4
2025-11-08 00:50:37,256 [sdfourier.py] => Learning on 80-100

总共重置了 12 个模块的qkv层权重

  0%|          | 0/40 [00:00<?, ?it/s]
Task 4, Epoch 1/40 => Loss 2.447, Train_accy 5.84, Test_accy 69.67:   0%|          | 0/40 [00:17<?, ?it/s]
Task 4, Epoch 1/40 => Loss 2.447, Train_accy 5.84, Test_accy 69.67:   2%|▎         | 1/40 [00:17<11:19, 17.44s/it]
Task 4, Epoch 2/40 => Loss 0.908, Train_accy 43.40:   2%|▎         | 1/40 [00:23<11:19, 17.44s/it]                
Task 4, Epoch 2/40 => Loss 0.908, Train_accy 43.40:   5%|▌         | 2/40 [00:23<06:53, 10.87s/it]
Task 4, Epoch 3/40 => Loss 0.649, Train_accy 57.47:   5%|▌         | 2/40 [00:30<06:53, 10.87s/it]
Task 4, Epoch 3/40 => Loss 0.649, Train_accy 57.47:   8%|▊         | 3/40 [00:30<05:26,  8.81s/it]
Task 4, Epoch 4/40 => Loss 0.568, Train_accy 59.36:   8%|▊         | 3/40 [00:36<05:26,  8.81s/it]
Task 4, Epoch 4/40 => Loss 0.568, Train_accy 59.36:  10%|█         | 4/40 [00:36<04:41,  7.81s/it]
Task 4, Epoch 5/40 => Loss 0.515, Train_accy 63.44:  10%|█         | 4/40 [00:42<04:41,  7.81s/it]
Task 4, Epoch 5/40 => Loss 0.515, Train_accy 63.44:  12%|█▎        | 5/40 [00:42<04:14,  7.27s/it]
Task 4, Epoch 6/40 => Loss 0.501, Train_accy 62.75, Test_accy 72.84:  12%|█▎        | 5/40 [01:00<04:14,  7.27s/it]
Task 4, Epoch 6/40 => Loss 0.501, Train_accy 62.75, Test_accy 72.84:  15%|█▌        | 6/40 [01:00<06:04, 10.72s/it]
Task 4, Epoch 7/40 => Loss 0.450, Train_accy 64.70:  15%|█▌        | 6/40 [01:06<06:04, 10.72s/it]                 
Task 4, Epoch 7/40 => Loss 0.450, Train_accy 64.70:  18%|█▊        | 7/40 [01:06<05:08,  9.35s/it]
Task 4, Epoch 8/40 => Loss 0.457, Train_accy 65.64:  18%|█▊        | 7/40 [01:12<05:08,  9.35s/it]
Task 4, Epoch 8/40 => Loss 0.457, Train_accy 65.64:  20%|██        | 8/40 [01:12<04:27,  8.36s/it]
Task 4, Epoch 9/40 => Loss 0.477, Train_accy 66.71:  20%|██        | 8/40 [01:19<04:27,  8.36s/it]
Task 4, Epoch 9/40 => Loss 0.477, Train_accy 66.71:  22%|██▎       | 9/40 [01:19<03:58,  7.69s/it]
Task 4, Epoch 10/40 => Loss 0.425, Train_accy 65.58:  22%|██▎       | 9/40 [01:25<03:58,  7.69s/it]
Task 4, Epoch 10/40 => Loss 0.425, Train_accy 65.58:  25%|██▌       | 10/40 [01:25<03:37,  7.26s/it]
Task 4, Epoch 11/40 => Loss 0.394, Train_accy 68.84, Test_accy 73.01:  25%|██▌       | 10/40 [01:42<03:37,  7.26s/it]
Task 4, Epoch 11/40 => Loss 0.394, Train_accy 68.84, Test_accy 73.01:  28%|██▊       | 11/40 [01:42<05:00, 10.37s/it]
Task 4, Epoch 12/40 => Loss 0.378, Train_accy 66.21:  28%|██▊       | 11/40 [01:49<05:00, 10.37s/it]                 
Task 4, Epoch 12/40 => Loss 0.378, Train_accy 66.21:  30%|███       | 12/40 [01:49<04:17,  9.19s/it]
Task 4, Epoch 13/40 => Loss 0.381, Train_accy 68.97:  30%|███       | 12/40 [01:55<04:17,  9.19s/it]
Task 4, Epoch 13/40 => Loss 0.381, Train_accy 68.97:  32%|███▎      | 13/40 [01:55<03:44,  8.32s/it]
Task 4, Epoch 14/40 => Loss 0.362, Train_accy 69.41:  32%|███▎      | 13/40 [02:01<03:44,  8.32s/it]
Task 4, Epoch 14/40 => Loss 0.362, Train_accy 69.41:  35%|███▌      | 14/40 [02:01<03:19,  7.68s/it]
Task 4, Epoch 15/40 => Loss 0.327, Train_accy 69.03:  35%|███▌      | 14/40 [02:08<03:19,  7.68s/it]
Task 4, Epoch 15/40 => Loss 0.327, Train_accy 69.03:  38%|███▊      | 15/40 [02:08<03:01,  7.26s/it]
Task 4, Epoch 16/40 => Loss 0.346, Train_accy 71.36, Test_accy 72.94:  38%|███▊      | 15/40 [02:25<03:01,  7.26s/it]
Task 4, Epoch 16/40 => Loss 0.346, Train_accy 71.36, Test_accy 72.94:  40%|████      | 16/40 [02:25<04:07, 10.33s/it]
Task 4, Epoch 17/40 => Loss 0.343, Train_accy 71.98:  40%|████      | 16/40 [02:31<04:07, 10.33s/it]                 
Task 4, Epoch 17/40 => Loss 0.343, Train_accy 71.98:  42%|████▎     | 17/40 [02:31<03:29,  9.09s/it]
Task 4, Epoch 18/40 => Loss 0.340, Train_accy 71.80:  42%|████▎     | 17/40 [02:38<03:29,  9.09s/it]
Task 4, Epoch 18/40 => Loss 0.340, Train_accy 71.80:  45%|████▌     | 18/40 [02:38<03:01,  8.26s/it]
Task 4, Epoch 19/40 => Loss 0.331, Train_accy 71.36:  45%|████▌     | 18/40 [02:44<03:01,  8.26s/it]
Task 4, Epoch 19/40 => Loss 0.331, Train_accy 71.36:  48%|████▊     | 19/40 [02:44<02:41,  7.68s/it]
Task 4, Epoch 20/40 => Loss 0.352, Train_accy 72.42:  48%|████▊     | 19/40 [02:50<02:41,  7.68s/it]
Task 4, Epoch 20/40 => Loss 0.352, Train_accy 72.42:  50%|█████     | 20/40 [02:50<02:25,  7.30s/it]
Task 4, Epoch 21/40 => Loss 0.341, Train_accy 71.86, Test_accy 73.17:  50%|█████     | 20/40 [03:08<02:25,  7.30s/it]
Task 4, Epoch 21/40 => Loss 0.341, Train_accy 71.86, Test_accy 73.17:  52%|█████▎    | 21/40 [03:08<03:16, 10.32s/it]
Task 4, Epoch 22/40 => Loss 0.322, Train_accy 73.12:  52%|█████▎    | 21/40 [03:14<03:16, 10.32s/it]                 
Task 4, Epoch 22/40 => Loss 0.322, Train_accy 73.12:  55%|█████▌    | 22/40 [03:14<02:43,  9.07s/it]
Task 4, Epoch 23/40 => Loss 0.297, Train_accy 74.12:  55%|█████▌    | 22/40 [03:20<02:43,  9.07s/it]
Task 4, Epoch 23/40 => Loss 0.297, Train_accy 74.12:  57%|█████▊    | 23/40 [03:20<02:19,  8.24s/it]
Task 4, Epoch 24/40 => Loss 0.351, Train_accy 71.23:  57%|█████▊    | 23/40 [03:26<02:19,  8.24s/it]
Task 4, Epoch 24/40 => Loss 0.351, Train_accy 71.23:  60%|██████    | 24/40 [03:26<02:01,  7.62s/it]
Task 4, Epoch 25/40 => Loss 0.315, Train_accy 73.56:  60%|██████    | 24/40 [03:33<02:01,  7.62s/it]
Task 4, Epoch 25/40 => Loss 0.315, Train_accy 73.56:  62%|██████▎   | 25/40 [03:33<01:48,  7.23s/it]
Task 4, Epoch 26/40 => Loss 0.322, Train_accy 72.74, Test_accy 72.94:  62%|██████▎   | 25/40 [03:50<01:48,  7.23s/it]
Task 4, Epoch 26/40 => Loss 0.322, Train_accy 72.74, Test_accy 72.94:  65%|██████▌   | 26/40 [03:50<02:24, 10.30s/it]
Task 4, Epoch 27/40 => Loss 0.304, Train_accy 72.11:  65%|██████▌   | 26/40 [03:56<02:24, 10.30s/it]                 
Task 4, Epoch 27/40 => Loss 0.304, Train_accy 72.11:  68%|██████▊   | 27/40 [03:56<01:58,  9.11s/it]
Task 4, Epoch 28/40 => Loss 0.343, Train_accy 72.05:  68%|██████▊   | 27/40 [04:03<01:58,  9.11s/it]
Task 4, Epoch 28/40 => Loss 0.343, Train_accy 72.05:  70%|███████   | 28/40 [04:03<01:39,  8.26s/it]
Task 4, Epoch 29/40 => Loss 0.340, Train_accy 71.61:  70%|███████   | 28/40 [04:09<01:39,  8.26s/it]
Task 4, Epoch 29/40 => Loss 0.340, Train_accy 71.61:  72%|███████▎  | 29/40 [04:09<01:23,  7.63s/it]
Task 4, Epoch 30/40 => Loss 0.301, Train_accy 73.18:  72%|███████▎  | 29/40 [04:15<01:23,  7.63s/it]
Task 4, Epoch 30/40 => Loss 0.301, Train_accy 73.18:  75%|███████▌  | 30/40 [04:15<01:12,  7.22s/it]
Task 4, Epoch 31/40 => Loss 0.325, Train_accy 72.68, Test_accy 72.91:  75%|███████▌  | 30/40 [04:33<01:12,  7.22s/it]
Task 4, Epoch 31/40 => Loss 0.325, Train_accy 72.68, Test_accy 72.91:  78%|███████▊  | 31/40 [04:33<01:32, 10.29s/it]
Task 4, Epoch 32/40 => Loss 0.290, Train_accy 75.13:  78%|███████▊  | 31/40 [04:39<01:32, 10.29s/it]                 
Task 4, Epoch 32/40 => Loss 0.290, Train_accy 75.13:  80%|████████  | 32/40 [04:39<01:12,  9.08s/it]
Task 4, Epoch 33/40 => Loss 0.317, Train_accy 72.05:  80%|████████  | 32/40 [04:45<01:12,  9.08s/it]
Task 4, Epoch 33/40 => Loss 0.317, Train_accy 72.05:  82%|████████▎ | 33/40 [04:45<00:57,  8.20s/it]
Task 4, Epoch 34/40 => Loss 0.299, Train_accy 74.31:  82%|████████▎ | 33/40 [04:51<00:57,  8.20s/it]
Task 4, Epoch 34/40 => Loss 0.299, Train_accy 74.31:  85%|████████▌ | 34/40 [04:51<00:45,  7.59s/it]
Task 4, Epoch 35/40 => Loss 0.275, Train_accy 74.69:  85%|████████▌ | 34/40 [04:57<00:45,  7.59s/it]
Task 4, Epoch 35/40 => Loss 0.275, Train_accy 74.69:  88%|████████▊ | 35/40 [04:57<00:35,  7.18s/it]
Task 4, Epoch 36/40 => Loss 0.314, Train_accy 74.81, Test_accy 72.98:  88%|████████▊ | 35/40 [05:15<00:35,  7.18s/it]
Task 4, Epoch 36/40 => Loss 0.314, Train_accy 74.81, Test_accy 72.98:  90%|█████████ | 36/40 [05:15<00:40, 10.24s/it]
Task 4, Epoch 37/40 => Loss 0.275, Train_accy 75.13:  90%|█████████ | 36/40 [05:21<00:40, 10.24s/it]                 
Task 4, Epoch 37/40 => Loss 0.275, Train_accy 75.13:  92%|█████████▎| 37/40 [05:21<00:27,  9.06s/it]
Task 4, Epoch 38/40 => Loss 0.307, Train_accy 73.49:  92%|█████████▎| 37/40 [05:27<00:27,  9.06s/it]
Task 4, Epoch 38/40 => Loss 0.307, Train_accy 73.49:  95%|█████████▌| 38/40 [05:27<00:16,  8.20s/it]
Task 4, Epoch 39/40 => Loss 0.292, Train_accy 74.94:  95%|█████████▌| 38/40 [05:34<00:16,  8.20s/it]
Task 4, Epoch 39/40 => Loss 0.292, Train_accy 74.94:  98%|█████████▊| 39/40 [05:34<00:07,  7.62s/it]
Task 4, Epoch 40/40 => Loss 0.301, Train_accy 73.93:  98%|█████████▊| 39/40 [05:40<00:07,  7.62s/it]
Task 4, Epoch 40/40 => Loss 0.301, Train_accy 73.93: 100%|██████████| 40/40 [05:40<00:00,  7.19s/it]
Task 4, Epoch 40/40 => Loss 0.301, Train_accy 73.93: 100%|██████████| 40/40 [05:40<00:00,  8.50s/it]
2025-11-08 00:56:18,405 [sdfourier.py] => Task 4, Epoch 40/40 => Loss 0.301, Train_accy 73.93
2025-11-08 00:56:28,598 [sdfourier.py] => Task 4, After merge adapters => Test_accy 72.41
2025-11-08 00:56:28,600 [trainer.py] => All params: 185923588
2025-11-08 00:56:28,601 [trainer.py] => Trainable params: 92740
2025-11-08 00:56:38,410 [trainer.py] => No NME accuracy.
2025-11-08 00:56:38,410 [trainer.py] => CNN: {'total': np.float64(72.41), '00-19': np.float64(73.26), '20-39': np.float64(74.57), '40-59': np.float64(75.43), '60-79': np.float64(67.17), '80-99': np.float64(71.25), 'old': np.float64(72.41), 'new': np.float64(nan)}
2025-11-08 00:56:38,410 [trainer.py] => CNN top1 curve: [np.float64(84.76), np.float64(79.21), np.float64(77.65), np.float64(73.96), np.float64(72.41)]
2025-11-08 00:56:38,410 [trainer.py] => CNN top5 curve: [np.float64(95.79), np.float64(92.08), np.float64(91.12), np.float64(88.81), np.float64(87.38)]

Average Accuracy (CNN): 77.598
2025-11-08 00:56:38,411 [trainer.py] => Average Accuracy (CNN): 77.598 

task 5
2025-11-08 00:56:38,413 [sdfourier.py] => Learning on 100-120

总共重置了 12 个模块的qkv层权重

  0%|          | 0/40 [00:00<?, ?it/s]
Task 5, Epoch 1/40 => Loss 2.021, Train_accy 17.11, Test_accy 68.45:   0%|          | 0/40 [00:22<?, ?it/s]
Task 5, Epoch 1/40 => Loss 2.021, Train_accy 17.11, Test_accy 68.45:   2%|▎         | 1/40 [00:22<14:44, 22.68s/it]
Task 5, Epoch 2/40 => Loss 0.843, Train_accy 52.84:   2%|▎         | 1/40 [00:32<14:44, 22.68s/it]                 
Task 5, Epoch 2/40 => Loss 0.843, Train_accy 52.84:   5%|▌         | 2/40 [00:32<09:26, 14.91s/it]
Task 5, Epoch 3/40 => Loss 0.681, Train_accy 58.24:   5%|▌         | 2/40 [00:41<09:26, 14.91s/it]
Task 5, Epoch 3/40 => Loss 0.681, Train_accy 58.24:   8%|▊         | 3/40 [00:41<07:38, 12.40s/it]
Task 5, Epoch 4/40 => Loss 0.634, Train_accy 58.83:   8%|▊         | 3/40 [00:50<07:38, 12.40s/it]
Task 5, Epoch 4/40 => Loss 0.634, Train_accy 58.83:  10%|█         | 4/40 [00:50<06:43, 11.21s/it]
Task 5, Epoch 5/40 => Loss 0.545, Train_accy 62.50:  10%|█         | 4/40 [01:00<06:43, 11.21s/it]
Task 5, Epoch 5/40 => Loss 0.545, Train_accy 62.50:  12%|█▎        | 5/40 [01:00<06:08, 10.53s/it]
Task 5, Epoch 6/40 => Loss 0.546, Train_accy 62.18, Test_accy 70.96:  12%|█▎        | 5/40 [01:22<06:08, 10.53s/it]
Task 5, Epoch 6/40 => Loss 0.546, Train_accy 62.18, Test_accy 70.96:  15%|█▌        | 6/40 [01:22<08:18, 14.66s/it]
Task 5, Epoch 7/40 => Loss 0.486, Train_accy 62.62:  15%|█▌        | 6/40 [01:32<08:18, 14.66s/it]                 
Task 5, Epoch 7/40 => Loss 0.486, Train_accy 62.62:  18%|█▊        | 7/40 [01:32<07:07, 12.94s/it]
Task 5, Epoch 8/40 => Loss 0.491, Train_accy 63.56:  18%|█▊        | 7/40 [01:41<07:07, 12.94s/it]
Task 5, Epoch 8/40 => Loss 0.491, Train_accy 63.56:  20%|██        | 8/40 [01:41<06:17, 11.79s/it]
Task 5, Epoch 9/40 => Loss 0.488, Train_accy 64.67:  20%|██        | 8/40 [01:51<06:17, 11.79s/it]
Task 5, Epoch 9/40 => Loss 0.488, Train_accy 64.67:  22%|██▎       | 9/40 [01:51<05:42, 11.04s/it]
Task 5, Epoch 10/40 => Loss 0.497, Train_accy 63.84:  22%|██▎       | 9/40 [02:00<05:42, 11.04s/it]
Task 5, Epoch 10/40 => Loss 0.497, Train_accy 63.84:  25%|██▌       | 10/40 [02:00<05:17, 10.57s/it]
Task 5, Epoch 11/40 => Loss 0.453, Train_accy 66.72, Test_accy 71.15:  25%|██▌       | 10/40 [02:23<05:17, 10.57s/it]
Task 5, Epoch 11/40 => Loss 0.453, Train_accy 66.72, Test_accy 71.15:  28%|██▊       | 11/40 [02:23<06:53, 14.25s/it]
Task 5, Epoch 12/40 => Loss 0.443, Train_accy 66.88:  28%|██▊       | 11/40 [02:32<06:53, 14.25s/it]                 
Task 5, Epoch 12/40 => Loss 0.443, Train_accy 66.88:  30%|███       | 12/40 [02:32<05:58, 12.80s/it]
Task 5, Epoch 13/40 => Loss 0.411, Train_accy 66.76:  30%|███       | 12/40 [02:42<05:58, 12.80s/it]
Task 5, Epoch 13/40 => Loss 0.411, Train_accy 66.76:  32%|███▎      | 13/40 [02:42<05:18, 11.81s/it]
Task 5, Epoch 14/40 => Loss 0.437, Train_accy 66.72:  32%|███▎      | 13/40 [02:51<05:18, 11.81s/it]
Task 5, Epoch 14/40 => Loss 0.437, Train_accy 66.72:  35%|███▌      | 14/40 [02:51<04:48, 11.09s/it]
Task 5, Epoch 15/40 => Loss 0.399, Train_accy 68.38:  35%|███▌      | 14/40 [03:00<04:48, 11.09s/it]
Task 5, Epoch 15/40 => Loss 0.399, Train_accy 68.38:  38%|███▊      | 15/40 [03:00<04:24, 10.56s/it]
Task 5, Epoch 16/40 => Loss 0.383, Train_accy 69.60, Test_accy 71.56:  38%|███▊      | 15/40 [03:23<04:24, 10.56s/it]
Task 5, Epoch 16/40 => Loss 0.383, Train_accy 69.60, Test_accy 71.56:  40%|████      | 16/40 [03:23<05:42, 14.28s/it]
Task 5, Epoch 17/40 => Loss 0.383, Train_accy 68.73:  40%|████      | 16/40 [03:33<05:42, 14.28s/it]                 
Task 5, Epoch 17/40 => Loss 0.383, Train_accy 68.73:  42%|████▎     | 17/40 [03:33<04:54, 12.81s/it]
Task 5, Epoch 18/40 => Loss 0.391, Train_accy 69.32:  42%|████▎     | 17/40 [03:42<04:54, 12.81s/it]
Task 5, Epoch 18/40 => Loss 0.391, Train_accy 69.32:  45%|████▌     | 18/40 [03:42<04:19, 11.80s/it]
Task 5, Epoch 19/40 => Loss 0.392, Train_accy 69.40:  45%|████▌     | 18/40 [03:52<04:19, 11.80s/it]
Task 5, Epoch 19/40 => Loss 0.392, Train_accy 69.40:  48%|████▊     | 19/40 [03:52<03:52, 11.07s/it]
Task 5, Epoch 20/40 => Loss 0.384, Train_accy 70.07:  48%|████▊     | 19/40 [04:01<03:52, 11.07s/it]
Task 5, Epoch 20/40 => Loss 0.384, Train_accy 70.07:  50%|█████     | 20/40 [04:01<03:31, 10.57s/it]
Task 5, Epoch 21/40 => Loss 0.379, Train_accy 70.35, Test_accy 71.26:  50%|█████     | 20/40 [04:24<03:31, 10.57s/it]
Task 5, Epoch 21/40 => Loss 0.379, Train_accy 70.35, Test_accy 71.26:  52%|█████▎    | 21/40 [04:24<04:29, 14.19s/it]
Task 5, Epoch 22/40 => Loss 0.347, Train_accy 71.61:  52%|█████▎    | 21/40 [04:33<04:29, 14.19s/it]                 
Task 5, Epoch 22/40 => Loss 0.347, Train_accy 71.61:  55%|█████▌    | 22/40 [04:33<03:49, 12.75s/it]
Task 5, Epoch 23/40 => Loss 0.372, Train_accy 71.14:  55%|█████▌    | 22/40 [04:42<03:49, 12.75s/it]
Task 5, Epoch 23/40 => Loss 0.372, Train_accy 71.14:  57%|█████▊    | 23/40 [04:42<03:19, 11.73s/it]
Task 5, Epoch 24/40 => Loss 0.330, Train_accy 71.37:  57%|█████▊    | 23/40 [04:52<03:19, 11.73s/it]
Task 5, Epoch 24/40 => Loss 0.330, Train_accy 71.37:  60%|██████    | 24/40 [04:52<02:56, 11.04s/it]
Task 5, Epoch 25/40 => Loss 0.351, Train_accy 71.77:  60%|██████    | 24/40 [05:01<02:56, 11.04s/it]
Task 5, Epoch 25/40 => Loss 0.351, Train_accy 71.77:  62%|██████▎   | 25/40 [05:01<02:38, 10.60s/it]
Task 5, Epoch 26/40 => Loss 0.359, Train_accy 71.10, Test_accy 71.28:  62%|██████▎   | 25/40 [05:24<02:38, 10.60s/it]
Task 5, Epoch 26/40 => Loss 0.359, Train_accy 71.10, Test_accy 71.28:  65%|██████▌   | 26/40 [05:24<03:19, 14.22s/it]
Task 5, Epoch 27/40 => Loss 0.350, Train_accy 72.40:  65%|██████▌   | 26/40 [05:33<03:19, 14.22s/it]                 
Task 5, Epoch 27/40 => Loss 0.350, Train_accy 72.40:  68%|██████▊   | 27/40 [05:33<02:46, 12.78s/it]
Task 5, Epoch 28/40 => Loss 0.366, Train_accy 71.65:  68%|██████▊   | 27/40 [05:43<02:46, 12.78s/it]
Task 5, Epoch 28/40 => Loss 0.366, Train_accy 71.65:  70%|███████   | 28/40 [05:43<02:21, 11.77s/it]
Task 5, Epoch 29/40 => Loss 0.371, Train_accy 70.94:  70%|███████   | 28/40 [05:52<02:21, 11.77s/it]
Task 5, Epoch 29/40 => Loss 0.371, Train_accy 70.94:  72%|███████▎  | 29/40 [05:52<02:01, 11.06s/it]
Task 5, Epoch 30/40 => Loss 0.345, Train_accy 72.24:  72%|███████▎  | 29/40 [06:02<02:01, 11.06s/it]
Task 5, Epoch 30/40 => Loss 0.345, Train_accy 72.24:  75%|███████▌  | 30/40 [06:02<01:45, 10.58s/it]
Task 5, Epoch 31/40 => Loss 0.385, Train_accy 71.18, Test_accy 71.42:  75%|███████▌  | 30/40 [06:24<01:45, 10.58s/it]
Task 5, Epoch 31/40 => Loss 0.385, Train_accy 71.18, Test_accy 71.42:  78%|███████▊  | 31/40 [06:24<02:07, 14.20s/it]
Task 5, Epoch 32/40 => Loss 0.345, Train_accy 72.32:  78%|███████▊  | 31/40 [06:34<02:07, 14.20s/it]                 
Task 5, Epoch 32/40 => Loss 0.345, Train_accy 72.32:  80%|████████  | 32/40 [06:34<01:41, 12.73s/it]
Task 5, Epoch 33/40 => Loss 0.375, Train_accy 70.98:  80%|████████  | 32/40 [06:43<01:41, 12.73s/it]
Task 5, Epoch 33/40 => Loss 0.375, Train_accy 70.98:  82%|████████▎ | 33/40 [06:43<01:22, 11.77s/it]
Task 5, Epoch 34/40 => Loss 0.343, Train_accy 72.36:  82%|████████▎ | 33/40 [06:53<01:22, 11.77s/it]
Task 5, Epoch 34/40 => Loss 0.343, Train_accy 72.36:  85%|████████▌ | 34/40 [06:53<01:06, 11.04s/it]
Task 5, Epoch 35/40 => Loss 0.325, Train_accy 72.56:  85%|████████▌ | 34/40 [07:02<01:06, 11.04s/it]
Task 5, Epoch 35/40 => Loss 0.325, Train_accy 72.56:  88%|████████▊ | 35/40 [07:02<00:52, 10.55s/it]
Task 5, Epoch 36/40 => Loss 0.348, Train_accy 71.85, Test_accy 71.50:  88%|████████▊ | 35/40 [07:25<00:52, 10.55s/it]
Task 5, Epoch 36/40 => Loss 0.348, Train_accy 71.85, Test_accy 71.50:  90%|█████████ | 36/40 [07:25<00:56, 14.20s/it]
Task 5, Epoch 37/40 => Loss 0.336, Train_accy 71.41:  90%|█████████ | 36/40 [07:34<00:56, 14.20s/it]                 
Task 5, Epoch 37/40 => Loss 0.336, Train_accy 71.41:  92%|█████████▎| 37/40 [07:34<00:38, 12.77s/it]
Task 5, Epoch 38/40 => Loss 0.381, Train_accy 69.99:  92%|█████████▎| 37/40 [07:44<00:38, 12.77s/it]
Task 5, Epoch 38/40 => Loss 0.381, Train_accy 69.99:  95%|█████████▌| 38/40 [07:44<00:23, 11.77s/it]
Task 5, Epoch 39/40 => Loss 0.364, Train_accy 70.35:  95%|█████████▌| 38/40 [07:53<00:23, 11.77s/it]
Task 5, Epoch 39/40 => Loss 0.364, Train_accy 70.35:  98%|█████████▊| 39/40 [07:53<00:11, 11.04s/it]
Task 5, Epoch 40/40 => Loss 0.364, Train_accy 71.37:  98%|█████████▊| 39/40 [08:02<00:11, 11.04s/it]
Task 5, Epoch 40/40 => Loss 0.364, Train_accy 71.37: 100%|██████████| 40/40 [08:02<00:00, 10.51s/it]
Task 5, Epoch 40/40 => Loss 0.364, Train_accy 71.37: 100%|██████████| 40/40 [08:02<00:00, 12.07s/it]
2025-11-08 01:04:42,167 [sdfourier.py] => Task 5, Epoch 40/40 => Loss 0.364, Train_accy 71.37
2025-11-08 01:04:54,355 [sdfourier.py] => Task 5, After merge adapters => Test_accy 70.06
2025-11-08 01:04:54,357 [trainer.py] => All params: 185962008
2025-11-08 01:04:54,358 [trainer.py] => Trainable params: 108120
2025-11-08 01:05:06,133 [trainer.py] => No NME accuracy.
2025-11-08 01:05:06,133 [trainer.py] => CNN: {'total': np.float64(70.06), '00-19': np.float64(71.31), '20-39': np.float64(71.98), '40-59': np.float64(72.95), '60-79': np.float64(65.22), '80-99': np.float64(70.5), '100-119': np.float64(68.59), 'old': np.float64(70.06), 'new': np.float64(nan)}
2025-11-08 01:05:06,133 [trainer.py] => CNN top1 curve: [np.float64(84.76), np.float64(79.21), np.float64(77.65), np.float64(73.96), np.float64(72.41), np.float64(70.06)]
2025-11-08 01:05:06,133 [trainer.py] => CNN top5 curve: [np.float64(95.79), np.float64(92.08), np.float64(91.12), np.float64(88.81), np.float64(87.38), np.float64(85.74)]

Average Accuracy (CNN): 76.34166666666667
2025-11-08 01:05:06,133 [trainer.py] => Average Accuracy (CNN): 76.34166666666667 

task 6
2025-11-08 01:05:06,136 [sdfourier.py] => Learning on 120-140

总共重置了 12 个模块的qkv层权重

  0%|          | 0/40 [00:00<?, ?it/s]
Task 6, Epoch 1/40 => Loss 2.318, Train_accy 8.89, Test_accy 66.31:   0%|          | 0/40 [00:23<?, ?it/s]
Task 6, Epoch 1/40 => Loss 2.318, Train_accy 8.89, Test_accy 66.31:   2%|▎         | 1/40 [00:23<15:04, 23.20s/it]
Task 6, Epoch 2/40 => Loss 0.976, Train_accy 39.71:   2%|▎         | 1/40 [00:31<15:04, 23.20s/it]                
Task 6, Epoch 2/40 => Loss 0.976, Train_accy 39.71:   5%|▌         | 2/40 [00:31<09:04, 14.32s/it]
Task 6, Epoch 3/40 => Loss 0.801, Train_accy 48.23:   5%|▌         | 2/40 [00:39<09:04, 14.32s/it]
Task 6, Epoch 3/40 => Loss 0.801, Train_accy 48.23:   8%|▊         | 3/40 [00:39<07:04, 11.48s/it]
Task 6, Epoch 4/40 => Loss 0.697, Train_accy 50.09:   8%|▊         | 3/40 [00:47<07:04, 11.48s/it]
Task 6, Epoch 4/40 => Loss 0.697, Train_accy 50.09:  10%|█         | 4/40 [00:47<06:05, 10.14s/it]
Task 6, Epoch 5/40 => Loss 0.681, Train_accy 49.39:  10%|█         | 4/40 [00:55<06:05, 10.14s/it]
Task 6, Epoch 5/40 => Loss 0.681, Train_accy 49.39:  12%|█▎        | 5/40 [00:55<05:28,  9.39s/it]
Task 6, Epoch 6/40 => Loss 0.617, Train_accy 51.02, Test_accy 68.75:  12%|█▎        | 5/40 [01:18<05:28,  9.39s/it]
Task 6, Epoch 6/40 => Loss 0.617, Train_accy 51.02, Test_accy 68.75:  15%|█▌        | 6/40 [01:18<08:00, 14.13s/it]
Task 6, Epoch 7/40 => Loss 0.561, Train_accy 53.03:  15%|█▌        | 6/40 [01:26<08:00, 14.13s/it]                 
Task 6, Epoch 7/40 => Loss 0.561, Train_accy 53.03:  18%|█▊        | 7/40 [01:26<06:40, 12.14s/it]
Task 6, Epoch 8/40 => Loss 0.559, Train_accy 54.05:  18%|█▊        | 7/40 [01:35<06:40, 12.14s/it]
Task 6, Epoch 8/40 => Loss 0.559, Train_accy 54.05:  20%|██        | 8/40 [01:35<05:47, 10.86s/it]
Task 6, Epoch 9/40 => Loss 0.518, Train_accy 55.54:  20%|██        | 8/40 [01:43<05:47, 10.86s/it]
Task 6, Epoch 9/40 => Loss 0.518, Train_accy 55.54:  22%|██▎       | 9/40 [01:43<05:10, 10.02s/it]
Task 6, Epoch 10/40 => Loss 0.517, Train_accy 56.15:  22%|██▎       | 9/40 [01:51<05:10, 10.02s/it]
Task 6, Epoch 10/40 => Loss 0.517, Train_accy 56.15:  25%|██▌       | 10/40 [01:51<04:42,  9.43s/it]
Task 6, Epoch 11/40 => Loss 0.514, Train_accy 54.52, Test_accy 69.20:  25%|██▌       | 10/40 [02:14<04:42,  9.43s/it]
Task 6, Epoch 11/40 => Loss 0.514, Train_accy 54.52, Test_accy 69.20:  28%|██▊       | 11/40 [02:14<06:33, 13.59s/it]
Task 6, Epoch 12/40 => Loss 0.490, Train_accy 55.12:  28%|██▊       | 11/40 [02:22<06:33, 13.59s/it]                 
Task 6, Epoch 12/40 => Loss 0.490, Train_accy 55.12:  30%|███       | 12/40 [02:22<05:33, 11.93s/it]
Task 6, Epoch 13/40 => Loss 0.477, Train_accy 58.80:  30%|███       | 12/40 [02:30<05:33, 11.93s/it]
Task 6, Epoch 13/40 => Loss 0.477, Train_accy 58.80:  32%|███▎      | 13/40 [02:30<04:50, 10.77s/it]
Task 6, Epoch 14/40 => Loss 0.460, Train_accy 57.31:  32%|███▎      | 13/40 [02:38<04:50, 10.77s/it]
Task 6, Epoch 14/40 => Loss 0.460, Train_accy 57.31:  35%|███▌      | 14/40 [02:38<04:19,  9.99s/it]
Task 6, Epoch 15/40 => Loss 0.447, Train_accy 59.40:  35%|███▌      | 14/40 [02:46<04:19,  9.99s/it]
Task 6, Epoch 15/40 => Loss 0.447, Train_accy 59.40:  38%|███▊      | 15/40 [02:46<03:55,  9.41s/it]
Task 6, Epoch 16/40 => Loss 0.442, Train_accy 59.40, Test_accy 69.08:  38%|███▊      | 15/40 [03:10<03:55,  9.41s/it]
Task 6, Epoch 16/40 => Loss 0.442, Train_accy 59.40, Test_accy 69.08:  40%|████      | 16/40 [03:10<05:25, 13.58s/it]
Task 6, Epoch 17/40 => Loss 0.421, Train_accy 61.50:  40%|████      | 16/40 [03:18<05:25, 13.58s/it]                 
Task 6, Epoch 17/40 => Loss 0.421, Train_accy 61.50:  42%|████▎     | 17/40 [03:18<04:34, 11.92s/it]
Task 6, Epoch 18/40 => Loss 0.414, Train_accy 60.29:  42%|████▎     | 17/40 [03:26<04:34, 11.92s/it]
Task 6, Epoch 18/40 => Loss 0.414, Train_accy 60.29:  45%|████▌     | 18/40 [03:26<03:56, 10.77s/it]
Task 6, Epoch 19/40 => Loss 0.463, Train_accy 59.96:  45%|████▌     | 18/40 [03:34<03:56, 10.77s/it]
Task 6, Epoch 19/40 => Loss 0.463, Train_accy 59.96:  48%|████▊     | 19/40 [03:34<03:29,  9.96s/it]
Task 6, Epoch 20/40 => Loss 0.438, Train_accy 60.80:  48%|████▊     | 19/40 [03:42<03:29,  9.96s/it]
Task 6, Epoch 20/40 => Loss 0.438, Train_accy 60.80:  50%|█████     | 20/40 [03:42<03:08,  9.43s/it]
Task 6, Epoch 21/40 => Loss 0.392, Train_accy 60.89, Test_accy 69.27:  50%|█████     | 20/40 [04:05<03:08,  9.43s/it]
Task 6, Epoch 21/40 => Loss 0.392, Train_accy 60.89, Test_accy 69.27:  52%|█████▎    | 21/40 [04:05<04:17, 13.57s/it]
Task 6, Epoch 22/40 => Loss 0.452, Train_accy 59.87:  52%|█████▎    | 21/40 [04:13<04:17, 13.57s/it]                 
Task 6, Epoch 22/40 => Loss 0.452, Train_accy 59.87:  55%|█████▌    | 22/40 [04:13<03:34, 11.94s/it]
Task 6, Epoch 23/40 => Loss 0.423, Train_accy 61.17:  55%|█████▌    | 22/40 [04:21<03:34, 11.94s/it]
Task 6, Epoch 23/40 => Loss 0.423, Train_accy 61.17:  57%|█████▊    | 23/40 [04:21<03:02, 10.76s/it]
Task 6, Epoch 24/40 => Loss 0.409, Train_accy 61.27:  57%|█████▊    | 23/40 [04:29<03:02, 10.76s/it]
Task 6, Epoch 24/40 => Loss 0.409, Train_accy 61.27:  60%|██████    | 24/40 [04:29<02:39,  9.95s/it]
Task 6, Epoch 25/40 => Loss 0.393, Train_accy 61.69:  60%|██████    | 24/40 [04:38<02:39,  9.95s/it]
Task 6, Epoch 25/40 => Loss 0.393, Train_accy 61.69:  62%|██████▎   | 25/40 [04:38<02:20,  9.40s/it]
Task 6, Epoch 26/40 => Loss 0.364, Train_accy 62.62, Test_accy 69.34:  62%|██████▎   | 25/40 [05:01<02:20,  9.40s/it]
Task 6, Epoch 26/40 => Loss 0.364, Train_accy 62.62, Test_accy 69.34:  65%|██████▌   | 26/40 [05:01<03:09, 13.54s/it]
Task 6, Epoch 27/40 => Loss 0.404, Train_accy 60.99:  65%|██████▌   | 26/40 [05:09<03:09, 13.54s/it]                 
Task 6, Epoch 27/40 => Loss 0.404, Train_accy 60.99:  68%|██████▊   | 27/40 [05:09<02:34, 11.90s/it]
Task 6, Epoch 28/40 => Loss 0.400, Train_accy 61.36:  68%|██████▊   | 27/40 [05:17<02:34, 11.90s/it]
Task 6, Epoch 28/40 => Loss 0.400, Train_accy 61.36:  70%|███████   | 28/40 [05:17<02:09, 10.75s/it]
Task 6, Epoch 29/40 => Loss 0.394, Train_accy 61.69:  70%|███████   | 28/40 [05:25<02:09, 10.75s/it]
Task 6, Epoch 29/40 => Loss 0.394, Train_accy 61.69:  72%|███████▎  | 29/40 [05:25<01:49,  9.96s/it]
Task 6, Epoch 30/40 => Loss 0.405, Train_accy 61.73:  72%|███████▎  | 29/40 [05:33<01:49,  9.96s/it]
Task 6, Epoch 30/40 => Loss 0.405, Train_accy 61.73:  75%|███████▌  | 30/40 [05:33<01:34,  9.41s/it]
Task 6, Epoch 31/40 => Loss 0.390, Train_accy 62.06, Test_accy 69.30:  75%|███████▌  | 30/40 [05:56<01:34,  9.41s/it]
Task 6, Epoch 31/40 => Loss 0.390, Train_accy 62.06, Test_accy 69.30:  78%|███████▊  | 31/40 [05:56<02:01, 13.51s/it]
Task 6, Epoch 32/40 => Loss 0.360, Train_accy 62.66:  78%|███████▊  | 31/40 [06:04<02:01, 13.51s/it]                 
Task 6, Epoch 32/40 => Loss 0.360, Train_accy 62.66:  80%|████████  | 32/40 [06:04<01:35, 11.89s/it]
Task 6, Epoch 33/40 => Loss 0.388, Train_accy 61.69:  80%|████████  | 32/40 [06:12<01:35, 11.89s/it]
Task 6, Epoch 33/40 => Loss 0.388, Train_accy 61.69:  82%|████████▎ | 33/40 [06:12<01:15, 10.75s/it]
Task 6, Epoch 34/40 => Loss 0.365, Train_accy 63.41:  82%|████████▎ | 33/40 [06:20<01:15, 10.75s/it]
Task 6, Epoch 34/40 => Loss 0.365, Train_accy 63.41:  85%|████████▌ | 34/40 [06:20<00:59,  9.95s/it]
Task 6, Epoch 35/40 => Loss 0.377, Train_accy 62.94:  85%|████████▌ | 34/40 [06:29<00:59,  9.95s/it]
Task 6, Epoch 35/40 => Loss 0.377, Train_accy 62.94:  88%|████████▊ | 35/40 [06:29<00:47,  9.41s/it]
Task 6, Epoch 36/40 => Loss 0.403, Train_accy 62.71, Test_accy 69.23:  88%|████████▊ | 35/40 [06:52<00:47,  9.41s/it]
Task 6, Epoch 36/40 => Loss 0.403, Train_accy 62.71, Test_accy 69.23:  90%|█████████ | 36/40 [06:52<00:54, 13.58s/it]
Task 6, Epoch 37/40 => Loss 0.374, Train_accy 63.78:  90%|█████████ | 36/40 [07:00<00:54, 13.58s/it]                 
Task 6, Epoch 37/40 => Loss 0.374, Train_accy 63.78:  92%|█████████▎| 37/40 [07:00<00:35, 11.94s/it]
Task 6, Epoch 38/40 => Loss 0.348, Train_accy 65.04:  92%|█████████▎| 37/40 [07:08<00:35, 11.94s/it]
Task 6, Epoch 38/40 => Loss 0.348, Train_accy 65.04:  95%|█████████▌| 38/40 [07:08<00:21, 10.78s/it]
Task 6, Epoch 39/40 => Loss 0.409, Train_accy 62.71:  95%|█████████▌| 38/40 [07:16<00:21, 10.78s/it]
Task 6, Epoch 39/40 => Loss 0.409, Train_accy 62.71:  98%|█████████▊| 39/40 [07:16<00:09,  9.97s/it]
Task 6, Epoch 40/40 => Loss 0.391, Train_accy 62.24:  98%|█████████▊| 39/40 [07:24<00:09,  9.97s/it]
Task 6, Epoch 40/40 => Loss 0.391, Train_accy 62.24: 100%|██████████| 40/40 [07:24<00:00,  9.43s/it]
Task 6, Epoch 40/40 => Loss 0.391, Train_accy 62.24: 100%|██████████| 40/40 [07:24<00:00, 11.12s/it]
2025-11-08 01:12:32,353 [sdfourier.py] => Task 6, Epoch 40/40 => Loss 0.391, Train_accy 62.24
2025-11-08 01:12:46,169 [sdfourier.py] => Task 6, After merge adapters => Test_accy 67.26
2025-11-08 01:12:46,170 [trainer.py] => All params: 186001868
2025-11-08 01:12:46,171 [trainer.py] => Trainable params: 123500
2025-11-08 01:12:59,445 [trainer.py] => No NME accuracy.
2025-11-08 01:12:59,445 [trainer.py] => CNN: {'total': np.float64(67.26), '00-19': np.float64(70.02), '20-39': np.float64(69.68), '40-59': np.float64(70.94), '60-79': np.float64(63.12), '80-99': np.float64(69.5), '100-119': np.float64(67.03), '120-139': np.float64(60.0), 'old': np.float64(67.26), 'new': np.float64(nan)}
2025-11-08 01:12:59,445 [trainer.py] => CNN top1 curve: [np.float64(84.76), np.float64(79.21), np.float64(77.65), np.float64(73.96), np.float64(72.41), np.float64(70.06), np.float64(67.26)]
2025-11-08 01:12:59,445 [trainer.py] => CNN top5 curve: [np.float64(95.79), np.float64(92.08), np.float64(91.12), np.float64(88.81), np.float64(87.38), np.float64(85.74), np.float64(84.36)]

Average Accuracy (CNN): 75.04428571428572
2025-11-08 01:12:59,445 [trainer.py] => Average Accuracy (CNN): 75.04428571428572 

task 7
2025-11-08 01:12:59,449 [sdfourier.py] => Learning on 140-160

总共重置了 12 个模块的qkv层权重

  0%|          | 0/40 [00:00<?, ?it/s]
Task 7, Epoch 1/40 => Loss 2.125, Train_accy 12.30, Test_accy 66.93:   0%|          | 0/40 [00:25<?, ?it/s]
Task 7, Epoch 1/40 => Loss 2.125, Train_accy 12.30, Test_accy 66.93:   2%|▎         | 1/40 [00:25<16:18, 25.08s/it]
Task 7, Epoch 2/40 => Loss 0.769, Train_accy 52.38:   2%|▎         | 1/40 [00:33<16:18, 25.08s/it]                 
Task 7, Epoch 2/40 => Loss 0.769, Train_accy 52.38:   5%|▌         | 2/40 [00:33<09:33, 15.08s/it]
Task 7, Epoch 3/40 => Loss 0.583, Train_accy 61.42:   5%|▌         | 2/40 [00:41<09:33, 15.08s/it]
Task 7, Epoch 3/40 => Loss 0.583, Train_accy 61.42:   8%|▊         | 3/40 [00:41<07:21, 11.92s/it]
Task 7, Epoch 4/40 => Loss 0.519, Train_accy 63.56:   8%|▊         | 3/40 [00:49<07:21, 11.92s/it]
Task 7, Epoch 4/40 => Loss 0.519, Train_accy 63.56:  10%|█         | 4/40 [00:49<06:14, 10.40s/it]
Task 7, Epoch 5/40 => Loss 0.501, Train_accy 64.12:  10%|█         | 4/40 [00:57<06:14, 10.40s/it]
Task 7, Epoch 5/40 => Loss 0.501, Train_accy 64.12:  12%|█▎        | 5/40 [00:57<05:34,  9.55s/it]
Task 7, Epoch 6/40 => Loss 0.465, Train_accy 65.56, Test_accy 68.95:  12%|█▎        | 5/40 [01:22<05:34,  9.55s/it]
Task 7, Epoch 6/40 => Loss 0.465, Train_accy 65.56, Test_accy 68.95:  15%|█▌        | 6/40 [01:22<08:23, 14.81s/it]
Task 7, Epoch 7/40 => Loss 0.439, Train_accy 66.78:  15%|█▌        | 6/40 [01:30<08:23, 14.81s/it]                 
Task 7, Epoch 7/40 => Loss 0.439, Train_accy 66.78:  18%|█▊        | 7/40 [01:30<06:55, 12.60s/it]
Task 7, Epoch 8/40 => Loss 0.428, Train_accy 66.31:  18%|█▊        | 7/40 [01:38<06:55, 12.60s/it]
Task 7, Epoch 8/40 => Loss 0.428, Train_accy 66.31:  20%|██        | 8/40 [01:38<06:00, 11.28s/it]
Task 7, Epoch 9/40 => Loss 0.383, Train_accy 67.94:  20%|██        | 8/40 [01:47<06:00, 11.28s/it]
Task 7, Epoch 9/40 => Loss 0.383, Train_accy 67.94:  22%|██▎       | 9/40 [01:47<05:19, 10.30s/it]
Task 7, Epoch 10/40 => Loss 0.400, Train_accy 68.45:  22%|██▎       | 9/40 [01:55<05:19, 10.30s/it]
Task 7, Epoch 10/40 => Loss 0.400, Train_accy 68.45:  25%|██▌       | 10/40 [01:55<04:51,  9.71s/it]
Task 7, Epoch 11/40 => Loss 0.381, Train_accy 69.62, Test_accy 68.99:  25%|██▌       | 10/40 [02:20<04:51,  9.71s/it]
Task 7, Epoch 11/40 => Loss 0.381, Train_accy 69.62, Test_accy 68.99:  28%|██▊       | 11/40 [02:20<06:57, 14.41s/it]
Task 7, Epoch 12/40 => Loss 0.387, Train_accy 68.97:  28%|██▊       | 11/40 [02:28<06:57, 14.41s/it]                 
Task 7, Epoch 12/40 => Loss 0.387, Train_accy 68.97:  30%|███       | 12/40 [02:28<05:50, 12.50s/it]
Task 7, Epoch 13/40 => Loss 0.344, Train_accy 70.83:  30%|███       | 12/40 [02:36<05:50, 12.50s/it]
Task 7, Epoch 13/40 => Loss 0.344, Train_accy 70.83:  32%|███▎      | 13/40 [02:36<05:01, 11.16s/it]
Task 7, Epoch 14/40 => Loss 0.351, Train_accy 70.60:  32%|███▎      | 13/40 [02:44<05:01, 11.16s/it]
Task 7, Epoch 14/40 => Loss 0.351, Train_accy 70.60:  35%|███▌      | 14/40 [02:44<04:26, 10.25s/it]
Task 7, Epoch 15/40 => Loss 0.360, Train_accy 69.34:  35%|███▌      | 14/40 [02:53<04:26, 10.25s/it]
Task 7, Epoch 15/40 => Loss 0.360, Train_accy 69.34:  38%|███▊      | 15/40 [02:53<04:01,  9.66s/it]
Task 7, Epoch 16/40 => Loss 0.323, Train_accy 71.95, Test_accy 68.93:  38%|███▊      | 15/40 [03:18<04:01,  9.66s/it]
Task 7, Epoch 16/40 => Loss 0.323, Train_accy 71.95, Test_accy 68.93:  40%|████      | 16/40 [03:18<05:43, 14.32s/it]
Task 7, Epoch 17/40 => Loss 0.329, Train_accy 72.04:  40%|████      | 16/40 [03:26<05:43, 14.32s/it]                 
Task 7, Epoch 17/40 => Loss 0.329, Train_accy 72.04:  42%|████▎     | 17/40 [03:26<04:45, 12.41s/it]
Task 7, Epoch 18/40 => Loss 0.337, Train_accy 71.11:  42%|████▎     | 17/40 [03:34<04:45, 12.41s/it]
Task 7, Epoch 18/40 => Loss 0.337, Train_accy 71.11:  45%|████▌     | 18/40 [03:34<04:04, 11.11s/it]
Task 7, Epoch 19/40 => Loss 0.366, Train_accy 70.97:  45%|████▌     | 18/40 [03:42<04:04, 11.11s/it]
Task 7, Epoch 19/40 => Loss 0.366, Train_accy 70.97:  48%|████▊     | 19/40 [03:42<03:34, 10.22s/it]
Task 7, Epoch 20/40 => Loss 0.326, Train_accy 73.16:  48%|████▊     | 19/40 [03:50<03:34, 10.22s/it]
Task 7, Epoch 20/40 => Loss 0.326, Train_accy 73.16:  50%|█████     | 20/40 [03:50<03:11,  9.60s/it]
Task 7, Epoch 21/40 => Loss 0.287, Train_accy 73.49, Test_accy 69.08:  50%|█████     | 20/40 [04:15<03:11,  9.60s/it]
Task 7, Epoch 21/40 => Loss 0.287, Train_accy 73.49, Test_accy 69.08:  52%|█████▎    | 21/40 [04:15<04:30, 14.22s/it]
Task 7, Epoch 22/40 => Loss 0.299, Train_accy 72.09:  52%|█████▎    | 21/40 [04:23<04:30, 14.22s/it]                 
Task 7, Epoch 22/40 => Loss 0.299, Train_accy 72.09:  55%|█████▌    | 22/40 [04:23<03:42, 12.37s/it]
Task 7, Epoch 23/40 => Loss 0.293, Train_accy 72.41:  55%|█████▌    | 22/40 [04:31<03:42, 12.37s/it]
Task 7, Epoch 23/40 => Loss 0.293, Train_accy 72.41:  57%|█████▊    | 23/40 [04:31<03:08, 11.10s/it]
Task 7, Epoch 24/40 => Loss 0.326, Train_accy 72.97:  57%|█████▊    | 23/40 [04:39<03:08, 11.10s/it]
Task 7, Epoch 24/40 => Loss 0.326, Train_accy 72.97:  60%|██████    | 24/40 [04:40<02:43, 10.21s/it]
Task 7, Epoch 25/40 => Loss 0.311, Train_accy 73.49:  60%|██████    | 24/40 [04:48<02:43, 10.21s/it]
Task 7, Epoch 25/40 => Loss 0.311, Train_accy 73.49:  62%|██████▎   | 25/40 [04:48<02:23,  9.55s/it]
Task 7, Epoch 26/40 => Loss 0.326, Train_accy 73.30, Test_accy 69.16:  62%|██████▎   | 25/40 [05:13<02:23,  9.55s/it]
Task 7, Epoch 26/40 => Loss 0.326, Train_accy 73.30, Test_accy 69.16:  65%|██████▌   | 26/40 [05:13<03:19, 14.24s/it]
Task 7, Epoch 27/40 => Loss 0.297, Train_accy 74.65:  65%|██████▌   | 26/40 [05:21<03:19, 14.24s/it]                 
Task 7, Epoch 27/40 => Loss 0.297, Train_accy 74.65:  68%|██████▊   | 27/40 [05:21<02:41, 12.42s/it]
Task 7, Epoch 28/40 => Loss 0.267, Train_accy 74.93:  68%|██████▊   | 27/40 [05:29<02:41, 12.42s/it]
Task 7, Epoch 28/40 => Loss 0.267, Train_accy 74.93:  70%|███████   | 28/40 [05:29<02:13, 11.09s/it]
Task 7, Epoch 29/40 => Loss 0.304, Train_accy 73.72:  70%|███████   | 28/40 [05:37<02:13, 11.09s/it]
Task 7, Epoch 29/40 => Loss 0.304, Train_accy 73.72:  72%|███████▎  | 29/40 [05:37<01:51, 10.18s/it]
Task 7, Epoch 30/40 => Loss 0.266, Train_accy 75.16:  72%|███████▎  | 29/40 [05:45<01:51, 10.18s/it]
Task 7, Epoch 30/40 => Loss 0.266, Train_accy 75.16:  75%|███████▌  | 30/40 [05:45<01:35,  9.54s/it]
Task 7, Epoch 31/40 => Loss 0.293, Train_accy 74.60, Test_accy 69.14:  75%|███████▌  | 30/40 [06:10<01:35,  9.54s/it]
Task 7, Epoch 31/40 => Loss 0.293, Train_accy 74.60, Test_accy 69.14:  78%|███████▊  | 31/40 [06:10<02:07, 14.21s/it]
Task 7, Epoch 32/40 => Loss 0.301, Train_accy 74.42:  78%|███████▊  | 31/40 [06:18<02:07, 14.21s/it]                 
Task 7, Epoch 32/40 => Loss 0.301, Train_accy 74.42:  80%|████████  | 32/40 [06:18<01:38, 12.35s/it]
Task 7, Epoch 33/40 => Loss 0.292, Train_accy 73.58:  80%|████████  | 32/40 [06:26<01:38, 12.35s/it]
Task 7, Epoch 33/40 => Loss 0.292, Train_accy 73.58:  82%|████████▎ | 33/40 [06:26<01:17, 11.10s/it]
Task 7, Epoch 34/40 => Loss 0.309, Train_accy 74.00:  82%|████████▎ | 33/40 [06:34<01:17, 11.10s/it]
Task 7, Epoch 34/40 => Loss 0.309, Train_accy 74.00:  85%|████████▌ | 34/40 [06:34<01:01, 10.18s/it]
Task 7, Epoch 35/40 => Loss 0.306, Train_accy 73.90:  85%|████████▌ | 34/40 [06:43<01:01, 10.18s/it]
Task 7, Epoch 35/40 => Loss 0.306, Train_accy 73.90:  88%|████████▊ | 35/40 [06:43<00:48,  9.67s/it]
Task 7, Epoch 36/40 => Loss 0.322, Train_accy 73.02, Test_accy 69.18:  88%|████████▊ | 35/40 [07:08<00:48,  9.67s/it]
Task 7, Epoch 36/40 => Loss 0.322, Train_accy 73.02, Test_accy 69.18:  90%|█████████ | 36/40 [07:08<00:57, 14.29s/it]
Task 7, Epoch 37/40 => Loss 0.307, Train_accy 73.11:  90%|█████████ | 36/40 [07:16<00:57, 14.29s/it]                 
Task 7, Epoch 37/40 => Loss 0.307, Train_accy 73.11:  92%|█████████▎| 37/40 [07:16<00:37, 12.52s/it]
Task 7, Epoch 38/40 => Loss 0.296, Train_accy 73.90:  92%|█████████▎| 37/40 [07:24<00:37, 12.52s/it]
Task 7, Epoch 38/40 => Loss 0.296, Train_accy 73.90:  95%|█████████▌| 38/40 [07:24<00:22, 11.18s/it]
Task 7, Epoch 39/40 => Loss 0.277, Train_accy 74.84:  95%|█████████▌| 38/40 [07:32<00:22, 11.18s/it]
Task 7, Epoch 39/40 => Loss 0.277, Train_accy 74.84:  98%|█████████▊| 39/40 [07:32<00:10, 10.27s/it]
Task 7, Epoch 40/40 => Loss 0.301, Train_accy 74.98:  98%|█████████▊| 39/40 [07:41<00:10, 10.27s/it]
Task 7, Epoch 40/40 => Loss 0.301, Train_accy 74.98: 100%|██████████| 40/40 [07:41<00:00,  9.71s/it]
Task 7, Epoch 40/40 => Loss 0.301, Train_accy 74.98: 100%|██████████| 40/40 [07:41<00:00, 11.53s/it]
2025-11-08 01:20:42,422 [sdfourier.py] => Task 7, Epoch 40/40 => Loss 0.301, Train_accy 74.98
2025-11-08 01:20:58,031 [sdfourier.py] => Task 7, After merge adapters => Test_accy 67.05
2025-11-08 01:20:58,033 [trainer.py] => All params: 186043168
2025-11-08 01:20:58,034 [trainer.py] => Trainable params: 138880
2025-11-08 01:21:13,002 [trainer.py] => No NME accuracy.
2025-11-08 01:21:13,002 [trainer.py] => CNN: {'total': np.float64(67.05), '00-19': np.float64(68.23), '20-39': np.float64(68.25), '40-59': np.float64(69.24), '60-79': np.float64(62.67), '80-99': np.float64(68.0), '100-119': np.float64(66.41), '120-139': np.float64(59.61), '140-159': np.float64(73.81), 'old': np.float64(67.05), 'new': np.float64(nan)}
2025-11-08 01:21:13,002 [trainer.py] => CNN top1 curve: [np.float64(84.76), np.float64(79.21), np.float64(77.65), np.float64(73.96), np.float64(72.41), np.float64(70.06), np.float64(67.26), np.float64(67.05)]
2025-11-08 01:21:13,002 [trainer.py] => CNN top5 curve: [np.float64(95.79), np.float64(92.08), np.float64(91.12), np.float64(88.81), np.float64(87.38), np.float64(85.74), np.float64(84.36), np.float64(83.63)]

Average Accuracy (CNN): 74.045
2025-11-08 01:21:13,002 [trainer.py] => Average Accuracy (CNN): 74.045 

task 8
2025-11-08 01:21:13,005 [sdfourier.py] => Learning on 160-180

总共重置了 12 个模块的qkv层权重

  0%|          | 0/40 [00:00<?, ?it/s]
Task 8, Epoch 1/40 => Loss 2.309, Train_accy 9.64, Test_accy 65.78:   0%|          | 0/40 [00:27<?, ?it/s]
Task 8, Epoch 1/40 => Loss 2.309, Train_accy 9.64, Test_accy 65.78:   2%|▎         | 1/40 [00:27<18:09, 27.94s/it]
Task 8, Epoch 2/40 => Loss 1.039, Train_accy 42.52:   2%|▎         | 1/40 [00:36<18:09, 27.94s/it]                
Task 8, Epoch 2/40 => Loss 1.039, Train_accy 42.52:   5%|▌         | 2/40 [00:36<10:39, 16.83s/it]
Task 8, Epoch 3/40 => Loss 0.837, Train_accy 52.12:   5%|▌         | 2/40 [00:46<10:39, 16.83s/it]
Task 8, Epoch 3/40 => Loss 0.837, Train_accy 52.12:   8%|▊         | 3/40 [00:46<08:12, 13.32s/it]
Task 8, Epoch 4/40 => Loss 0.752, Train_accy 52.99:   8%|▊         | 3/40 [00:55<08:12, 13.32s/it]
Task 8, Epoch 4/40 => Loss 0.752, Train_accy 52.99:  10%|█         | 4/40 [00:55<06:56, 11.58s/it]
Task 8, Epoch 5/40 => Loss 0.719, Train_accy 52.58:  10%|█         | 4/40 [01:04<06:56, 11.58s/it]
Task 8, Epoch 5/40 => Loss 0.719, Train_accy 52.58:  12%|█▎        | 5/40 [01:04<06:12, 10.63s/it]
Task 8, Epoch 6/40 => Loss 0.642, Train_accy 55.53, Test_accy 67.54:  12%|█▎        | 5/40 [01:32<06:12, 10.63s/it]
Task 8, Epoch 6/40 => Loss 0.642, Train_accy 55.53, Test_accy 67.54:  15%|█▌        | 6/40 [01:32<09:23, 16.56s/it]
Task 8, Epoch 7/40 => Loss 0.619, Train_accy 57.32:  15%|█▌        | 6/40 [01:41<09:23, 16.56s/it]                 
Task 8, Epoch 7/40 => Loss 0.619, Train_accy 57.32:  18%|█▊        | 7/40 [01:41<07:44, 14.07s/it]
Task 8, Epoch 8/40 => Loss 0.564, Train_accy 58.65:  18%|█▊        | 7/40 [01:50<07:44, 14.07s/it]
Task 8, Epoch 8/40 => Loss 0.564, Train_accy 58.65:  20%|██        | 8/40 [01:50<06:39, 12.47s/it]
Task 8, Epoch 9/40 => Loss 0.611, Train_accy 57.90:  20%|██        | 8/40 [01:58<06:39, 12.47s/it]
Task 8, Epoch 9/40 => Loss 0.611, Train_accy 57.90:  22%|██▎       | 9/40 [01:58<05:52, 11.37s/it]
Task 8, Epoch 10/40 => Loss 0.577, Train_accy 59.48:  22%|██▎       | 9/40 [02:08<05:52, 11.37s/it]
Task 8, Epoch 10/40 => Loss 0.577, Train_accy 59.48:  25%|██▌       | 10/40 [02:08<05:19, 10.66s/it]
Task 8, Epoch 11/40 => Loss 0.539, Train_accy 60.56, Test_accy 67.61:  25%|██▌       | 10/40 [02:36<05:19, 10.66s/it]
Task 8, Epoch 11/40 => Loss 0.539, Train_accy 60.56, Test_accy 67.61:  28%|██▊       | 11/40 [02:36<07:42, 15.95s/it]
Task 8, Epoch 12/40 => Loss 0.530, Train_accy 61.26:  28%|██▊       | 11/40 [02:44<07:42, 15.95s/it]                 
Task 8, Epoch 12/40 => Loss 0.530, Train_accy 61.26:  30%|███       | 12/40 [02:44<06:27, 13.83s/it]
Task 8, Epoch 13/40 => Loss 0.530, Train_accy 62.47:  30%|███       | 12/40 [02:53<06:27, 13.83s/it]
Task 8, Epoch 13/40 => Loss 0.530, Train_accy 62.47:  32%|███▎      | 13/40 [02:53<05:33, 12.34s/it]
Task 8, Epoch 14/40 => Loss 0.513, Train_accy 62.84:  32%|███▎      | 13/40 [03:02<05:33, 12.34s/it]
Task 8, Epoch 14/40 => Loss 0.513, Train_accy 62.84:  35%|███▌      | 14/40 [03:02<04:54, 11.32s/it]
Task 8, Epoch 15/40 => Loss 0.524, Train_accy 63.76:  35%|███▌      | 14/40 [03:11<04:54, 11.32s/it]
Task 8, Epoch 15/40 => Loss 0.524, Train_accy 63.76:  38%|███▊      | 15/40 [03:11<04:25, 10.61s/it]
Task 8, Epoch 16/40 => Loss 0.494, Train_accy 64.26, Test_accy 67.67:  38%|███▊      | 15/40 [03:39<04:25, 10.61s/it]
Task 8, Epoch 16/40 => Loss 0.494, Train_accy 64.26, Test_accy 67.67:  40%|████      | 16/40 [03:39<06:19, 15.81s/it]
Task 8, Epoch 17/40 => Loss 0.466, Train_accy 64.75:  40%|████      | 16/40 [03:48<06:19, 15.81s/it]                 
Task 8, Epoch 17/40 => Loss 0.466, Train_accy 64.75:  42%|████▎     | 17/40 [03:48<05:16, 13.74s/it]
Task 8, Epoch 18/40 => Loss 0.463, Train_accy 64.34:  42%|████▎     | 17/40 [03:57<05:16, 13.74s/it]
Task 8, Epoch 18/40 => Loss 0.463, Train_accy 64.34:  45%|████▌     | 18/40 [03:57<04:30, 12.29s/it]
Task 8, Epoch 19/40 => Loss 0.467, Train_accy 65.34:  45%|████▌     | 18/40 [04:06<04:30, 12.29s/it]
Task 8, Epoch 19/40 => Loss 0.467, Train_accy 65.34:  48%|████▊     | 19/40 [04:06<03:57, 11.29s/it]
Task 8, Epoch 20/40 => Loss 0.474, Train_accy 65.38:  48%|████▊     | 19/40 [04:15<03:57, 11.29s/it]
Task 8, Epoch 20/40 => Loss 0.474, Train_accy 65.38:  50%|█████     | 20/40 [04:15<03:31, 10.59s/it]
Task 8, Epoch 21/40 => Loss 0.454, Train_accy 64.84, Test_accy 67.88:  50%|█████     | 20/40 [04:43<03:31, 10.59s/it]
Task 8, Epoch 21/40 => Loss 0.454, Train_accy 64.84, Test_accy 67.88:  52%|█████▎    | 21/40 [04:43<05:01, 15.85s/it]
Task 8, Epoch 22/40 => Loss 0.441, Train_accy 65.46:  52%|█████▎    | 21/40 [04:52<05:01, 15.85s/it]                 
Task 8, Epoch 22/40 => Loss 0.441, Train_accy 65.46:  55%|█████▌    | 22/40 [04:52<04:08, 13.81s/it]
Task 8, Epoch 23/40 => Loss 0.437, Train_accy 65.38:  55%|█████▌    | 22/40 [05:01<04:08, 13.81s/it]
Task 8, Epoch 23/40 => Loss 0.437, Train_accy 65.38:  57%|█████▊    | 23/40 [05:01<03:29, 12.35s/it]
Task 8, Epoch 24/40 => Loss 0.421, Train_accy 67.37:  57%|█████▊    | 23/40 [05:10<03:29, 12.35s/it]
Task 8, Epoch 24/40 => Loss 0.421, Train_accy 67.37:  60%|██████    | 24/40 [05:10<03:00, 11.31s/it]
Task 8, Epoch 25/40 => Loss 0.430, Train_accy 66.17:  60%|██████    | 24/40 [05:19<03:00, 11.31s/it]
Task 8, Epoch 25/40 => Loss 0.430, Train_accy 66.17:  62%|██████▎   | 25/40 [05:19<02:39, 10.61s/it]
Task 8, Epoch 26/40 => Loss 0.440, Train_accy 65.63, Test_accy 67.71:  62%|██████▎   | 25/40 [05:47<02:39, 10.61s/it]
Task 8, Epoch 26/40 => Loss 0.440, Train_accy 65.63, Test_accy 67.71:  65%|██████▌   | 26/40 [05:47<03:41, 15.80s/it]
Task 8, Epoch 27/40 => Loss 0.405, Train_accy 67.91:  65%|██████▌   | 26/40 [05:56<03:41, 15.80s/it]                 
Task 8, Epoch 27/40 => Loss 0.405, Train_accy 67.91:  68%|██████▊   | 27/40 [05:56<02:58, 13.75s/it]
Task 8, Epoch 28/40 => Loss 0.478, Train_accy 65.13:  68%|██████▊   | 27/40 [06:05<02:58, 13.75s/it]
Task 8, Epoch 28/40 => Loss 0.478, Train_accy 65.13:  70%|███████   | 28/40 [06:05<02:27, 12.30s/it]
Task 8, Epoch 29/40 => Loss 0.426, Train_accy 67.79:  70%|███████   | 28/40 [06:14<02:27, 12.30s/it]
Task 8, Epoch 29/40 => Loss 0.426, Train_accy 67.79:  72%|███████▎  | 29/40 [06:14<02:04, 11.31s/it]
Task 8, Epoch 30/40 => Loss 0.420, Train_accy 66.75:  72%|███████▎  | 29/40 [06:23<02:04, 11.31s/it]
Task 8, Epoch 30/40 => Loss 0.420, Train_accy 66.75:  75%|███████▌  | 30/40 [06:23<01:45, 10.59s/it]
Task 8, Epoch 31/40 => Loss 0.402, Train_accy 66.63, Test_accy 67.69:  75%|███████▌  | 30/40 [06:51<01:45, 10.59s/it]
Task 8, Epoch 31/40 => Loss 0.402, Train_accy 66.63, Test_accy 67.69:  78%|███████▊  | 31/40 [06:51<02:22, 15.79s/it]
Task 8, Epoch 32/40 => Loss 0.429, Train_accy 66.75:  78%|███████▊  | 31/40 [07:00<02:22, 15.79s/it]                 
Task 8, Epoch 32/40 => Loss 0.429, Train_accy 66.75:  80%|████████  | 32/40 [07:00<01:50, 13.80s/it]
Task 8, Epoch 33/40 => Loss 0.404, Train_accy 67.04:  80%|████████  | 32/40 [07:09<01:50, 13.80s/it]
Task 8, Epoch 33/40 => Loss 0.404, Train_accy 67.04:  82%|████████▎ | 33/40 [07:09<01:26, 12.39s/it]
Task 8, Epoch 34/40 => Loss 0.405, Train_accy 67.54:  82%|████████▎ | 33/40 [07:18<01:26, 12.39s/it]
Task 8, Epoch 34/40 => Loss 0.405, Train_accy 67.54:  85%|████████▌ | 34/40 [07:18<01:08, 11.37s/it]
Task 8, Epoch 35/40 => Loss 0.386, Train_accy 67.04:  85%|████████▌ | 34/40 [07:27<01:08, 11.37s/it]
Task 8, Epoch 35/40 => Loss 0.386, Train_accy 67.04:  88%|████████▊ | 35/40 [07:27<00:53, 10.64s/it]
Task 8, Epoch 36/40 => Loss 0.419, Train_accy 66.67, Test_accy 67.71:  88%|████████▊ | 35/40 [07:55<00:53, 10.64s/it]
Task 8, Epoch 36/40 => Loss 0.419, Train_accy 66.67, Test_accy 67.71:  90%|█████████ | 36/40 [07:55<01:03, 15.95s/it]
Task 8, Epoch 37/40 => Loss 0.418, Train_accy 66.75:  90%|█████████ | 36/40 [08:04<01:03, 15.95s/it]                 
Task 8, Epoch 37/40 => Loss 0.418, Train_accy 66.75:  92%|█████████▎| 37/40 [08:04<00:41, 13.88s/it]
Task 8, Epoch 38/40 => Loss 0.418, Train_accy 67.37:  92%|█████████▎| 37/40 [08:13<00:41, 13.88s/it]
Task 8, Epoch 38/40 => Loss 0.418, Train_accy 67.37:  95%|█████████▌| 38/40 [08:13<00:24, 12.47s/it]
Task 8, Epoch 39/40 => Loss 0.432, Train_accy 66.63:  95%|█████████▌| 38/40 [08:22<00:24, 12.47s/it]
Task 8, Epoch 39/40 => Loss 0.432, Train_accy 66.63:  98%|█████████▊| 39/40 [08:22<00:11, 11.40s/it]
Task 8, Epoch 40/40 => Loss 0.385, Train_accy 68.87:  98%|█████████▊| 39/40 [08:31<00:11, 11.40s/it]
Task 8, Epoch 40/40 => Loss 0.385, Train_accy 68.87: 100%|██████████| 40/40 [08:31<00:00, 10.67s/it]
Task 8, Epoch 40/40 => Loss 0.385, Train_accy 68.87: 100%|██████████| 40/40 [08:31<00:00, 12.79s/it]
2025-11-08 01:29:46,639 [sdfourier.py] => Task 8, Epoch 40/40 => Loss 0.385, Train_accy 68.87
2025-11-08 01:30:04,030 [sdfourier.py] => Task 8, After merge adapters => Test_accy 65.37
2025-11-08 01:30:04,032 [trainer.py] => All params: 186085908
2025-11-08 01:30:04,033 [trainer.py] => Trainable params: 154260
2025-11-08 01:30:20,740 [trainer.py] => No NME accuracy.
2025-11-08 01:30:20,740 [trainer.py] => CNN: {'total': np.float64(65.37), '00-19': np.float64(66.29), '20-39': np.float64(67.1), '40-59': np.float64(67.7), '60-79': np.float64(61.62), '80-99': np.float64(67.0), '100-119': np.float64(65.0), '120-139': np.float64(58.45), '140-159': np.float64(73.63), '160-179': np.float64(61.54), 'old': np.float64(65.37), 'new': np.float64(nan)}
2025-11-08 01:30:20,740 [trainer.py] => CNN top1 curve: [np.float64(84.76), np.float64(79.21), np.float64(77.65), np.float64(73.96), np.float64(72.41), np.float64(70.06), np.float64(67.26), np.float64(67.05), np.float64(65.37)]
2025-11-08 01:30:20,740 [trainer.py] => CNN top5 curve: [np.float64(95.79), np.float64(92.08), np.float64(91.12), np.float64(88.81), np.float64(87.38), np.float64(85.74), np.float64(84.36), np.float64(83.63), np.float64(81.87)]

Average Accuracy (CNN): 73.08111111111111
2025-11-08 01:30:20,740 [trainer.py] => Average Accuracy (CNN): 73.08111111111111 

task 9
2025-11-08 01:30:20,742 [sdfourier.py] => Learning on 180-200

总共重置了 12 个模块的qkv层权重

  0%|          | 0/40 [00:00<?, ?it/s]
Task 9, Epoch 1/40 => Loss 1.858, Train_accy 16.80, Test_accy 65.58:   0%|          | 0/40 [00:31<?, ?it/s]
Task 9, Epoch 1/40 => Loss 1.858, Train_accy 16.80, Test_accy 65.58:   2%|▎         | 1/40 [00:31<20:15, 31.16s/it]
Task 9, Epoch 2/40 => Loss 0.729, Train_accy 52.11:   2%|▎         | 1/40 [00:40<20:15, 31.16s/it]                 
Task 9, Epoch 2/40 => Loss 0.729, Train_accy 52.11:   5%|▌         | 2/40 [00:40<11:45, 18.56s/it]
Task 9, Epoch 3/40 => Loss 0.618, Train_accy 57.47:   5%|▌         | 2/40 [00:50<11:45, 18.56s/it]
Task 9, Epoch 3/40 => Loss 0.618, Train_accy 57.47:   8%|▊         | 3/40 [00:50<08:55, 14.48s/it]
Task 9, Epoch 4/40 => Loss 0.529, Train_accy 59.03:   8%|▊         | 3/40 [01:00<08:55, 14.48s/it]
Task 9, Epoch 4/40 => Loss 0.529, Train_accy 59.03:  10%|█         | 4/40 [01:00<07:33, 12.60s/it]
Task 9, Epoch 5/40 => Loss 0.509, Train_accy 60.13:  10%|█         | 4/40 [01:10<07:33, 12.60s/it]
Task 9, Epoch 5/40 => Loss 0.509, Train_accy 60.13:  12%|█▎        | 5/40 [01:10<06:45, 11.59s/it]
Task 9, Epoch 6/40 => Loss 0.470, Train_accy 61.12, Test_accy 66.95:  12%|█▎        | 5/40 [01:40<06:45, 11.59s/it]
Task 9, Epoch 6/40 => Loss 0.470, Train_accy 61.12, Test_accy 66.95:  15%|█▌        | 6/40 [01:40<10:17, 18.16s/it]
Task 9, Epoch 7/40 => Loss 0.408, Train_accy 62.18:  15%|█▌        | 6/40 [01:50<10:17, 18.16s/it]                 
Task 9, Epoch 7/40 => Loss 0.408, Train_accy 62.18:  18%|█▊        | 7/40 [01:50<08:27, 15.39s/it]
Task 9, Epoch 8/40 => Loss 0.429, Train_accy 62.79:  18%|█▊        | 7/40 [02:00<08:27, 15.39s/it]
Task 9, Epoch 8/40 => Loss 0.429, Train_accy 62.79:  20%|██        | 8/40 [02:00<07:15, 13.60s/it]
Task 9, Epoch 9/40 => Loss 0.396, Train_accy 63.66:  20%|██        | 8/40 [02:10<07:15, 13.60s/it]
Task 9, Epoch 9/40 => Loss 0.396, Train_accy 63.66:  22%|██▎       | 9/40 [02:10<06:24, 12.40s/it]
Task 9, Epoch 10/40 => Loss 0.429, Train_accy 63.02:  22%|██▎       | 9/40 [02:19<06:24, 12.40s/it]
Task 9, Epoch 10/40 => Loss 0.429, Train_accy 63.02:  25%|██▌       | 10/40 [02:19<05:47, 11.60s/it]
Task 9, Epoch 11/40 => Loss 0.385, Train_accy 66.67, Test_accy 67.18:  25%|██▌       | 10/40 [02:50<05:47, 11.60s/it]
Task 9, Epoch 11/40 => Loss 0.385, Train_accy 66.67, Test_accy 67.18:  28%|██▊       | 11/40 [02:50<08:28, 17.53s/it]
Task 9, Epoch 12/40 => Loss 0.370, Train_accy 66.32:  28%|██▊       | 11/40 [03:00<08:28, 17.53s/it]                 
Task 9, Epoch 12/40 => Loss 0.370, Train_accy 66.32:  30%|███       | 12/40 [03:00<07:05, 15.19s/it]
Task 9, Epoch 13/40 => Loss 0.379, Train_accy 66.29:  30%|███       | 12/40 [03:10<07:05, 15.19s/it]
Task 9, Epoch 13/40 => Loss 0.379, Train_accy 66.29:  32%|███▎      | 13/40 [03:10<06:05, 13.53s/it]
Task 9, Epoch 14/40 => Loss 0.341, Train_accy 67.05:  32%|███▎      | 13/40 [03:20<06:05, 13.53s/it]
Task 9, Epoch 14/40 => Loss 0.341, Train_accy 67.05:  35%|███▌      | 14/40 [03:20<05:22, 12.39s/it]
Task 9, Epoch 15/40 => Loss 0.352, Train_accy 67.43:  35%|███▌      | 14/40 [03:29<05:22, 12.39s/it]
Task 9, Epoch 15/40 => Loss 0.352, Train_accy 67.43:  38%|███▊      | 15/40 [03:29<04:49, 11.59s/it]
Task 9, Epoch 16/40 => Loss 0.383, Train_accy 67.35, Test_accy 67.23:  38%|███▊      | 15/40 [04:00<04:49, 11.59s/it]
Task 9, Epoch 16/40 => Loss 0.383, Train_accy 67.35, Test_accy 67.23:  40%|████      | 16/40 [04:00<06:57, 17.41s/it]
Task 9, Epoch 17/40 => Loss 0.308, Train_accy 68.57:  40%|████      | 16/40 [04:10<06:57, 17.41s/it]                 
Task 9, Epoch 17/40 => Loss 0.308, Train_accy 68.57:  42%|████▎     | 17/40 [04:10<05:46, 15.08s/it]
Task 9, Epoch 18/40 => Loss 0.312, Train_accy 69.67:  42%|████▎     | 17/40 [04:20<05:46, 15.08s/it]
Task 9, Epoch 18/40 => Loss 0.312, Train_accy 69.67:  45%|████▌     | 18/40 [04:20<04:56, 13.48s/it]
Task 9, Epoch 19/40 => Loss 0.332, Train_accy 68.11:  45%|████▌     | 18/40 [04:30<04:56, 13.48s/it]
Task 9, Epoch 19/40 => Loss 0.332, Train_accy 68.11:  48%|████▊     | 19/40 [04:30<04:19, 12.38s/it]
Task 9, Epoch 20/40 => Loss 0.314, Train_accy 68.95:  48%|████▊     | 19/40 [04:39<04:19, 12.38s/it]
Task 9, Epoch 20/40 => Loss 0.314, Train_accy 68.95:  50%|█████     | 20/40 [04:39<03:51, 11.59s/it]
Task 9, Epoch 21/40 => Loss 0.308, Train_accy 69.21, Test_accy 67.25:  50%|█████     | 20/40 [05:11<03:51, 11.59s/it]
Task 9, Epoch 21/40 => Loss 0.308, Train_accy 69.21, Test_accy 67.25:  52%|█████▎    | 21/40 [05:11<05:32, 17.52s/it]
Task 9, Epoch 22/40 => Loss 0.318, Train_accy 68.00:  52%|█████▎    | 21/40 [05:20<05:32, 17.52s/it]                 
Task 9, Epoch 22/40 => Loss 0.318, Train_accy 68.00:  55%|█████▌    | 22/40 [05:20<04:32, 15.16s/it]
Task 9, Epoch 23/40 => Loss 0.292, Train_accy 71.99:  55%|█████▌    | 22/40 [05:30<04:32, 15.16s/it]
Task 9, Epoch 23/40 => Loss 0.292, Train_accy 71.99:  57%|█████▊    | 23/40 [05:30<03:50, 13.57s/it]
Task 9, Epoch 24/40 => Loss 0.286, Train_accy 70.77:  57%|█████▊    | 23/40 [05:40<03:50, 13.57s/it]
Task 9, Epoch 24/40 => Loss 0.286, Train_accy 70.77:  60%|██████    | 24/40 [05:40<03:19, 12.46s/it]
Task 9, Epoch 25/40 => Loss 0.296, Train_accy 71.91:  60%|██████    | 24/40 [05:50<03:19, 12.46s/it]
Task 9, Epoch 25/40 => Loss 0.296, Train_accy 71.91:  62%|██████▎   | 25/40 [05:50<02:54, 11.67s/it]
Task 9, Epoch 26/40 => Loss 0.283, Train_accy 71.04, Test_accy 67.40:  62%|██████▎   | 25/40 [06:21<02:54, 11.67s/it]
Task 9, Epoch 26/40 => Loss 0.283, Train_accy 71.04, Test_accy 67.40:  65%|██████▌   | 26/40 [06:21<04:04, 17.46s/it]
Task 9, Epoch 27/40 => Loss 0.315, Train_accy 70.62:  65%|██████▌   | 26/40 [06:31<04:04, 17.46s/it]                 
Task 9, Epoch 27/40 => Loss 0.315, Train_accy 70.62:  68%|██████▊   | 27/40 [06:31<03:17, 15.19s/it]
Task 9, Epoch 28/40 => Loss 0.323, Train_accy 70.24:  68%|██████▊   | 27/40 [06:40<03:17, 15.19s/it]
Task 9, Epoch 28/40 => Loss 0.323, Train_accy 70.24:  70%|███████   | 28/40 [06:40<02:42, 13.53s/it]
Task 9, Epoch 29/40 => Loss 0.303, Train_accy 69.78:  70%|███████   | 28/40 [06:50<02:42, 13.53s/it]
Task 9, Epoch 29/40 => Loss 0.303, Train_accy 69.78:  72%|███████▎  | 29/40 [06:50<02:16, 12.44s/it]
Task 9, Epoch 30/40 => Loss 0.301, Train_accy 71.08:  72%|███████▎  | 29/40 [07:00<02:16, 12.44s/it]
Task 9, Epoch 30/40 => Loss 0.301, Train_accy 71.08:  75%|███████▌  | 30/40 [07:00<01:56, 11.61s/it]
Task 9, Epoch 31/40 => Loss 0.291, Train_accy 69.97, Test_accy 67.32:  75%|███████▌  | 30/40 [07:31<01:56, 11.61s/it]
Task 9, Epoch 31/40 => Loss 0.291, Train_accy 69.97, Test_accy 67.32:  78%|███████▊  | 31/40 [07:31<02:36, 17.40s/it]
Task 9, Epoch 32/40 => Loss 0.301, Train_accy 69.94:  78%|███████▊  | 31/40 [07:41<02:36, 17.40s/it]                 
Task 9, Epoch 32/40 => Loss 0.301, Train_accy 69.94:  80%|████████  | 32/40 [07:41<02:00, 15.09s/it]
Task 9, Epoch 33/40 => Loss 0.314, Train_accy 70.77:  80%|████████  | 32/40 [07:50<02:00, 15.09s/it]
Task 9, Epoch 33/40 => Loss 0.314, Train_accy 70.77:  82%|████████▎ | 33/40 [07:50<01:34, 13.51s/it]
Task 9, Epoch 34/40 => Loss 0.329, Train_accy 70.39:  82%|████████▎ | 33/40 [08:00<01:34, 13.51s/it]
Task 9, Epoch 34/40 => Loss 0.329, Train_accy 70.39:  85%|████████▌ | 34/40 [08:00<01:14, 12.42s/it]
Task 9, Epoch 35/40 => Loss 0.305, Train_accy 70.32:  85%|████████▌ | 34/40 [08:10<01:14, 12.42s/it]
Task 9, Epoch 35/40 => Loss 0.305, Train_accy 70.32:  88%|████████▊ | 35/40 [08:10<00:58, 11.62s/it]
Task 9, Epoch 36/40 => Loss 0.275, Train_accy 71.11, Test_accy 67.38:  88%|████████▊ | 35/40 [08:41<00:58, 11.62s/it]
Task 9, Epoch 36/40 => Loss 0.275, Train_accy 71.11, Test_accy 67.38:  90%|█████████ | 36/40 [08:41<01:09, 17.41s/it]
Task 9, Epoch 37/40 => Loss 0.281, Train_accy 70.51:  90%|█████████ | 36/40 [08:51<01:09, 17.41s/it]                 
Task 9, Epoch 37/40 => Loss 0.281, Train_accy 70.51:  92%|█████████▎| 37/40 [08:51<00:45, 15.14s/it]
Task 9, Epoch 38/40 => Loss 0.295, Train_accy 70.32:  92%|█████████▎| 37/40 [09:01<00:45, 15.14s/it]
Task 9, Epoch 38/40 => Loss 0.295, Train_accy 70.32:  95%|█████████▌| 38/40 [09:01<00:27, 13.55s/it]
Task 9, Epoch 39/40 => Loss 0.307, Train_accy 71.00:  95%|█████████▌| 38/40 [09:10<00:27, 13.55s/it]
Task 9, Epoch 39/40 => Loss 0.307, Train_accy 71.00:  98%|█████████▊| 39/40 [09:10<00:12, 12.39s/it]
Task 9, Epoch 40/40 => Loss 0.289, Train_accy 70.77:  98%|█████████▊| 39/40 [09:20<00:12, 12.39s/it]
Task 9, Epoch 40/40 => Loss 0.289, Train_accy 70.77: 100%|██████████| 40/40 [09:20<00:00, 11.60s/it]
Task 9, Epoch 40/40 => Loss 0.289, Train_accy 70.77: 100%|██████████| 40/40 [09:20<00:00, 14.02s/it]
2025-11-08 01:39:43,616 [sdfourier.py] => Task 9, Epoch 40/40 => Loss 0.289, Train_accy 70.77
2025-11-08 01:40:02,893 [sdfourier.py] => Task 9, After merge adapters => Test_accy 64.82
2025-11-08 01:40:02,895 [trainer.py] => All params: 186130088
2025-11-08 01:40:02,896 [trainer.py] => Trainable params: 169640
2025-11-08 01:40:21,556 [trainer.py] => No NME accuracy.
2025-11-08 01:40:21,556 [trainer.py] => CNN: {'total': np.float64(64.82), '00-19': np.float64(64.18), '20-39': np.float64(65.37), '40-59': np.float64(66.77), '60-79': np.float64(60.87), '80-99': np.float64(65.75), '100-119': np.float64(63.91), '120-139': np.float64(56.5), '140-159': np.float64(72.39), '160-179': np.float64(60.37), '180-199': np.float64(71.3), 'old': np.float64(64.82), 'new': np.float64(nan)}
2025-11-08 01:40:21,556 [trainer.py] => CNN top1 curve: [np.float64(84.76), np.float64(79.21), np.float64(77.65), np.float64(73.96), np.float64(72.41), np.float64(70.06), np.float64(67.26), np.float64(67.05), np.float64(65.37), np.float64(64.82)]
2025-11-08 01:40:21,556 [trainer.py] => CNN top5 curve: [np.float64(95.79), np.float64(92.08), np.float64(91.12), np.float64(88.81), np.float64(87.38), np.float64(85.74), np.float64(84.36), np.float64(83.63), np.float64(81.87), np.float64(81.43)]

Average Accuracy (CNN): 72.255
2025-11-08 01:40:21,556 [trainer.py] => Average Accuracy (CNN): 72.255 

Accuracy Matrix (CNN):
[[84.76 78.77 75.36 75.2  73.26 71.31 70.02 68.23 66.29 64.18]
 [ 0.   79.6  77.44 75.29 74.57 68.59 67.03 66.41 65.   63.91]
 [ 0.    0.   80.06 77.74 75.43 71.98 60.   59.61 58.45 56.5 ]
 [ 0.    0.    0.   67.77 67.17 72.95 69.68 73.81 73.63 72.39]
 [ 0.    0.    0.    0.   71.25 65.22 70.94 68.25 61.54 60.37]
 [ 0.    0.    0.    0.    0.   70.5  63.12 69.24 67.1  71.3 ]
 [ 0.    0.    0.    0.    0.    0.   69.5  62.67 67.7  65.37]
 [ 0.    0.    0.    0.    0.    0.    0.   68.   61.62 66.77]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   67.   60.87]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   65.75]]
2025-11-08 01:40:21,557 [trainer.py] => Forgetting (CNN): 9.291111111111112
seed [1995]
devices_type ['1']
2025-11-09 11:04:30,257 [trainer.py] => config: ./exps/sdfourierft_inr.json
2025-11-09 11:04:30,257 [trainer.py] => seed: 1995
2025-11-09 11:04:30,257 [trainer.py] => prefix: reproduce
2025-11-09 11:04:30,257 [trainer.py] => dataset: imagenetr
2025-11-09 11:04:30,257 [trainer.py] => memory_size: 0
2025-11-09 11:04:30,257 [trainer.py] => memory_per_class: 0
2025-11-09 11:04:30,257 [trainer.py] => fixed_memory: False
2025-11-09 11:04:30,257 [trainer.py] => shuffle: True
2025-11-09 11:04:30,257 [trainer.py] => init_cls: 20
2025-11-09 11:04:30,257 [trainer.py] => increment: 20
2025-11-09 11:04:30,257 [trainer.py] => model_name: fourierft
2025-11-09 11:04:30,257 [trainer.py] => backbone_type: vit_base_patch16_224
2025-11-09 11:04:30,257 [trainer.py] => device: [device(type='cuda', index=1)]
2025-11-09 11:04:30,257 [trainer.py] => optimizer: adam
2025-11-09 11:04:30,257 [trainer.py] => scheduler: cosine
2025-11-09 11:04:30,257 [trainer.py] => filepath: ./data/imagenet-r
2025-11-09 11:04:30,257 [trainer.py] => init_epoch: 40
2025-11-09 11:04:30,257 [trainer.py] => init_lr: 0.01
2025-11-09 11:04:30,257 [trainer.py] => init_milestones: [10000]
2025-11-09 11:04:30,257 [trainer.py] => init_lr_decay: 0
2025-11-09 11:04:30,257 [trainer.py] => init_weight_decay: 0.0005
2025-11-09 11:04:30,257 [trainer.py] => epochs: 40
2025-11-09 11:04:30,257 [trainer.py] => lrate: 0.01
2025-11-09 11:04:30,257 [trainer.py] => milestones: [10000]
2025-11-09 11:04:30,257 [trainer.py] => lrate_decay: 0
2025-11-09 11:04:30,257 [trainer.py] => batch_size: 128
2025-11-09 11:04:30,257 [trainer.py] => weight_decay: 0.0002
2025-11-09 11:04:30,257 [trainer.py] => fourierft: {'n_frequency': 400, 'n_frequency_non_trainable': 0, 'scaling': 150.0, 'random_loc_seed': 42, 'init_weights': False, 'prefer': True, 'init_fc': 1, 'fourier_layer': None, 'target_modules': ['q', 'v'], 'bias': 'none', 'modules_to_save': ['classifier'], 'layers_to_transform': None, 'layers_pattern': None, 'n_frequency_pattern': {}, 'fan_in_fan_out': False}
2025-11-09 11:04:30,257 [trainer.py] => indices_file_path: ./results/fourierft_imagenetr
2025-11-09 11:04:30,257 [trainer.py] => reinit_num: 40
2025-11-09 11:04:30,257 [trainer.py] => round_number: 0
2025-11-09 11:04:30,257 [trainer.py] => task_specific_branches: True
2025-11-09 11:04:30,257 [trainer.py] => avoid_index_overlap: True
2025-11-09 11:04:30,257 [trainer.py] => merge_strategy: max
2025-11-09 11:04:30,257 [trainer.py] => merge_adapters: True
2025-11-09 11:04:30,257 [trainer.py] => dynamic_n_frequency: True
2025-11-09 11:04:30,334 [data_manager.py] => [146, 198, 169, 126, 142, 183, 108, 86, 79, 35, 112, 29, 0, 2, 59, 178, 143, 31, 147, 33, 123, 114, 194, 54, 138, 75, 158, 26, 131, 141, 180, 132, 22, 49, 116, 111, 24, 98, 107, 89, 151, 83, 185, 15, 27, 136, 65, 1, 82, 87, 99, 153, 47, 144, 145, 175, 155, 77, 191, 199, 46, 28, 76, 71, 93, 137, 5, 188, 187, 74, 103, 173, 18, 80, 88, 48, 109, 81, 91, 101, 43, 102, 61, 182, 3, 14, 40, 42, 167, 66, 57, 73, 135, 39, 45, 184, 161, 85, 148, 121, 8, 195, 21, 4, 106, 133, 118, 10, 176, 50, 36, 192, 162, 172, 96, 197, 20, 117, 140, 186, 92, 97, 44, 149, 13, 37, 170, 25, 181, 171, 23, 104, 189, 11, 159, 67, 94, 68, 55, 6, 150, 165, 120, 139, 72, 154, 115, 125, 53, 58, 16, 113, 41, 190, 174, 127, 110, 7, 38, 32, 95, 19, 196, 51, 78, 34, 122, 152, 119, 134, 129, 130, 128, 17, 30, 90, 124, 160, 100, 193, 12, 56, 64, 168, 105, 63, 177, 70, 60, 163, 9, 62, 156, 52, 84, 157, 69, 179, 166, 164]
!!!!!!! multiple_gpus [device(type='cuda', index=1)]
This is for the BaseNet initialization.
2025-11-09 11:04:31,599 [_builder.py] => Loading pretrained weights from Hugging Face hub (timm/vit_base_patch16_224.augreg2_in21k_ft_in1k)
2025-11-09 11:04:32,494 [_client.py] => HTTP Request: HEAD https://huggingface.co/timm/vit_base_patch16_224.augreg2_in21k_ft_in1k/resolve/main/model.safetensors "HTTP/1.1 302 Found"
2025-11-09 11:04:32,495 [_hub.py] => [timm/vit_base_patch16_224.augreg2_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
save_file ./results/fourierft_imagenetr
After BaseNet initialization.
task 0
2025-11-09 11:04:32,891 [sdfourier.py] => Learning on 0-20

  0%|          | 0/40 [00:00<?, ?it/s]
Task 0, Epoch 1/40 => Loss 2.109, Train_accy 44.15, Test_accy 80.88:   0%|          | 0/40 [00:13<?, ?it/s]
Task 0, Epoch 1/40 => Loss 2.109, Train_accy 44.15, Test_accy 80.88:   2%|▎         | 1/40 [00:13<08:46, 13.49s/it]
Task 0, Epoch 2/40 => Loss 0.849, Train_accy 75.41:   2%|▎         | 1/40 [00:24<08:46, 13.49s/it]                 
Task 0, Epoch 2/40 => Loss 0.849, Train_accy 75.41:   5%|▌         | 2/40 [00:24<07:41, 12.13s/it]
Task 0, Epoch 3/40 => Loss 0.745, Train_accy 78.97:   5%|▌         | 2/40 [00:35<07:41, 12.13s/it]
Task 0, Epoch 3/40 => Loss 0.745, Train_accy 78.97:   8%|▊         | 3/40 [00:35<07:12, 11.69s/it]
Task 0, Epoch 4/40 => Loss 0.621, Train_accy 82.17:   8%|▊         | 3/40 [00:47<07:12, 11.69s/it]
Task 0, Epoch 4/40 => Loss 0.621, Train_accy 82.17:  10%|█         | 4/40 [00:47<06:55, 11.53s/it]
Task 0, Epoch 5/40 => Loss 0.548, Train_accy 84.33:  10%|█         | 4/40 [00:58<06:55, 11.53s/it]
Task 0, Epoch 5/40 => Loss 0.548, Train_accy 84.33:  12%|█▎        | 5/40 [00:58<06:38, 11.40s/it]
Task 0, Epoch 6/40 => Loss 0.555, Train_accy 83.48, Test_accy 86.55:  12%|█▎        | 5/40 [01:11<06:38, 11.40s/it]
Task 0, Epoch 6/40 => Loss 0.555, Train_accy 83.48, Test_accy 86.55:  15%|█▌        | 6/40 [01:11<06:47, 11.99s/it]
Task 0, Epoch 7/40 => Loss 0.507, Train_accy 85.45:  15%|█▌        | 6/40 [01:22<06:47, 11.99s/it]                 
Task 0, Epoch 7/40 => Loss 0.507, Train_accy 85.45:  18%|█▊        | 7/40 [01:22<06:26, 11.71s/it]
Task 0, Epoch 8/40 => Loss 0.503, Train_accy 85.68:  18%|█▊        | 7/40 [01:33<06:26, 11.71s/it]
Task 0, Epoch 8/40 => Loss 0.503, Train_accy 85.68:  20%|██        | 8/40 [01:33<06:09, 11.54s/it]
Task 0, Epoch 9/40 => Loss 0.480, Train_accy 86.38:  20%|██        | 8/40 [01:44<06:09, 11.54s/it]
Task 0, Epoch 9/40 => Loss 0.480, Train_accy 86.38:  22%|██▎       | 9/40 [01:44<05:54, 11.43s/it]
Task 0, Epoch 10/40 => Loss 0.448, Train_accy 87.07:  22%|██▎       | 9/40 [01:56<05:54, 11.43s/it]
Task 0, Epoch 10/40 => Loss 0.448, Train_accy 87.07:  25%|██▌       | 10/40 [01:56<05:41, 11.37s/it]
Task 0, Epoch 11/40 => Loss 0.445, Train_accy 87.84, Test_accy 86.55:  25%|██▌       | 10/40 [02:09<05:41, 11.37s/it]
Task 0, Epoch 11/40 => Loss 0.445, Train_accy 87.84, Test_accy 86.55:  28%|██▊       | 11/40 [02:09<05:45, 11.91s/it]
Task 0, Epoch 12/40 => Loss 0.436, Train_accy 88.11:  28%|██▊       | 11/40 [02:20<05:45, 11.91s/it]                 
Task 0, Epoch 12/40 => Loss 0.436, Train_accy 88.11:  30%|███       | 12/40 [02:20<05:26, 11.67s/it]
Task 0, Epoch 13/40 => Loss 0.432, Train_accy 88.07:  30%|███       | 12/40 [02:31<05:26, 11.67s/it]
Task 0, Epoch 13/40 => Loss 0.432, Train_accy 88.07:  32%|███▎      | 13/40 [02:31<05:10, 11.51s/it]
Task 0, Epoch 14/40 => Loss 0.431, Train_accy 87.65:  32%|███▎      | 13/40 [02:42<05:10, 11.51s/it]
Task 0, Epoch 14/40 => Loss 0.431, Train_accy 87.65:  35%|███▌      | 14/40 [02:42<04:56, 11.39s/it]
Task 0, Epoch 15/40 => Loss 0.404, Train_accy 88.46:  35%|███▌      | 14/40 [02:53<04:56, 11.39s/it]
Task 0, Epoch 15/40 => Loss 0.404, Train_accy 88.46:  38%|███▊      | 15/40 [02:53<04:43, 11.32s/it]
Task 0, Epoch 16/40 => Loss 0.404, Train_accy 88.73, Test_accy 86.06:  38%|███▊      | 15/40 [03:07<04:43, 11.32s/it]
Task 0, Epoch 16/40 => Loss 0.404, Train_accy 88.73, Test_accy 86.06:  40%|████      | 16/40 [03:07<04:46, 11.95s/it]
Task 0, Epoch 17/40 => Loss 0.364, Train_accy 89.54:  40%|████      | 16/40 [03:18<04:46, 11.95s/it]                 
Task 0, Epoch 17/40 => Loss 0.364, Train_accy 89.54:  42%|████▎     | 17/40 [03:18<04:29, 11.71s/it]
Task 0, Epoch 18/40 => Loss 0.377, Train_accy 89.66:  42%|████▎     | 17/40 [03:29<04:29, 11.71s/it]
Task 0, Epoch 18/40 => Loss 0.377, Train_accy 89.66:  45%|████▌     | 18/40 [03:29<04:15, 11.62s/it]
Task 0, Epoch 19/40 => Loss 0.389, Train_accy 89.39:  45%|████▌     | 18/40 [03:40<04:15, 11.62s/it]
Task 0, Epoch 19/40 => Loss 0.389, Train_accy 89.39:  48%|████▊     | 19/40 [03:40<04:00, 11.47s/it]
Task 0, Epoch 20/40 => Loss 0.360, Train_accy 89.66:  48%|████▊     | 19/40 [03:52<04:00, 11.47s/it]
Task 0, Epoch 20/40 => Loss 0.360, Train_accy 89.66:  50%|█████     | 20/40 [03:52<03:47, 11.36s/it]
Task 0, Epoch 21/40 => Loss 0.380, Train_accy 89.08, Test_accy 86.39:  50%|█████     | 20/40 [04:05<03:47, 11.36s/it]
Task 0, Epoch 21/40 => Loss 0.380, Train_accy 89.08, Test_accy 86.39:  52%|█████▎    | 21/40 [04:05<03:45, 11.89s/it]
Task 0, Epoch 22/40 => Loss 0.371, Train_accy 89.70:  52%|█████▎    | 21/40 [04:16<03:45, 11.89s/it]                 
Task 0, Epoch 22/40 => Loss 0.371, Train_accy 89.70:  55%|█████▌    | 22/40 [04:16<03:30, 11.71s/it]
Task 0, Epoch 23/40 => Loss 0.374, Train_accy 89.54:  55%|█████▌    | 22/40 [04:27<03:30, 11.71s/it]
Task 0, Epoch 23/40 => Loss 0.374, Train_accy 89.54:  57%|█████▊    | 23/40 [04:27<03:16, 11.55s/it]
Task 0, Epoch 24/40 => Loss 0.394, Train_accy 89.42:  57%|█████▊    | 23/40 [04:39<03:16, 11.55s/it]
Task 0, Epoch 24/40 => Loss 0.394, Train_accy 89.42:  60%|██████    | 24/40 [04:39<03:04, 11.53s/it]
Task 0, Epoch 25/40 => Loss 0.357, Train_accy 89.89:  60%|██████    | 24/40 [04:50<03:04, 11.53s/it]
Task 0, Epoch 25/40 => Loss 0.357, Train_accy 89.89:  62%|██████▎   | 25/40 [04:50<02:51, 11.42s/it]
Task 0, Epoch 26/40 => Loss 0.352, Train_accy 90.70, Test_accy 86.71:  62%|██████▎   | 25/40 [05:03<02:51, 11.42s/it]
Task 0, Epoch 26/40 => Loss 0.352, Train_accy 90.70, Test_accy 86.71:  65%|██████▌   | 26/40 [05:03<02:47, 11.93s/it]
Task 0, Epoch 27/40 => Loss 0.370, Train_accy 89.81:  65%|██████▌   | 26/40 [05:14<02:47, 11.93s/it]                 
Task 0, Epoch 27/40 => Loss 0.370, Train_accy 89.81:  68%|██████▊   | 27/40 [05:14<02:31, 11.67s/it]
Task 0, Epoch 28/40 => Loss 0.362, Train_accy 89.70:  68%|██████▊   | 27/40 [05:25<02:31, 11.67s/it]
Task 0, Epoch 28/40 => Loss 0.362, Train_accy 89.70:  70%|███████   | 28/40 [05:25<02:18, 11.53s/it]
Task 0, Epoch 29/40 => Loss 0.336, Train_accy 90.89:  70%|███████   | 28/40 [05:36<02:18, 11.53s/it]
Task 0, Epoch 29/40 => Loss 0.336, Train_accy 90.89:  72%|███████▎  | 29/40 [05:36<02:05, 11.43s/it]
Task 0, Epoch 30/40 => Loss 0.363, Train_accy 89.77:  72%|███████▎  | 29/40 [05:47<02:05, 11.43s/it]
Task 0, Epoch 30/40 => Loss 0.363, Train_accy 89.77:  75%|███████▌  | 30/40 [05:47<01:53, 11.34s/it]
Task 0, Epoch 31/40 => Loss 0.377, Train_accy 89.54, Test_accy 87.36:  75%|███████▌  | 30/40 [06:01<01:53, 11.34s/it]
Task 0, Epoch 31/40 => Loss 0.377, Train_accy 89.54, Test_accy 87.36:  78%|███████▊  | 31/40 [06:01<01:47, 11.92s/it]
Task 0, Epoch 32/40 => Loss 0.360, Train_accy 90.20:  78%|███████▊  | 31/40 [06:12<01:47, 11.92s/it]                 
Task 0, Epoch 32/40 => Loss 0.360, Train_accy 90.20:  80%|████████  | 32/40 [06:12<01:33, 11.70s/it]
Task 0, Epoch 33/40 => Loss 0.327, Train_accy 91.08:  80%|████████  | 32/40 [06:23<01:33, 11.70s/it]
Task 0, Epoch 33/40 => Loss 0.327, Train_accy 91.08:  82%|████████▎ | 33/40 [06:23<01:20, 11.55s/it]
Task 0, Epoch 34/40 => Loss 0.367, Train_accy 89.89:  82%|████████▎ | 33/40 [06:34<01:20, 11.55s/it]
Task 0, Epoch 34/40 => Loss 0.367, Train_accy 89.89:  85%|████████▌ | 34/40 [06:34<01:08, 11.42s/it]
Task 0, Epoch 35/40 => Loss 0.341, Train_accy 90.78:  85%|████████▌ | 34/40 [06:46<01:08, 11.42s/it]
Task 0, Epoch 35/40 => Loss 0.341, Train_accy 90.78:  88%|████████▊ | 35/40 [06:46<00:57, 11.43s/it]
Task 0, Epoch 36/40 => Loss 0.349, Train_accy 90.20, Test_accy 87.03:  88%|████████▊ | 35/40 [06:59<00:57, 11.43s/it]
Task 0, Epoch 36/40 => Loss 0.349, Train_accy 90.20, Test_accy 87.03:  90%|█████████ | 36/40 [06:59<00:47, 11.94s/it]
Task 0, Epoch 37/40 => Loss 0.350, Train_accy 90.35:  90%|█████████ | 36/40 [07:10<00:47, 11.94s/it]                 
Task 0, Epoch 37/40 => Loss 0.350, Train_accy 90.35:  92%|█████████▎| 37/40 [07:10<00:35, 11.70s/it]
Task 0, Epoch 38/40 => Loss 0.364, Train_accy 90.51:  92%|█████████▎| 37/40 [07:21<00:35, 11.70s/it]
Task 0, Epoch 38/40 => Loss 0.364, Train_accy 90.51:  95%|█████████▌| 38/40 [07:21<00:23, 11.53s/it]
Task 0, Epoch 39/40 => Loss 0.313, Train_accy 92.24:  95%|█████████▌| 38/40 [07:32<00:23, 11.53s/it]
Task 0, Epoch 39/40 => Loss 0.313, Train_accy 92.24:  98%|█████████▊| 39/40 [07:32<00:11, 11.44s/it]
Task 0, Epoch 40/40 => Loss 0.353, Train_accy 90.20:  98%|█████████▊| 39/40 [07:44<00:11, 11.44s/it]
Task 0, Epoch 40/40 => Loss 0.353, Train_accy 90.20: 100%|██████████| 40/40 [07:44<00:00, 11.37s/it]
Task 0, Epoch 40/40 => Loss 0.353, Train_accy 90.20: 100%|██████████| 40/40 [07:44<00:00, 11.60s/it]
2025-11-09 11:12:17,404 [sdfourier.py] => Task 0, Epoch 40/40 => Loss 0.353, Train_accy 90.20
2025-11-09 11:12:17,407 [trainer.py] => All params: 185779028
2025-11-09 11:12:17,408 [trainer.py] => Trainable params: 25940
/mnt/weitao/SD-Lora-CL-main/utils/toolkit.py:60: RuntimeWarning: invalid value encountered in scalar divide
  (y_pred[idxes] == y_true[idxes]).sum() * 100 / len(idxes), decimals=2
2025-11-09 11:12:19,388 [trainer.py] => No NME accuracy.
2025-11-09 11:12:19,388 [trainer.py] => CNN: {'total': np.float64(87.03), '00-19': np.float64(87.03), 'old': np.float64(87.03), 'new': np.float64(nan)}
2025-11-09 11:12:19,388 [trainer.py] => CNN top1 curve: [np.float64(87.03)]
2025-11-09 11:12:19,388 [trainer.py] => CNN top5 curve: [np.float64(95.46)]

Average Accuracy (CNN): 87.03
2025-11-09 11:12:19,388 [trainer.py] => Average Accuracy (CNN): 87.03 

task 1
2025-11-09 11:12:19,389 [sdfourier.py] => Learning on 20-40

总共重置了 12 个模块的qkv层权重

  0%|          | 0/40 [00:00<?, ?it/s]
Task 1, Epoch 1/40 => Loss 2.012, Train_accy 28.42, Test_accy 76.31:   0%|          | 0/40 [00:08<?, ?it/s]
Task 1, Epoch 1/40 => Loss 2.012, Train_accy 28.42, Test_accy 76.31:   2%|▎         | 1/40 [00:08<05:35,  8.61s/it]
Task 1, Epoch 2/40 => Loss 0.879, Train_accy 64.64:   2%|▎         | 1/40 [00:14<05:35,  8.61s/it]                 
Task 1, Epoch 2/40 => Loss 0.879, Train_accy 64.64:   5%|▌         | 2/40 [00:14<04:17,  6.78s/it]
Task 1, Epoch 3/40 => Loss 0.701, Train_accy 70.46:   5%|▌         | 2/40 [00:19<04:17,  6.78s/it]
Task 1, Epoch 3/40 => Loss 0.701, Train_accy 70.46:   8%|▊         | 3/40 [00:19<03:45,  6.09s/it]
Task 1, Epoch 4/40 => Loss 0.676, Train_accy 70.61:   8%|▊         | 3/40 [00:24<03:45,  6.09s/it]
Task 1, Epoch 4/40 => Loss 0.676, Train_accy 70.61:  10%|█         | 4/40 [00:24<03:28,  5.80s/it]
Task 1, Epoch 5/40 => Loss 0.588, Train_accy 72.60:  10%|█         | 4/40 [00:29<03:28,  5.80s/it]
Task 1, Epoch 5/40 => Loss 0.588, Train_accy 72.60:  12%|█▎        | 5/40 [00:29<03:16,  5.61s/it]
Task 1, Epoch 6/40 => Loss 0.602, Train_accy 73.69, Test_accy 80.73:  12%|█▎        | 5/40 [00:38<03:16,  5.61s/it]
Task 1, Epoch 6/40 => Loss 0.602, Train_accy 73.69, Test_accy 80.73:  15%|█▌        | 6/40 [00:38<03:45,  6.64s/it]
Task 1, Epoch 7/40 => Loss 0.547, Train_accy 74.32:  15%|█▌        | 6/40 [00:44<03:45,  6.64s/it]                 
Task 1, Epoch 7/40 => Loss 0.547, Train_accy 74.32:  18%|█▊        | 7/40 [00:44<03:26,  6.26s/it]
Task 1, Epoch 8/40 => Loss 0.545, Train_accy 75.98:  18%|█▊        | 7/40 [00:49<03:26,  6.26s/it]
Task 1, Epoch 8/40 => Loss 0.545, Train_accy 75.98:  20%|██        | 8/40 [00:49<03:10,  5.95s/it]
Task 1, Epoch 9/40 => Loss 0.517, Train_accy 76.46:  20%|██        | 8/40 [00:54<03:10,  5.95s/it]
Task 1, Epoch 9/40 => Loss 0.517, Train_accy 76.46:  22%|██▎       | 9/40 [00:54<02:57,  5.73s/it]
Task 1, Epoch 10/40 => Loss 0.476, Train_accy 77.48:  22%|██▎       | 9/40 [00:59<02:57,  5.73s/it]
Task 1, Epoch 10/40 => Loss 0.476, Train_accy 77.48:  25%|██▌       | 10/40 [00:59<02:47,  5.59s/it]
Task 1, Epoch 11/40 => Loss 0.454, Train_accy 77.85, Test_accy 81.19:  25%|██▌       | 10/40 [01:08<02:47,  5.59s/it]
Task 1, Epoch 11/40 => Loss 0.454, Train_accy 77.85, Test_accy 81.19:  28%|██▊       | 11/40 [01:08<03:11,  6.62s/it]
Task 1, Epoch 12/40 => Loss 0.467, Train_accy 78.90:  28%|██▊       | 11/40 [01:14<03:11,  6.62s/it]                 
Task 1, Epoch 12/40 => Loss 0.467, Train_accy 78.90:  30%|███       | 12/40 [01:14<02:54,  6.24s/it]
Task 1, Epoch 13/40 => Loss 0.458, Train_accy 78.72:  30%|███       | 12/40 [01:19<02:54,  6.24s/it]
Task 1, Epoch 13/40 => Loss 0.458, Train_accy 78.72:  32%|███▎      | 13/40 [01:19<02:42,  6.02s/it]
Task 1, Epoch 14/40 => Loss 0.436, Train_accy 80.03:  32%|███▎      | 13/40 [01:25<02:42,  6.02s/it]
Task 1, Epoch 14/40 => Loss 0.436, Train_accy 80.03:  35%|███▌      | 14/40 [01:25<02:31,  5.83s/it]
Task 1, Epoch 15/40 => Loss 0.434, Train_accy 79.95:  35%|███▌      | 14/40 [01:30<02:31,  5.83s/it]
Task 1, Epoch 15/40 => Loss 0.434, Train_accy 79.95:  38%|███▊      | 15/40 [01:30<02:22,  5.70s/it]
Task 1, Epoch 16/40 => Loss 0.421, Train_accy 80.63, Test_accy 80.96:  38%|███▊      | 15/40 [01:39<02:22,  5.70s/it]
Task 1, Epoch 16/40 => Loss 0.421, Train_accy 80.63, Test_accy 80.96:  40%|████      | 16/40 [01:39<02:37,  6.58s/it]
Task 1, Epoch 17/40 => Loss 0.420, Train_accy 80.14:  40%|████      | 16/40 [01:44<02:37,  6.58s/it]                 
Task 1, Epoch 17/40 => Loss 0.420, Train_accy 80.14:  42%|████▎     | 17/40 [01:44<02:24,  6.30s/it]
Task 1, Epoch 18/40 => Loss 0.382, Train_accy 81.34:  42%|████▎     | 17/40 [01:50<02:24,  6.30s/it]
Task 1, Epoch 18/40 => Loss 0.382, Train_accy 81.34:  45%|████▌     | 18/40 [01:50<02:12,  6.00s/it]
Task 1, Epoch 19/40 => Loss 0.395, Train_accy 79.65:  45%|████▌     | 18/40 [01:55<02:12,  6.00s/it]
Task 1, Epoch 19/40 => Loss 0.395, Train_accy 79.65:  48%|████▊     | 19/40 [01:55<02:02,  5.81s/it]
Task 1, Epoch 20/40 => Loss 0.396, Train_accy 81.64:  48%|████▊     | 19/40 [02:00<02:02,  5.81s/it]
Task 1, Epoch 20/40 => Loss 0.396, Train_accy 81.64:  50%|█████     | 20/40 [02:00<01:53,  5.67s/it]
Task 1, Epoch 21/40 => Loss 0.392, Train_accy 81.57, Test_accy 81.04:  50%|█████     | 20/40 [02:09<01:53,  5.67s/it]
Task 1, Epoch 21/40 => Loss 0.392, Train_accy 81.57, Test_accy 81.04:  52%|█████▎    | 21/40 [02:09<02:06,  6.63s/it]
Task 1, Epoch 22/40 => Loss 0.386, Train_accy 82.55:  52%|█████▎    | 21/40 [02:15<02:06,  6.63s/it]                 
Task 1, Epoch 22/40 => Loss 0.386, Train_accy 82.55:  55%|█████▌    | 22/40 [02:15<01:52,  6.24s/it]
Task 1, Epoch 23/40 => Loss 0.401, Train_accy 81.68:  55%|█████▌    | 22/40 [02:20<01:52,  6.24s/it]
Task 1, Epoch 23/40 => Loss 0.401, Train_accy 81.68:  57%|█████▊    | 23/40 [02:20<01:41,  5.96s/it]
Task 1, Epoch 24/40 => Loss 0.373, Train_accy 82.62:  57%|█████▊    | 23/40 [02:25<01:41,  5.96s/it]
Task 1, Epoch 24/40 => Loss 0.373, Train_accy 82.62:  60%|██████    | 24/40 [02:25<01:32,  5.78s/it]
Task 1, Epoch 25/40 => Loss 0.375, Train_accy 82.06:  60%|██████    | 24/40 [02:31<01:32,  5.78s/it]
Task 1, Epoch 25/40 => Loss 0.375, Train_accy 82.06:  62%|██████▎   | 25/40 [02:31<01:24,  5.64s/it]
Task 1, Epoch 26/40 => Loss 0.370, Train_accy 82.62, Test_accy 80.81:  62%|██████▎   | 25/40 [02:39<01:24,  5.64s/it]
Task 1, Epoch 26/40 => Loss 0.370, Train_accy 82.62, Test_accy 80.81:  65%|██████▌   | 26/40 [02:39<01:30,  6.48s/it]
Task 1, Epoch 27/40 => Loss 0.380, Train_accy 82.47:  65%|██████▌   | 26/40 [02:44<01:30,  6.48s/it]                 
Task 1, Epoch 27/40 => Loss 0.380, Train_accy 82.47:  68%|██████▊   | 27/40 [02:44<01:19,  6.14s/it]
Task 1, Epoch 28/40 => Loss 0.361, Train_accy 82.51:  68%|██████▊   | 27/40 [02:50<01:19,  6.14s/it]
Task 1, Epoch 28/40 => Loss 0.361, Train_accy 82.51:  70%|███████   | 28/40 [02:50<01:11,  5.98s/it]
Task 1, Epoch 29/40 => Loss 0.381, Train_accy 82.09:  70%|███████   | 28/40 [02:55<01:11,  5.98s/it]
Task 1, Epoch 29/40 => Loss 0.381, Train_accy 82.09:  72%|███████▎  | 29/40 [02:55<01:04,  5.82s/it]
Task 1, Epoch 30/40 => Loss 0.349, Train_accy 83.93:  72%|███████▎  | 29/40 [03:01<01:04,  5.82s/it]
Task 1, Epoch 30/40 => Loss 0.349, Train_accy 83.93:  75%|███████▌  | 30/40 [03:01<00:56,  5.69s/it]
Task 1, Epoch 31/40 => Loss 0.356, Train_accy 83.78, Test_accy 81.26:  75%|███████▌  | 30/40 [03:09<00:56,  5.69s/it]
Task 1, Epoch 31/40 => Loss 0.356, Train_accy 83.78, Test_accy 81.26:  78%|███████▊  | 31/40 [03:09<00:58,  6.52s/it]
Task 1, Epoch 32/40 => Loss 0.350, Train_accy 82.13:  78%|███████▊  | 31/40 [03:14<00:58,  6.52s/it]                 
Task 1, Epoch 32/40 => Loss 0.350, Train_accy 82.13:  80%|████████  | 32/40 [03:14<00:49,  6.15s/it]
Task 1, Epoch 33/40 => Loss 0.386, Train_accy 82.32:  80%|████████  | 32/40 [03:20<00:49,  6.15s/it]
Task 1, Epoch 33/40 => Loss 0.386, Train_accy 82.32:  82%|████████▎ | 33/40 [03:20<00:41,  5.90s/it]
Task 1, Epoch 34/40 => Loss 0.378, Train_accy 81.87:  82%|████████▎ | 33/40 [03:25<00:41,  5.90s/it]
Task 1, Epoch 34/40 => Loss 0.378, Train_accy 81.87:  85%|████████▌ | 34/40 [03:25<00:34,  5.75s/it]
Task 1, Epoch 35/40 => Loss 0.330, Train_accy 84.65:  85%|████████▌ | 34/40 [03:31<00:34,  5.75s/it]
Task 1, Epoch 35/40 => Loss 0.330, Train_accy 84.65:  88%|████████▊ | 35/40 [03:31<00:28,  5.64s/it]
Task 1, Epoch 36/40 => Loss 0.352, Train_accy 83.11, Test_accy 81.19:  88%|████████▊ | 35/40 [03:39<00:28,  5.64s/it]
Task 1, Epoch 36/40 => Loss 0.352, Train_accy 83.11, Test_accy 81.19:  90%|█████████ | 36/40 [03:39<00:26,  6.57s/it]
Task 1, Epoch 37/40 => Loss 0.355, Train_accy 83.30:  90%|█████████ | 36/40 [03:45<00:26,  6.57s/it]                 
Task 1, Epoch 37/40 => Loss 0.355, Train_accy 83.30:  92%|█████████▎| 37/40 [03:45<00:18,  6.29s/it]
Task 1, Epoch 38/40 => Loss 0.338, Train_accy 83.56:  92%|█████████▎| 37/40 [03:50<00:18,  6.29s/it]
Task 1, Epoch 38/40 => Loss 0.338, Train_accy 83.56:  95%|█████████▌| 38/40 [03:50<00:12,  6.05s/it]
Task 1, Epoch 39/40 => Loss 0.369, Train_accy 82.47:  95%|█████████▌| 38/40 [03:56<00:12,  6.05s/it]
Task 1, Epoch 39/40 => Loss 0.369, Train_accy 82.47:  98%|█████████▊| 39/40 [03:56<00:05,  5.86s/it]
Task 1, Epoch 40/40 => Loss 0.348, Train_accy 82.96:  98%|█████████▊| 39/40 [04:01<00:05,  5.86s/it]
Task 1, Epoch 40/40 => Loss 0.348, Train_accy 82.96: 100%|██████████| 40/40 [04:01<00:00,  5.72s/it]
Task 1, Epoch 40/40 => Loss 0.348, Train_accy 82.96: 100%|██████████| 40/40 [04:01<00:00,  6.04s/it]
2025-11-09 11:16:21,522 [sdfourier.py] => Task 1, Epoch 40/40 => Loss 0.348, Train_accy 82.96
2025-11-09 11:16:21,524 [trainer.py] => All params: 185805928
2025-11-09 11:16:21,525 [trainer.py] => Trainable params: 41320
2025-11-09 11:16:24,772 [trainer.py] => No NME accuracy.
2025-11-09 11:16:24,772 [trainer.py] => CNN: {'total': np.float64(81.26), '00-19': np.float64(80.55), '20-39': np.float64(81.9), 'old': np.float64(81.26), 'new': np.float64(nan)}
2025-11-09 11:16:24,772 [trainer.py] => CNN top1 curve: [np.float64(87.03), np.float64(81.26)]
2025-11-09 11:16:24,772 [trainer.py] => CNN top5 curve: [np.float64(95.46), np.float64(93.15)]

Average Accuracy (CNN): 84.14500000000001
2025-11-09 11:16:24,772 [trainer.py] => Average Accuracy (CNN): 84.14500000000001 

task 2
2025-11-09 11:16:24,773 [sdfourier.py] => Learning on 40-60

总共重置了 12 个模块的qkv层权重

  0%|          | 0/40 [00:00<?, ?it/s]
Task 2, Epoch 1/40 => Loss 1.973, Train_accy 22.23, Test_accy 74.69:   0%|          | 0/40 [00:09<?, ?it/s]
Task 2, Epoch 1/40 => Loss 1.973, Train_accy 22.23, Test_accy 74.69:   2%|▎         | 1/40 [00:09<06:09,  9.48s/it]
Task 2, Epoch 2/40 => Loss 0.759, Train_accy 63.45:   2%|▎         | 1/40 [00:14<06:09,  9.48s/it]                 
Task 2, Epoch 2/40 => Loss 0.759, Train_accy 63.45:   5%|▌         | 2/40 [00:14<04:27,  7.04s/it]
Task 2, Epoch 3/40 => Loss 0.599, Train_accy 68.07:   5%|▌         | 2/40 [00:20<04:27,  7.04s/it]
Task 2, Epoch 3/40 => Loss 0.599, Train_accy 68.07:   8%|▊         | 3/40 [00:20<03:50,  6.22s/it]
Task 2, Epoch 4/40 => Loss 0.596, Train_accy 69.29:   8%|▊         | 3/40 [00:25<03:50,  6.22s/it]
Task 2, Epoch 4/40 => Loss 0.596, Train_accy 69.29:  10%|█         | 4/40 [00:25<03:34,  5.95s/it]
Task 2, Epoch 5/40 => Loss 0.523, Train_accy 71.66:  10%|█         | 4/40 [00:30<03:34,  5.95s/it]
Task 2, Epoch 5/40 => Loss 0.523, Train_accy 71.66:  12%|█▎        | 5/40 [00:30<03:18,  5.68s/it]
Task 2, Epoch 6/40 => Loss 0.484, Train_accy 72.99, Test_accy 78.21:  12%|█▎        | 5/40 [00:40<03:18,  5.68s/it]
Task 2, Epoch 6/40 => Loss 0.484, Train_accy 72.99, Test_accy 78.21:  15%|█▌        | 6/40 [00:40<03:58,  7.02s/it]
Task 2, Epoch 7/40 => Loss 0.434, Train_accy 74.33:  15%|█▌        | 6/40 [00:45<03:58,  7.02s/it]                 
Task 2, Epoch 7/40 => Loss 0.434, Train_accy 74.33:  18%|█▊        | 7/40 [00:45<03:32,  6.43s/it]
Task 2, Epoch 8/40 => Loss 0.426, Train_accy 74.98:  18%|█▊        | 7/40 [00:50<03:32,  6.43s/it]
Task 2, Epoch 8/40 => Loss 0.426, Train_accy 74.98:  20%|██        | 8/40 [00:50<03:13,  6.05s/it]
Task 2, Epoch 9/40 => Loss 0.444, Train_accy 74.87:  20%|██        | 8/40 [00:56<03:13,  6.05s/it]
Task 2, Epoch 9/40 => Loss 0.444, Train_accy 74.87:  22%|██▎       | 9/40 [00:56<02:59,  5.79s/it]
Task 2, Epoch 10/40 => Loss 0.423, Train_accy 76.47:  22%|██▎       | 9/40 [01:01<02:59,  5.79s/it]
Task 2, Epoch 10/40 => Loss 0.423, Train_accy 76.47:  25%|██▌       | 10/40 [01:01<02:48,  5.61s/it]
Task 2, Epoch 11/40 => Loss 0.401, Train_accy 75.86, Test_accy 78.01:  25%|██▌       | 10/40 [01:10<02:48,  5.61s/it]
Task 2, Epoch 11/40 => Loss 0.401, Train_accy 75.86, Test_accy 78.01:  28%|██▊       | 11/40 [01:10<03:18,  6.83s/it]
Task 2, Epoch 12/40 => Loss 0.367, Train_accy 78.11:  28%|██▊       | 11/40 [01:16<03:18,  6.83s/it]                 
Task 2, Epoch 12/40 => Loss 0.367, Train_accy 78.11:  30%|███       | 12/40 [01:16<02:58,  6.36s/it]
Task 2, Epoch 13/40 => Loss 0.345, Train_accy 80.14:  30%|███       | 12/40 [01:21<02:58,  6.36s/it]
Task 2, Epoch 13/40 => Loss 0.345, Train_accy 80.14:  32%|███▎      | 13/40 [01:21<02:42,  6.02s/it]
Task 2, Epoch 14/40 => Loss 0.378, Train_accy 78.92:  32%|███▎      | 13/40 [01:26<02:42,  6.02s/it]
Task 2, Epoch 14/40 => Loss 0.378, Train_accy 78.92:  35%|███▌      | 14/40 [01:26<02:30,  5.80s/it]
Task 2, Epoch 15/40 => Loss 0.361, Train_accy 79.18:  35%|███▌      | 14/40 [01:31<02:30,  5.80s/it]
Task 2, Epoch 15/40 => Loss 0.361, Train_accy 79.18:  38%|███▊      | 15/40 [01:31<02:21,  5.65s/it]
Task 2, Epoch 16/40 => Loss 0.347, Train_accy 80.44, Test_accy 78.21:  38%|███▊      | 15/40 [01:41<02:21,  5.65s/it]
Task 2, Epoch 16/40 => Loss 0.347, Train_accy 80.44, Test_accy 78.21:  40%|████      | 16/40 [01:41<02:44,  6.85s/it]
Task 2, Epoch 17/40 => Loss 0.371, Train_accy 79.56:  40%|████      | 16/40 [01:47<02:44,  6.85s/it]                 
Task 2, Epoch 17/40 => Loss 0.371, Train_accy 79.56:  42%|████▎     | 17/40 [01:47<02:27,  6.43s/it]
Task 2, Epoch 18/40 => Loss 0.345, Train_accy 80.25:  42%|████▎     | 17/40 [01:52<02:27,  6.43s/it]
Task 2, Epoch 18/40 => Loss 0.345, Train_accy 80.25:  45%|████▌     | 18/40 [01:52<02:14,  6.10s/it]
Task 2, Epoch 19/40 => Loss 0.332, Train_accy 81.09:  45%|████▌     | 18/40 [01:57<02:14,  6.10s/it]
Task 2, Epoch 19/40 => Loss 0.332, Train_accy 81.09:  48%|████▊     | 19/40 [01:57<02:02,  5.85s/it]
Task 2, Epoch 20/40 => Loss 0.372, Train_accy 80.18:  48%|████▊     | 19/40 [02:02<02:02,  5.85s/it]
Task 2, Epoch 20/40 => Loss 0.372, Train_accy 80.18:  50%|█████     | 20/40 [02:02<01:52,  5.64s/it]
Task 2, Epoch 21/40 => Loss 0.334, Train_accy 79.83, Test_accy 78.16:  50%|█████     | 20/40 [02:12<01:52,  5.64s/it]
Task 2, Epoch 21/40 => Loss 0.334, Train_accy 79.83, Test_accy 78.16:  52%|█████▎    | 21/40 [02:12<02:09,  6.80s/it]
Task 2, Epoch 22/40 => Loss 0.341, Train_accy 81.93:  52%|█████▎    | 21/40 [02:17<02:09,  6.80s/it]                 
Task 2, Epoch 22/40 => Loss 0.341, Train_accy 81.93:  55%|█████▌    | 22/40 [02:17<01:54,  6.34s/it]
Task 2, Epoch 23/40 => Loss 0.373, Train_accy 79.11:  55%|█████▌    | 22/40 [02:22<01:54,  6.34s/it]
Task 2, Epoch 23/40 => Loss 0.373, Train_accy 79.11:  57%|█████▊    | 23/40 [02:22<01:42,  6.04s/it]
Task 2, Epoch 24/40 => Loss 0.299, Train_accy 82.47:  57%|█████▊    | 23/40 [02:28<01:42,  6.04s/it]
Task 2, Epoch 24/40 => Loss 0.299, Train_accy 82.47:  60%|██████    | 24/40 [02:28<01:33,  5.86s/it]
Task 2, Epoch 25/40 => Loss 0.330, Train_accy 81.28:  60%|██████    | 24/40 [02:33<01:33,  5.86s/it]
Task 2, Epoch 25/40 => Loss 0.330, Train_accy 81.28:  62%|██████▎   | 25/40 [02:33<01:25,  5.68s/it]
Task 2, Epoch 26/40 => Loss 0.302, Train_accy 82.20, Test_accy 78.27:  62%|██████▎   | 25/40 [02:43<01:25,  5.68s/it]
Task 2, Epoch 26/40 => Loss 0.302, Train_accy 82.20, Test_accy 78.27:  65%|██████▌   | 26/40 [02:43<01:35,  6.84s/it]
Task 2, Epoch 27/40 => Loss 0.366, Train_accy 80.75:  65%|██████▌   | 26/40 [02:48<01:35,  6.84s/it]                 
Task 2, Epoch 27/40 => Loss 0.366, Train_accy 80.75:  68%|██████▊   | 27/40 [02:48<01:22,  6.37s/it]
Task 2, Epoch 28/40 => Loss 0.312, Train_accy 82.47:  68%|██████▊   | 27/40 [02:53<01:22,  6.37s/it]
Task 2, Epoch 28/40 => Loss 0.312, Train_accy 82.47:  70%|███████   | 28/40 [02:53<01:12,  6.03s/it]
Task 2, Epoch 29/40 => Loss 0.298, Train_accy 81.82:  70%|███████   | 28/40 [02:58<01:12,  6.03s/it]
Task 2, Epoch 29/40 => Loss 0.298, Train_accy 81.82:  72%|███████▎  | 29/40 [02:58<01:03,  5.80s/it]
Task 2, Epoch 30/40 => Loss 0.309, Train_accy 82.35:  72%|███████▎  | 29/40 [03:04<01:03,  5.80s/it]
Task 2, Epoch 30/40 => Loss 0.309, Train_accy 82.35:  75%|███████▌  | 30/40 [03:04<00:56,  5.63s/it]
Task 2, Epoch 31/40 => Loss 0.315, Train_accy 81.51, Test_accy 78.21:  75%|███████▌  | 30/40 [03:13<00:56,  5.63s/it]
Task 2, Epoch 31/40 => Loss 0.315, Train_accy 81.51, Test_accy 78.21:  78%|███████▊  | 31/40 [03:13<01:01,  6.85s/it]
Task 2, Epoch 32/40 => Loss 0.333, Train_accy 82.09:  78%|███████▊  | 31/40 [03:19<01:01,  6.85s/it]                 
Task 2, Epoch 32/40 => Loss 0.333, Train_accy 82.09:  80%|████████  | 32/40 [03:19<00:50,  6.37s/it]
Task 2, Epoch 33/40 => Loss 0.308, Train_accy 81.86:  80%|████████  | 32/40 [03:24<00:50,  6.37s/it]
Task 2, Epoch 33/40 => Loss 0.308, Train_accy 81.86:  82%|████████▎ | 33/40 [03:24<00:42,  6.02s/it]
Task 2, Epoch 34/40 => Loss 0.297, Train_accy 82.35:  82%|████████▎ | 33/40 [03:29<00:42,  6.02s/it]
Task 2, Epoch 34/40 => Loss 0.297, Train_accy 82.35:  85%|████████▌ | 34/40 [03:29<00:34,  5.82s/it]
Task 2, Epoch 35/40 => Loss 0.312, Train_accy 82.62:  85%|████████▌ | 34/40 [03:34<00:34,  5.82s/it]
Task 2, Epoch 35/40 => Loss 0.312, Train_accy 82.62:  88%|████████▊ | 35/40 [03:34<00:28,  5.64s/it]
Task 2, Epoch 36/40 => Loss 0.307, Train_accy 81.78, Test_accy 78.11:  88%|████████▊ | 35/40 [03:44<00:28,  5.64s/it]
Task 2, Epoch 36/40 => Loss 0.307, Train_accy 81.78, Test_accy 78.11:  90%|█████████ | 36/40 [03:44<00:27,  6.82s/it]
Task 2, Epoch 37/40 => Loss 0.299, Train_accy 82.54:  90%|█████████ | 36/40 [03:49<00:27,  6.82s/it]                 
Task 2, Epoch 37/40 => Loss 0.299, Train_accy 82.54:  92%|█████████▎| 37/40 [03:49<00:19,  6.37s/it]
Task 2, Epoch 38/40 => Loss 0.340, Train_accy 81.36:  92%|█████████▎| 37/40 [03:55<00:19,  6.37s/it]
Task 2, Epoch 38/40 => Loss 0.340, Train_accy 81.36:  95%|█████████▌| 38/40 [03:55<00:12,  6.05s/it]
Task 2, Epoch 39/40 => Loss 0.306, Train_accy 82.31:  95%|█████████▌| 38/40 [04:00<00:12,  6.05s/it]
Task 2, Epoch 39/40 => Loss 0.306, Train_accy 82.31:  98%|█████████▊| 39/40 [04:00<00:05,  5.80s/it]
Task 2, Epoch 40/40 => Loss 0.334, Train_accy 80.94:  98%|█████████▊| 39/40 [04:05<00:05,  5.80s/it]
Task 2, Epoch 40/40 => Loss 0.334, Train_accy 80.94: 100%|██████████| 40/40 [04:05<00:00,  5.63s/it]
Task 2, Epoch 40/40 => Loss 0.334, Train_accy 80.94: 100%|██████████| 40/40 [04:05<00:00,  6.14s/it]
2025-11-09 11:20:30,745 [sdfourier.py] => Task 2, Epoch 40/40 => Loss 0.334, Train_accy 80.94
2025-11-09 11:20:30,748 [trainer.py] => All params: 185833788
2025-11-09 11:20:30,749 [trainer.py] => Trainable params: 56700
2025-11-09 11:20:35,036 [trainer.py] => No NME accuracy.
2025-11-09 11:20:35,036 [trainer.py] => CNN: {'total': np.float64(78.06), '00-19': np.float64(76.5), '20-39': np.float64(78.45), '40-59': np.float64(79.13), 'old': np.float64(78.06), 'new': np.float64(nan)}
2025-11-09 11:20:35,036 [trainer.py] => CNN top1 curve: [np.float64(87.03), np.float64(81.26), np.float64(78.06)]
2025-11-09 11:20:35,036 [trainer.py] => CNN top5 curve: [np.float64(95.46), np.float64(93.15), np.float64(91.43)]

Average Accuracy (CNN): 82.11666666666667
2025-11-09 11:20:35,036 [trainer.py] => Average Accuracy (CNN): 82.11666666666667 

task 3
2025-11-09 11:20:35,037 [sdfourier.py] => Learning on 60-80

总共重置了 12 个模块的qkv层权重

  0%|          | 0/40 [00:00<?, ?it/s]
Task 3, Epoch 1/40 => Loss 2.120, Train_accy 15.25, Test_accy 69.89:   0%|          | 0/40 [00:10<?, ?it/s]
Task 3, Epoch 1/40 => Loss 2.120, Train_accy 15.25, Test_accy 69.89:   2%|▎         | 1/40 [00:10<06:59, 10.75s/it]
Task 3, Epoch 2/40 => Loss 0.855, Train_accy 52.66:   2%|▎         | 1/40 [00:16<06:59, 10.75s/it]                 
Task 3, Epoch 2/40 => Loss 0.855, Train_accy 52.66:   5%|▌         | 2/40 [00:16<04:46,  7.54s/it]
Task 3, Epoch 3/40 => Loss 0.719, Train_accy 59.90:   5%|▌         | 2/40 [00:21<04:46,  7.54s/it]
Task 3, Epoch 3/40 => Loss 0.719, Train_accy 59.90:   8%|▊         | 3/40 [00:21<04:07,  6.69s/it]
Task 3, Epoch 4/40 => Loss 0.620, Train_accy 61.77:   8%|▊         | 3/40 [00:27<04:07,  6.69s/it]
Task 3, Epoch 4/40 => Loss 0.620, Train_accy 61.77:  10%|█         | 4/40 [00:27<03:43,  6.20s/it]
Task 3, Epoch 5/40 => Loss 0.557, Train_accy 63.61:  10%|█         | 4/40 [00:32<03:43,  6.20s/it]
Task 3, Epoch 5/40 => Loss 0.557, Train_accy 63.61:  12%|█▎        | 5/40 [00:32<03:25,  5.88s/it]
Task 3, Epoch 6/40 => Loss 0.531, Train_accy 63.16, Test_accy 73.81:  12%|█▎        | 5/40 [00:43<03:25,  5.88s/it]
Task 3, Epoch 6/40 => Loss 0.531, Train_accy 63.16, Test_accy 73.81:  15%|█▌        | 6/40 [00:43<04:16,  7.55s/it]
Task 3, Epoch 7/40 => Loss 0.520, Train_accy 65.52:  15%|█▌        | 6/40 [00:48<04:16,  7.55s/it]                 
Task 3, Epoch 7/40 => Loss 0.520, Train_accy 65.52:  18%|█▊        | 7/40 [00:48<03:47,  6.91s/it]
Task 3, Epoch 8/40 => Loss 0.480, Train_accy 66.42:  18%|█▊        | 7/40 [00:54<03:47,  6.91s/it]
Task 3, Epoch 8/40 => Loss 0.480, Train_accy 66.42:  20%|██        | 8/40 [00:54<03:24,  6.40s/it]
Task 3, Epoch 9/40 => Loss 0.485, Train_accy 66.94:  20%|██        | 8/40 [00:59<03:24,  6.40s/it]
Task 3, Epoch 9/40 => Loss 0.485, Train_accy 66.94:  22%|██▎       | 9/40 [00:59<03:08,  6.07s/it]
Task 3, Epoch 10/40 => Loss 0.450, Train_accy 67.73:  22%|██▎       | 9/40 [01:05<03:08,  6.07s/it]
Task 3, Epoch 10/40 => Loss 0.450, Train_accy 67.73:  25%|██▌       | 10/40 [01:05<02:56,  5.89s/it]
Task 3, Epoch 11/40 => Loss 0.425, Train_accy 67.69, Test_accy 74.08:  25%|██▌       | 10/40 [01:15<02:56,  5.89s/it]
Task 3, Epoch 11/40 => Loss 0.425, Train_accy 67.69, Test_accy 74.08:  28%|██▊       | 11/40 [01:15<03:35,  7.42s/it]
Task 3, Epoch 12/40 => Loss 0.441, Train_accy 69.49:  28%|██▊       | 11/40 [01:21<03:35,  7.42s/it]                 
Task 3, Epoch 12/40 => Loss 0.441, Train_accy 69.49:  30%|███       | 12/40 [01:21<03:10,  6.82s/it]
Task 3, Epoch 13/40 => Loss 0.396, Train_accy 71.89:  30%|███       | 12/40 [01:26<03:10,  6.82s/it]
Task 3, Epoch 13/40 => Loss 0.396, Train_accy 71.89:  32%|███▎      | 13/40 [01:26<02:52,  6.40s/it]
Task 3, Epoch 14/40 => Loss 0.436, Train_accy 69.98:  32%|███▎      | 13/40 [01:32<02:52,  6.40s/it]
Task 3, Epoch 14/40 => Loss 0.436, Train_accy 69.98:  35%|███▌      | 14/40 [01:32<02:38,  6.09s/it]
Task 3, Epoch 15/40 => Loss 0.379, Train_accy 72.00:  35%|███▌      | 14/40 [01:37<02:38,  6.09s/it]
Task 3, Epoch 15/40 => Loss 0.379, Train_accy 72.00:  38%|███▊      | 15/40 [01:37<02:26,  5.87s/it]
Task 3, Epoch 16/40 => Loss 0.403, Train_accy 71.59, Test_accy 74.61:  38%|███▊      | 15/40 [01:48<02:26,  5.87s/it]
Task 3, Epoch 16/40 => Loss 0.403, Train_accy 71.59, Test_accy 74.61:  40%|████      | 16/40 [01:48<02:56,  7.36s/it]
Task 3, Epoch 17/40 => Loss 0.403, Train_accy 71.59:  40%|████      | 16/40 [01:53<02:56,  7.36s/it]                 
Task 3, Epoch 17/40 => Loss 0.403, Train_accy 71.59:  42%|████▎     | 17/40 [01:53<02:35,  6.77s/it]
Task 3, Epoch 18/40 => Loss 0.373, Train_accy 72.04:  42%|████▎     | 17/40 [01:59<02:35,  6.77s/it]
Task 3, Epoch 18/40 => Loss 0.373, Train_accy 72.04:  45%|████▌     | 18/40 [01:59<02:19,  6.35s/it]
Task 3, Epoch 19/40 => Loss 0.391, Train_accy 71.96:  45%|████▌     | 18/40 [02:04<02:19,  6.35s/it]
Task 3, Epoch 19/40 => Loss 0.391, Train_accy 71.96:  48%|████▊     | 19/40 [02:04<02:06,  6.04s/it]
Task 3, Epoch 20/40 => Loss 0.382, Train_accy 72.41:  48%|████▊     | 19/40 [02:09<02:06,  6.04s/it]
Task 3, Epoch 20/40 => Loss 0.382, Train_accy 72.41:  50%|█████     | 20/40 [02:09<01:56,  5.84s/it]
Task 3, Epoch 21/40 => Loss 0.368, Train_accy 71.70, Test_accy 74.76:  50%|█████     | 20/40 [02:20<01:56,  5.84s/it]
Task 3, Epoch 21/40 => Loss 0.368, Train_accy 71.70, Test_accy 74.76:  52%|█████▎    | 21/40 [02:20<02:18,  7.31s/it]
Task 3, Epoch 22/40 => Loss 0.391, Train_accy 72.34:  52%|█████▎    | 21/40 [02:25<02:18,  7.31s/it]                 
Task 3, Epoch 22/40 => Loss 0.391, Train_accy 72.34:  55%|█████▌    | 22/40 [02:25<02:01,  6.76s/it]
Task 3, Epoch 23/40 => Loss 0.365, Train_accy 73.24:  55%|█████▌    | 22/40 [02:31<02:01,  6.76s/it]
Task 3, Epoch 23/40 => Loss 0.365, Train_accy 73.24:  57%|█████▊    | 23/40 [02:31<01:47,  6.32s/it]
Task 3, Epoch 24/40 => Loss 0.378, Train_accy 73.09:  57%|█████▊    | 23/40 [02:36<01:47,  6.32s/it]
Task 3, Epoch 24/40 => Loss 0.378, Train_accy 73.09:  60%|██████    | 24/40 [02:36<01:36,  6.02s/it]
Task 3, Epoch 25/40 => Loss 0.352, Train_accy 74.14:  60%|██████    | 24/40 [02:41<01:36,  6.02s/it]
Task 3, Epoch 25/40 => Loss 0.352, Train_accy 74.14:  62%|██████▎   | 25/40 [02:41<01:27,  5.82s/it]
Task 3, Epoch 26/40 => Loss 0.365, Train_accy 73.13, Test_accy 74.53:  62%|██████▎   | 25/40 [02:52<01:27,  5.82s/it]
Task 3, Epoch 26/40 => Loss 0.365, Train_accy 73.13, Test_accy 74.53:  65%|██████▌   | 26/40 [02:52<01:42,  7.31s/it]
Task 3, Epoch 27/40 => Loss 0.360, Train_accy 73.69:  65%|██████▌   | 26/40 [02:58<01:42,  7.31s/it]                 
Task 3, Epoch 27/40 => Loss 0.360, Train_accy 73.69:  68%|██████▊   | 27/40 [02:58<01:27,  6.75s/it]
Task 3, Epoch 28/40 => Loss 0.328, Train_accy 74.44:  68%|██████▊   | 27/40 [03:03<01:27,  6.75s/it]
Task 3, Epoch 28/40 => Loss 0.328, Train_accy 74.44:  70%|███████   | 28/40 [03:03<01:16,  6.34s/it]
Task 3, Epoch 29/40 => Loss 0.359, Train_accy 73.24:  70%|███████   | 28/40 [03:08<01:16,  6.34s/it]
Task 3, Epoch 29/40 => Loss 0.359, Train_accy 73.24:  72%|███████▎  | 29/40 [03:08<01:06,  6.04s/it]
Task 3, Epoch 30/40 => Loss 0.353, Train_accy 74.33:  72%|███████▎  | 29/40 [03:14<01:06,  6.04s/it]
Task 3, Epoch 30/40 => Loss 0.353, Train_accy 74.33:  75%|███████▌  | 30/40 [03:14<00:58,  5.89s/it]
Task 3, Epoch 31/40 => Loss 0.353, Train_accy 73.80, Test_accy 74.95:  75%|███████▌  | 30/40 [03:25<00:58,  5.89s/it]
Task 3, Epoch 31/40 => Loss 0.353, Train_accy 73.80, Test_accy 74.95:  78%|███████▊  | 31/40 [03:25<01:06,  7.42s/it]
Task 3, Epoch 32/40 => Loss 0.353, Train_accy 74.44:  78%|███████▊  | 31/40 [03:30<01:06,  7.42s/it]                 
Task 3, Epoch 32/40 => Loss 0.353, Train_accy 74.44:  80%|████████  | 32/40 [03:30<00:54,  6.80s/it]
Task 3, Epoch 33/40 => Loss 0.336, Train_accy 73.76:  80%|████████  | 32/40 [03:36<00:54,  6.80s/it]
Task 3, Epoch 33/40 => Loss 0.336, Train_accy 73.76:  82%|████████▎ | 33/40 [03:36<00:44,  6.37s/it]
Task 3, Epoch 34/40 => Loss 0.342, Train_accy 73.50:  82%|████████▎ | 33/40 [03:41<00:44,  6.37s/it]
Task 3, Epoch 34/40 => Loss 0.342, Train_accy 73.50:  85%|████████▌ | 34/40 [03:41<00:36,  6.12s/it]
Task 3, Epoch 35/40 => Loss 0.343, Train_accy 73.80:  85%|████████▌ | 34/40 [03:47<00:36,  6.12s/it]
Task 3, Epoch 35/40 => Loss 0.343, Train_accy 73.80:  88%|████████▊ | 35/40 [03:47<00:29,  5.89s/it]
Task 3, Epoch 36/40 => Loss 0.354, Train_accy 73.46, Test_accy 74.88:  88%|████████▊ | 35/40 [03:57<00:29,  5.89s/it]
Task 3, Epoch 36/40 => Loss 0.354, Train_accy 73.46, Test_accy 74.88:  90%|█████████ | 36/40 [03:57<00:29,  7.37s/it]
Task 3, Epoch 37/40 => Loss 0.343, Train_accy 73.84:  90%|█████████ | 36/40 [04:03<00:29,  7.37s/it]                 
Task 3, Epoch 37/40 => Loss 0.343, Train_accy 73.84:  92%|█████████▎| 37/40 [04:03<00:20,  6.74s/it]
Task 3, Epoch 38/40 => Loss 0.323, Train_accy 74.25:  92%|█████████▎| 37/40 [04:08<00:20,  6.74s/it]
Task 3, Epoch 38/40 => Loss 0.323, Train_accy 74.25:  95%|█████████▌| 38/40 [04:08<00:12,  6.36s/it]
Task 3, Epoch 39/40 => Loss 0.354, Train_accy 73.91:  95%|█████████▌| 38/40 [04:13<00:12,  6.36s/it]
Task 3, Epoch 39/40 => Loss 0.354, Train_accy 73.91:  98%|█████████▊| 39/40 [04:13<00:06,  6.04s/it]
Task 3, Epoch 40/40 => Loss 0.337, Train_accy 73.28:  98%|█████████▊| 39/40 [04:19<00:06,  6.04s/it]
Task 3, Epoch 40/40 => Loss 0.337, Train_accy 73.28: 100%|██████████| 40/40 [04:19<00:00,  5.84s/it]
Task 3, Epoch 40/40 => Loss 0.337, Train_accy 73.28: 100%|██████████| 40/40 [04:19<00:00,  6.48s/it]
2025-11-09 11:24:54,813 [sdfourier.py] => Task 3, Epoch 40/40 => Loss 0.337, Train_accy 73.28
2025-11-09 11:24:54,816 [trainer.py] => All params: 185862608
2025-11-09 11:24:54,817 [trainer.py] => Trainable params: 72080
2025-11-09 11:25:00,353 [trainer.py] => No NME accuracy.
2025-11-09 11:25:00,353 [trainer.py] => CNN: {'total': np.float64(74.88), '00-19': np.float64(75.04), '20-39': np.float64(76.58), '40-59': np.float64(77.43), '60-79': np.float64(70.46), 'old': np.float64(74.88), 'new': np.float64(nan)}
2025-11-09 11:25:00,353 [trainer.py] => CNN top1 curve: [np.float64(87.03), np.float64(81.26), np.float64(78.06), np.float64(74.88)]
2025-11-09 11:25:00,353 [trainer.py] => CNN top5 curve: [np.float64(95.46), np.float64(93.15), np.float64(91.43), np.float64(89.61)]

Average Accuracy (CNN): 80.3075
2025-11-09 11:25:00,353 [trainer.py] => Average Accuracy (CNN): 80.3075 

task 4
2025-11-09 11:25:00,355 [sdfourier.py] => Learning on 80-100

总共重置了 12 个模块的qkv层权重

  0%|          | 0/40 [00:00<?, ?it/s]
Task 4, Epoch 1/40 => Loss 2.456, Train_accy 7.85, Test_accy 70.27:   0%|          | 0/40 [00:09<?, ?it/s]
Task 4, Epoch 1/40 => Loss 2.456, Train_accy 7.85, Test_accy 70.27:   2%|▎         | 1/40 [00:09<06:21,  9.77s/it]
Task 4, Epoch 2/40 => Loss 0.842, Train_accy 45.16:   2%|▎         | 1/40 [00:13<06:21,  9.77s/it]                
Task 4, Epoch 2/40 => Loss 0.842, Train_accy 45.16:   5%|▌         | 2/40 [00:13<03:58,  6.27s/it]
Task 4, Epoch 3/40 => Loss 0.664, Train_accy 59.17:   5%|▌         | 2/40 [00:17<03:58,  6.27s/it]
Task 4, Epoch 3/40 => Loss 0.664, Train_accy 59.17:   8%|▊         | 3/40 [00:17<03:05,  5.00s/it]
Task 4, Epoch 4/40 => Loss 0.571, Train_accy 60.68:   8%|▊         | 3/40 [00:20<03:05,  5.00s/it]
Task 4, Epoch 4/40 => Loss 0.571, Train_accy 60.68:  10%|█         | 4/40 [00:20<02:38,  4.42s/it]
Task 4, Epoch 5/40 => Loss 0.512, Train_accy 64.07:  10%|█         | 4/40 [00:24<02:38,  4.42s/it]
Task 4, Epoch 5/40 => Loss 0.512, Train_accy 64.07:  12%|█▎        | 5/40 [00:24<02:23,  4.11s/it]
Task 4, Epoch 6/40 => Loss 0.520, Train_accy 63.25, Test_accy 73.01:  12%|█▎        | 5/40 [00:34<02:23,  4.11s/it]
Task 4, Epoch 6/40 => Loss 0.520, Train_accy 63.25, Test_accy 73.01:  15%|█▌        | 6/40 [00:34<03:26,  6.06s/it]
Task 4, Epoch 7/40 => Loss 0.442, Train_accy 64.26:  15%|█▌        | 6/40 [00:37<03:26,  6.06s/it]                 
Task 4, Epoch 7/40 => Loss 0.442, Train_accy 64.26:  18%|█▊        | 7/40 [00:37<02:52,  5.23s/it]
Task 4, Epoch 8/40 => Loss 0.483, Train_accy 63.44:  18%|█▊        | 7/40 [00:41<02:52,  5.23s/it]
Task 4, Epoch 8/40 => Loss 0.483, Train_accy 63.44:  20%|██        | 8/40 [00:41<02:30,  4.70s/it]
Task 4, Epoch 9/40 => Loss 0.401, Train_accy 66.52:  20%|██        | 8/40 [00:44<02:30,  4.70s/it]
Task 4, Epoch 9/40 => Loss 0.401, Train_accy 66.52:  22%|██▎       | 9/40 [00:44<02:14,  4.35s/it]
Task 4, Epoch 10/40 => Loss 0.407, Train_accy 69.72:  22%|██▎       | 9/40 [00:48<02:14,  4.35s/it]
Task 4, Epoch 10/40 => Loss 0.407, Train_accy 69.72:  25%|██▌       | 10/40 [00:48<02:03,  4.12s/it]
Task 4, Epoch 11/40 => Loss 0.450, Train_accy 67.09, Test_accy 73.27:  25%|██▌       | 10/40 [00:58<02:03,  4.12s/it]
Task 4, Epoch 11/40 => Loss 0.450, Train_accy 67.09, Test_accy 73.27:  28%|██▊       | 11/40 [00:58<02:50,  5.88s/it]
Task 4, Epoch 12/40 => Loss 0.375, Train_accy 67.46:  28%|██▊       | 11/40 [01:01<02:50,  5.88s/it]                 
Task 4, Epoch 12/40 => Loss 0.375, Train_accy 67.46:  30%|███       | 12/40 [01:01<02:23,  5.14s/it]
Task 4, Epoch 13/40 => Loss 0.390, Train_accy 67.71:  30%|███       | 12/40 [01:05<02:23,  5.14s/it]
Task 4, Epoch 13/40 => Loss 0.390, Train_accy 67.71:  32%|███▎      | 13/40 [01:05<02:05,  4.67s/it]
Task 4, Epoch 14/40 => Loss 0.340, Train_accy 70.10:  32%|███▎      | 13/40 [01:08<02:05,  4.67s/it]
Task 4, Epoch 14/40 => Loss 0.340, Train_accy 70.10:  35%|███▌      | 14/40 [01:08<01:53,  4.36s/it]
Task 4, Epoch 15/40 => Loss 0.347, Train_accy 70.54:  35%|███▌      | 14/40 [01:12<01:53,  4.36s/it]
Task 4, Epoch 15/40 => Loss 0.347, Train_accy 70.54:  38%|███▊      | 15/40 [01:12<01:46,  4.24s/it]
Task 4, Epoch 16/40 => Loss 0.312, Train_accy 70.16, Test_accy 73.21:  38%|███▊      | 15/40 [01:22<01:46,  4.24s/it]
Task 4, Epoch 16/40 => Loss 0.312, Train_accy 70.16, Test_accy 73.21:  40%|████      | 16/40 [01:22<02:21,  5.91s/it]
Task 4, Epoch 17/40 => Loss 0.358, Train_accy 70.54:  40%|████      | 16/40 [01:26<02:21,  5.91s/it]                 
Task 4, Epoch 17/40 => Loss 0.358, Train_accy 70.54:  42%|████▎     | 17/40 [01:26<02:00,  5.24s/it]
Task 4, Epoch 18/40 => Loss 0.297, Train_accy 72.30:  42%|████▎     | 17/40 [01:29<02:00,  5.24s/it]
Task 4, Epoch 18/40 => Loss 0.297, Train_accy 72.30:  45%|████▌     | 18/40 [01:29<01:44,  4.73s/it]
Task 4, Epoch 19/40 => Loss 0.303, Train_accy 70.60:  45%|████▌     | 18/40 [01:33<01:44,  4.73s/it]
Task 4, Epoch 19/40 => Loss 0.303, Train_accy 70.60:  48%|████▊     | 19/40 [01:33<01:31,  4.36s/it]
Task 4, Epoch 20/40 => Loss 0.273, Train_accy 72.61:  48%|████▊     | 19/40 [01:36<01:31,  4.36s/it]
Task 4, Epoch 20/40 => Loss 0.273, Train_accy 72.61:  50%|█████     | 20/40 [01:36<01:21,  4.10s/it]
Task 4, Epoch 21/40 => Loss 0.315, Train_accy 71.23, Test_accy 73.24:  50%|█████     | 20/40 [01:46<01:21,  4.10s/it]
Task 4, Epoch 21/40 => Loss 0.315, Train_accy 71.23, Test_accy 73.24:  52%|█████▎    | 21/40 [01:46<01:51,  5.88s/it]
Task 4, Epoch 22/40 => Loss 0.326, Train_accy 72.93:  52%|█████▎    | 21/40 [01:50<01:51,  5.88s/it]                 
Task 4, Epoch 22/40 => Loss 0.326, Train_accy 72.93:  55%|█████▌    | 22/40 [01:50<01:33,  5.19s/it]
Task 4, Epoch 23/40 => Loss 0.274, Train_accy 73.12:  55%|█████▌    | 22/40 [01:53<01:33,  5.19s/it]
Task 4, Epoch 23/40 => Loss 0.274, Train_accy 73.12:  57%|█████▊    | 23/40 [01:53<01:19,  4.69s/it]
Task 4, Epoch 24/40 => Loss 0.326, Train_accy 73.18:  57%|█████▊    | 23/40 [01:57<01:19,  4.69s/it]
Task 4, Epoch 24/40 => Loss 0.326, Train_accy 73.18:  60%|██████    | 24/40 [01:57<01:09,  4.36s/it]
Task 4, Epoch 25/40 => Loss 0.309, Train_accy 73.87:  60%|██████    | 24/40 [02:01<01:09,  4.36s/it]
Task 4, Epoch 25/40 => Loss 0.309, Train_accy 73.87:  62%|██████▎   | 25/40 [02:01<01:01,  4.12s/it]
Task 4, Epoch 26/40 => Loss 0.314, Train_accy 73.12, Test_accy 73.44:  62%|██████▎   | 25/40 [02:10<01:01,  4.12s/it]
Task 4, Epoch 26/40 => Loss 0.314, Train_accy 73.12, Test_accy 73.44:  65%|██████▌   | 26/40 [02:10<01:21,  5.79s/it]
Task 4, Epoch 27/40 => Loss 0.277, Train_accy 73.56:  65%|██████▌   | 26/40 [02:14<01:21,  5.79s/it]                 
Task 4, Epoch 27/40 => Loss 0.277, Train_accy 73.56:  68%|██████▊   | 27/40 [02:14<01:06,  5.10s/it]
Task 4, Epoch 28/40 => Loss 0.280, Train_accy 74.81:  68%|██████▊   | 27/40 [02:17<01:06,  5.10s/it]
Task 4, Epoch 28/40 => Loss 0.280, Train_accy 74.81:  70%|███████   | 28/40 [02:17<00:55,  4.64s/it]
Task 4, Epoch 29/40 => Loss 0.306, Train_accy 73.68:  70%|███████   | 28/40 [02:21<00:55,  4.64s/it]
Task 4, Epoch 29/40 => Loss 0.306, Train_accy 73.68:  72%|███████▎  | 29/40 [02:21<00:47,  4.30s/it]
Task 4, Epoch 30/40 => Loss 0.311, Train_accy 74.75:  72%|███████▎  | 29/40 [02:25<00:47,  4.30s/it]
Task 4, Epoch 30/40 => Loss 0.311, Train_accy 74.75:  75%|███████▌  | 30/40 [02:25<00:41,  4.15s/it]
Task 4, Epoch 31/40 => Loss 0.288, Train_accy 73.24, Test_accy 73.37:  75%|███████▌  | 30/40 [02:34<00:41,  4.15s/it]
Task 4, Epoch 31/40 => Loss 0.288, Train_accy 73.24, Test_accy 73.37:  78%|███████▊  | 31/40 [02:34<00:52,  5.86s/it]
Task 4, Epoch 32/40 => Loss 0.276, Train_accy 74.94:  78%|███████▊  | 31/40 [02:38<00:52,  5.86s/it]                 
Task 4, Epoch 32/40 => Loss 0.276, Train_accy 74.94:  80%|████████  | 32/40 [02:38<00:41,  5.15s/it]
Task 4, Epoch 33/40 => Loss 0.268, Train_accy 75.31:  80%|████████  | 32/40 [02:41<00:41,  5.15s/it]
Task 4, Epoch 33/40 => Loss 0.268, Train_accy 75.31:  82%|████████▎ | 33/40 [02:41<00:32,  4.66s/it]
Task 4, Epoch 34/40 => Loss 0.281, Train_accy 73.81:  82%|████████▎ | 33/40 [02:45<00:32,  4.66s/it]
Task 4, Epoch 34/40 => Loss 0.281, Train_accy 73.81:  85%|████████▌ | 34/40 [02:45<00:25,  4.31s/it]
Task 4, Epoch 35/40 => Loss 0.276, Train_accy 75.31:  85%|████████▌ | 34/40 [02:49<00:25,  4.31s/it]
Task 4, Epoch 35/40 => Loss 0.276, Train_accy 75.31:  88%|████████▊ | 35/40 [02:49<00:20,  4.12s/it]
Task 4, Epoch 36/40 => Loss 0.272, Train_accy 74.75, Test_accy 73.44:  88%|████████▊ | 35/40 [02:59<00:20,  4.12s/it]
Task 4, Epoch 36/40 => Loss 0.272, Train_accy 74.75, Test_accy 73.44:  90%|█████████ | 36/40 [02:59<00:23,  5.84s/it]
Task 4, Epoch 37/40 => Loss 0.273, Train_accy 73.56:  90%|█████████ | 36/40 [03:02<00:23,  5.84s/it]                 
Task 4, Epoch 37/40 => Loss 0.273, Train_accy 73.56:  92%|█████████▎| 37/40 [03:02<00:15,  5.23s/it]
Task 4, Epoch 38/40 => Loss 0.324, Train_accy 73.62:  92%|█████████▎| 37/40 [03:06<00:15,  5.23s/it]
Task 4, Epoch 38/40 => Loss 0.324, Train_accy 73.62:  95%|█████████▌| 38/40 [03:06<00:09,  4.72s/it]
Task 4, Epoch 39/40 => Loss 0.320, Train_accy 74.12:  95%|█████████▌| 38/40 [03:09<00:09,  4.72s/it]
Task 4, Epoch 39/40 => Loss 0.320, Train_accy 74.12:  98%|█████████▊| 39/40 [03:09<00:04,  4.36s/it]
Task 4, Epoch 40/40 => Loss 0.323, Train_accy 72.36:  98%|█████████▊| 39/40 [03:13<00:04,  4.36s/it]
Task 4, Epoch 40/40 => Loss 0.323, Train_accy 72.36: 100%|██████████| 40/40 [03:13<00:00,  4.12s/it]
Task 4, Epoch 40/40 => Loss 0.323, Train_accy 72.36: 100%|██████████| 40/40 [03:13<00:00,  4.84s/it]
2025-11-09 11:28:14,380 [sdfourier.py] => Task 4, Epoch 40/40 => Loss 0.323, Train_accy 72.36
2025-11-09 11:28:14,383 [trainer.py] => All params: 185892388
2025-11-09 11:28:14,384 [trainer.py] => Trainable params: 87460
2025-11-09 11:28:20,622 [trainer.py] => No NME accuracy.
2025-11-09 11:28:20,622 [trainer.py] => CNN: {'total': np.float64(73.41), '00-19': np.float64(74.07), '20-39': np.float64(75.86), '40-59': np.float64(76.66), '60-79': np.float64(69.27), '80-99': np.float64(69.75), 'old': np.float64(73.41), 'new': np.float64(nan)}
2025-11-09 11:28:20,622 [trainer.py] => CNN top1 curve: [np.float64(87.03), np.float64(81.26), np.float64(78.06), np.float64(74.88), np.float64(73.41)]
2025-11-09 11:28:20,622 [trainer.py] => CNN top5 curve: [np.float64(95.46), np.float64(93.15), np.float64(91.43), np.float64(89.61), np.float64(88.5)]

Average Accuracy (CNN): 78.928
2025-11-09 11:28:20,622 [trainer.py] => Average Accuracy (CNN): 78.928 

task 5
2025-11-09 11:28:20,624 [sdfourier.py] => Learning on 100-120

总共重置了 12 个模块的qkv层权重

  0%|          | 0/40 [00:00<?, ?it/s]
Task 5, Epoch 1/40 => Loss 1.909, Train_accy 16.84, Test_accy 69.21:   0%|          | 0/40 [00:12<?, ?it/s]
Task 5, Epoch 1/40 => Loss 1.909, Train_accy 16.84, Test_accy 69.21:   2%|▎         | 1/40 [00:12<08:10, 12.57s/it]
Task 5, Epoch 2/40 => Loss 0.809, Train_accy 52.01:   2%|▎         | 1/40 [00:17<08:10, 12.57s/it]                 
Task 5, Epoch 2/40 => Loss 0.809, Train_accy 52.01:   5%|▌         | 2/40 [00:17<05:13,  8.24s/it]
Task 5, Epoch 3/40 => Loss 0.674, Train_accy 57.97:   5%|▌         | 2/40 [00:22<05:13,  8.24s/it]
Task 5, Epoch 3/40 => Loss 0.674, Train_accy 57.97:   8%|▊         | 3/40 [00:22<04:13,  6.86s/it]
Task 5, Epoch 4/40 => Loss 0.631, Train_accy 60.41:   8%|▊         | 3/40 [00:28<04:13,  6.86s/it]
Task 5, Epoch 4/40 => Loss 0.631, Train_accy 60.41:  10%|█         | 4/40 [00:28<03:41,  6.15s/it]
Task 5, Epoch 5/40 => Loss 0.581, Train_accy 61.12:  10%|█         | 4/40 [00:33<03:41,  6.15s/it]
Task 5, Epoch 5/40 => Loss 0.581, Train_accy 61.12:  12%|█▎        | 5/40 [00:33<03:23,  5.83s/it]
Task 5, Epoch 6/40 => Loss 0.536, Train_accy 62.89, Test_accy 71.69:  12%|█▎        | 5/40 [00:45<03:23,  5.83s/it]
Task 5, Epoch 6/40 => Loss 0.536, Train_accy 62.89, Test_accy 71.69:  15%|█▌        | 6/40 [00:45<04:34,  8.08s/it]
Task 5, Epoch 7/40 => Loss 0.514, Train_accy 63.41:  15%|█▌        | 6/40 [00:50<04:34,  8.08s/it]                 
Task 5, Epoch 7/40 => Loss 0.514, Train_accy 63.41:  18%|█▊        | 7/40 [00:50<03:55,  7.13s/it]
Task 5, Epoch 8/40 => Loss 0.484, Train_accy 63.92:  18%|█▊        | 7/40 [00:56<03:55,  7.13s/it]
Task 5, Epoch 8/40 => Loss 0.484, Train_accy 63.92:  20%|██        | 8/40 [00:56<03:27,  6.48s/it]
Task 5, Epoch 9/40 => Loss 0.478, Train_accy 64.59:  20%|██        | 8/40 [01:01<03:27,  6.48s/it]
Task 5, Epoch 9/40 => Loss 0.478, Train_accy 64.59:  22%|██▎       | 9/40 [01:01<03:07,  6.06s/it]
Task 5, Epoch 10/40 => Loss 0.433, Train_accy 66.36:  22%|██▎       | 9/40 [01:06<03:07,  6.06s/it]
Task 5, Epoch 10/40 => Loss 0.433, Train_accy 66.36:  25%|██▌       | 10/40 [01:06<02:52,  5.76s/it]
Task 5, Epoch 11/40 => Loss 0.420, Train_accy 67.59, Test_accy 71.48:  25%|██▌       | 10/40 [01:18<02:52,  5.76s/it]
Task 5, Epoch 11/40 => Loss 0.420, Train_accy 67.59, Test_accy 71.48:  28%|██▊       | 11/40 [01:18<03:44,  7.76s/it]
Task 5, Epoch 12/40 => Loss 0.424, Train_accy 66.68:  28%|██▊       | 11/40 [01:23<03:44,  7.76s/it]                 
Task 5, Epoch 12/40 => Loss 0.424, Train_accy 66.68:  30%|███       | 12/40 [01:23<03:14,  6.95s/it]
Task 5, Epoch 13/40 => Loss 0.437, Train_accy 67.78:  30%|███       | 12/40 [01:28<03:14,  6.95s/it]
Task 5, Epoch 13/40 => Loss 0.437, Train_accy 67.78:  32%|███▎      | 13/40 [01:28<02:52,  6.40s/it]
Task 5, Epoch 14/40 => Loss 0.386, Train_accy 68.61:  32%|███▎      | 13/40 [01:33<02:52,  6.40s/it]
Task 5, Epoch 14/40 => Loss 0.386, Train_accy 68.61:  35%|███▌      | 14/40 [01:33<02:36,  6.02s/it]
Task 5, Epoch 15/40 => Loss 0.404, Train_accy 68.49:  35%|███▌      | 14/40 [01:38<02:36,  6.02s/it]
Task 5, Epoch 15/40 => Loss 0.404, Train_accy 68.49:  38%|███▊      | 15/40 [01:38<02:23,  5.73s/it]
Task 5, Epoch 16/40 => Loss 0.422, Train_accy 68.89, Test_accy 71.91:  38%|███▊      | 15/40 [01:51<02:23,  5.73s/it]
Task 5, Epoch 16/40 => Loss 0.422, Train_accy 68.89, Test_accy 71.91:  40%|████      | 16/40 [01:51<03:04,  7.71s/it]
Task 5, Epoch 17/40 => Loss 0.402, Train_accy 70.47:  40%|████      | 16/40 [01:56<03:04,  7.71s/it]                 
Task 5, Epoch 17/40 => Loss 0.402, Train_accy 70.47:  42%|████▎     | 17/40 [01:56<02:39,  6.93s/it]
Task 5, Epoch 18/40 => Loss 0.345, Train_accy 70.66:  42%|████▎     | 17/40 [02:01<02:39,  6.93s/it]
Task 5, Epoch 18/40 => Loss 0.345, Train_accy 70.66:  45%|████▌     | 18/40 [02:01<02:20,  6.39s/it]
Task 5, Epoch 19/40 => Loss 0.378, Train_accy 70.23:  45%|████▌     | 18/40 [02:06<02:20,  6.39s/it]
Task 5, Epoch 19/40 => Loss 0.378, Train_accy 70.23:  48%|████▊     | 19/40 [02:06<02:06,  6.01s/it]
Task 5, Epoch 20/40 => Loss 0.368, Train_accy 70.23:  48%|████▊     | 19/40 [02:12<02:06,  6.01s/it]
Task 5, Epoch 20/40 => Loss 0.368, Train_accy 70.23:  50%|█████     | 20/40 [02:12<01:56,  5.82s/it]
Task 5, Epoch 21/40 => Loss 0.362, Train_accy 71.02, Test_accy 71.78:  50%|█████     | 20/40 [02:24<01:56,  5.82s/it]
Task 5, Epoch 21/40 => Loss 0.362, Train_accy 71.02, Test_accy 71.78:  52%|█████▎    | 21/40 [02:24<02:27,  7.78s/it]
Task 5, Epoch 22/40 => Loss 0.353, Train_accy 72.20:  52%|█████▎    | 21/40 [02:29<02:27,  7.78s/it]                 
Task 5, Epoch 22/40 => Loss 0.353, Train_accy 72.20:  55%|█████▌    | 22/40 [02:29<02:05,  6.99s/it]
Task 5, Epoch 23/40 => Loss 0.351, Train_accy 72.28:  55%|█████▌    | 22/40 [02:34<02:05,  6.99s/it]
Task 5, Epoch 23/40 => Loss 0.351, Train_accy 72.28:  57%|█████▊    | 23/40 [02:34<01:49,  6.47s/it]
Task 5, Epoch 24/40 => Loss 0.336, Train_accy 72.87:  57%|█████▊    | 23/40 [02:39<01:49,  6.47s/it]
Task 5, Epoch 24/40 => Loss 0.336, Train_accy 72.87:  60%|██████    | 24/40 [02:39<01:36,  6.06s/it]
Task 5, Epoch 25/40 => Loss 0.352, Train_accy 71.02:  60%|██████    | 24/40 [02:44<01:36,  6.06s/it]
Task 5, Epoch 25/40 => Loss 0.352, Train_accy 71.02:  62%|██████▎   | 25/40 [02:44<01:26,  5.77s/it]
Task 5, Epoch 26/40 => Loss 0.323, Train_accy 72.16, Test_accy 71.75:  62%|██████▎   | 25/40 [02:57<01:26,  5.77s/it]
Task 5, Epoch 26/40 => Loss 0.323, Train_accy 72.16, Test_accy 71.75:  65%|██████▌   | 26/40 [02:57<01:48,  7.78s/it]
Task 5, Epoch 27/40 => Loss 0.332, Train_accy 70.54:  65%|██████▌   | 26/40 [03:02<01:48,  7.78s/it]                 
Task 5, Epoch 27/40 => Loss 0.332, Train_accy 70.54:  68%|██████▊   | 27/40 [03:02<01:30,  6.99s/it]
Task 5, Epoch 28/40 => Loss 0.350, Train_accy 70.58:  68%|██████▊   | 27/40 [03:07<01:30,  6.99s/it]
Task 5, Epoch 28/40 => Loss 0.350, Train_accy 70.58:  70%|███████   | 28/40 [03:07<01:17,  6.42s/it]
Task 5, Epoch 29/40 => Loss 0.331, Train_accy 72.48:  70%|███████   | 28/40 [03:12<01:17,  6.42s/it]
Task 5, Epoch 29/40 => Loss 0.331, Train_accy 72.48:  72%|███████▎  | 29/40 [03:12<01:06,  6.03s/it]
Task 5, Epoch 30/40 => Loss 0.360, Train_accy 71.06:  72%|███████▎  | 29/40 [03:17<01:06,  6.03s/it]
Task 5, Epoch 30/40 => Loss 0.360, Train_accy 71.06:  75%|███████▌  | 30/40 [03:17<00:57,  5.75s/it]
Task 5, Epoch 31/40 => Loss 0.356, Train_accy 71.96, Test_accy 71.86:  75%|███████▌  | 30/40 [03:30<00:57,  5.75s/it]
Task 5, Epoch 31/40 => Loss 0.356, Train_accy 71.96, Test_accy 71.86:  78%|███████▊  | 31/40 [03:30<01:10,  7.78s/it]
Task 5, Epoch 32/40 => Loss 0.342, Train_accy 72.12:  78%|███████▊  | 31/40 [03:35<01:10,  7.78s/it]                 
Task 5, Epoch 32/40 => Loss 0.342, Train_accy 72.12:  80%|████████  | 32/40 [03:35<00:55,  6.99s/it]
Task 5, Epoch 33/40 => Loss 0.348, Train_accy 72.63:  80%|████████  | 32/40 [03:40<00:55,  6.99s/it]
Task 5, Epoch 33/40 => Loss 0.348, Train_accy 72.63:  82%|████████▎ | 33/40 [03:40<00:44,  6.42s/it]
Task 5, Epoch 34/40 => Loss 0.334, Train_accy 73.07:  82%|████████▎ | 33/40 [03:45<00:44,  6.42s/it]
Task 5, Epoch 34/40 => Loss 0.334, Train_accy 73.07:  85%|████████▌ | 34/40 [03:45<00:36,  6.03s/it]
Task 5, Epoch 35/40 => Loss 0.338, Train_accy 71.96:  85%|████████▌ | 34/40 [03:50<00:36,  6.03s/it]
Task 5, Epoch 35/40 => Loss 0.338, Train_accy 71.96:  88%|████████▊ | 35/40 [03:50<00:28,  5.76s/it]
Task 5, Epoch 36/40 => Loss 0.340, Train_accy 71.92, Test_accy 71.78:  88%|████████▊ | 35/40 [04:03<00:28,  5.76s/it]
Task 5, Epoch 36/40 => Loss 0.340, Train_accy 71.92, Test_accy 71.78:  90%|█████████ | 36/40 [04:03<00:30,  7.73s/it]
Task 5, Epoch 37/40 => Loss 0.323, Train_accy 72.16:  90%|█████████ | 36/40 [04:08<00:30,  7.73s/it]                 
Task 5, Epoch 37/40 => Loss 0.323, Train_accy 72.16:  92%|█████████▎| 37/40 [04:08<00:20,  6.95s/it]
Task 5, Epoch 38/40 => Loss 0.352, Train_accy 72.08:  92%|█████████▎| 37/40 [04:13<00:20,  6.95s/it]
Task 5, Epoch 38/40 => Loss 0.352, Train_accy 72.08:  95%|█████████▌| 38/40 [04:13<00:12,  6.42s/it]
Task 5, Epoch 39/40 => Loss 0.320, Train_accy 72.95:  95%|█████████▌| 38/40 [04:18<00:12,  6.42s/it]
Task 5, Epoch 39/40 => Loss 0.320, Train_accy 72.95:  98%|█████████▊| 39/40 [04:18<00:06,  6.08s/it]
Task 5, Epoch 40/40 => Loss 0.334, Train_accy 73.15:  98%|█████████▊| 39/40 [04:23<00:06,  6.08s/it]
Task 5, Epoch 40/40 => Loss 0.334, Train_accy 73.15: 100%|██████████| 40/40 [04:23<00:00,  5.77s/it]
Task 5, Epoch 40/40 => Loss 0.334, Train_accy 73.15: 100%|██████████| 40/40 [04:23<00:00,  6.60s/it]
2025-11-09 11:32:45,227 [sdfourier.py] => Task 5, Epoch 40/40 => Loss 0.334, Train_accy 73.15
2025-11-09 11:32:45,230 [trainer.py] => All params: 185923128
2025-11-09 11:32:45,231 [trainer.py] => Trainable params: 102840
2025-11-09 11:32:52,458 [trainer.py] => No NME accuracy.
2025-11-09 11:32:52,459 [trainer.py] => CNN: {'total': np.float64(71.8), '00-19': np.float64(72.93), '20-39': np.float64(74.28), '40-59': np.float64(73.88), '60-79': np.float64(67.32), '80-99': np.float64(68.75), '100-119': np.float64(72.5), 'old': np.float64(71.8), 'new': np.float64(nan)}
2025-11-09 11:32:52,459 [trainer.py] => CNN top1 curve: [np.float64(87.03), np.float64(81.26), np.float64(78.06), np.float64(74.88), np.float64(73.41), np.float64(71.8)]
2025-11-09 11:32:52,459 [trainer.py] => CNN top5 curve: [np.float64(95.46), np.float64(93.15), np.float64(91.43), np.float64(89.61), np.float64(88.5), np.float64(87.37)]

Average Accuracy (CNN): 77.74
2025-11-09 11:32:52,459 [trainer.py] => Average Accuracy (CNN): 77.74 

task 6
2025-11-09 11:32:52,460 [sdfourier.py] => Learning on 120-140

总共重置了 12 个模块的qkv层权重

  0%|          | 0/40 [00:00<?, ?it/s]
Task 6, Epoch 1/40 => Loss 2.295, Train_accy 10.06, Test_accy 67.36:   0%|          | 0/40 [00:12<?, ?it/s]
Task 6, Epoch 1/40 => Loss 2.295, Train_accy 10.06, Test_accy 67.36:   2%|▎         | 1/40 [00:12<08:13, 12.66s/it]
Task 6, Epoch 2/40 => Loss 0.945, Train_accy 41.29:   2%|▎         | 1/40 [00:17<08:13, 12.66s/it]                 
Task 6, Epoch 2/40 => Loss 0.945, Train_accy 41.29:   5%|▌         | 2/40 [00:17<04:59,  7.89s/it]
Task 6, Epoch 3/40 => Loss 0.787, Train_accy 51.07:   5%|▌         | 2/40 [00:21<04:59,  7.89s/it]
Task 6, Epoch 3/40 => Loss 0.787, Train_accy 51.07:   8%|▊         | 3/40 [00:21<03:54,  6.35s/it]
Task 6, Epoch 4/40 => Loss 0.698, Train_accy 50.74:   8%|▊         | 3/40 [00:26<03:54,  6.35s/it]
Task 6, Epoch 4/40 => Loss 0.698, Train_accy 50.74:  10%|█         | 4/40 [00:26<03:22,  5.62s/it]
Task 6, Epoch 5/40 => Loss 0.636, Train_accy 53.21:  10%|█         | 4/40 [00:30<03:22,  5.62s/it]
Task 6, Epoch 5/40 => Loss 0.636, Train_accy 53.21:  12%|█▎        | 5/40 [00:30<03:02,  5.21s/it]
Task 6, Epoch 6/40 => Loss 0.620, Train_accy 54.75, Test_accy 69.58:  12%|█▎        | 5/40 [00:43<03:02,  5.21s/it]
Task 6, Epoch 6/40 => Loss 0.620, Train_accy 54.75, Test_accy 69.58:  15%|█▌        | 6/40 [00:43<04:21,  7.69s/it]
Task 6, Epoch 7/40 => Loss 0.637, Train_accy 53.54:  15%|█▌        | 6/40 [00:47<04:21,  7.69s/it]                 
Task 6, Epoch 7/40 => Loss 0.637, Train_accy 53.54:  18%|█▊        | 7/40 [00:47<03:39,  6.66s/it]
Task 6, Epoch 8/40 => Loss 0.544, Train_accy 56.15:  18%|█▊        | 7/40 [00:52<03:39,  6.66s/it]
Task 6, Epoch 8/40 => Loss 0.544, Train_accy 56.15:  20%|██        | 8/40 [00:52<03:11,  5.99s/it]
Task 6, Epoch 9/40 => Loss 0.500, Train_accy 56.56:  20%|██        | 8/40 [00:56<03:11,  5.99s/it]
Task 6, Epoch 9/40 => Loss 0.500, Train_accy 56.56:  22%|██▎       | 9/40 [00:56<02:50,  5.51s/it]
Task 6, Epoch 10/40 => Loss 0.498, Train_accy 57.68:  22%|██▎       | 9/40 [01:01<02:50,  5.51s/it]
Task 6, Epoch 10/40 => Loss 0.498, Train_accy 57.68:  25%|██▌       | 10/40 [01:01<02:35,  5.18s/it]
Task 6, Epoch 11/40 => Loss 0.498, Train_accy 59.59, Test_accy 69.66:  25%|██▌       | 10/40 [01:13<02:35,  5.18s/it]
Task 6, Epoch 11/40 => Loss 0.498, Train_accy 59.59, Test_accy 69.66:  28%|██▊       | 11/40 [01:13<03:37,  7.49s/it]
Task 6, Epoch 12/40 => Loss 0.484, Train_accy 59.45:  28%|██▊       | 11/40 [01:18<03:37,  7.49s/it]                 
Task 6, Epoch 12/40 => Loss 0.484, Train_accy 59.45:  30%|███       | 12/40 [01:18<03:04,  6.58s/it]
Task 6, Epoch 13/40 => Loss 0.504, Train_accy 60.24:  30%|███       | 12/40 [01:22<03:04,  6.58s/it]
Task 6, Epoch 13/40 => Loss 0.504, Train_accy 60.24:  32%|███▎      | 13/40 [01:22<02:39,  5.93s/it]
Task 6, Epoch 14/40 => Loss 0.480, Train_accy 59.64:  32%|███▎      | 13/40 [01:27<02:39,  5.93s/it]
Task 6, Epoch 14/40 => Loss 0.480, Train_accy 59.64:  35%|███▌      | 14/40 [01:27<02:23,  5.51s/it]
Task 6, Epoch 15/40 => Loss 0.462, Train_accy 61.36:  35%|███▌      | 14/40 [01:31<02:23,  5.51s/it]
Task 6, Epoch 15/40 => Loss 0.462, Train_accy 61.36:  38%|███▊      | 15/40 [01:31<02:09,  5.18s/it]
Task 6, Epoch 16/40 => Loss 0.436, Train_accy 62.90, Test_accy 69.70:  38%|███▊      | 15/40 [01:44<02:09,  5.18s/it]
Task 6, Epoch 16/40 => Loss 0.436, Train_accy 62.90, Test_accy 69.70:  40%|████      | 16/40 [01:44<02:58,  7.42s/it]
Task 6, Epoch 17/40 => Loss 0.423, Train_accy 62.57:  40%|████      | 16/40 [01:48<02:58,  7.42s/it]                 
Task 6, Epoch 17/40 => Loss 0.423, Train_accy 62.57:  42%|████▎     | 17/40 [01:48<02:30,  6.56s/it]
Task 6, Epoch 18/40 => Loss 0.416, Train_accy 60.89:  42%|████▎     | 17/40 [01:53<02:30,  6.56s/it]
Task 6, Epoch 18/40 => Loss 0.416, Train_accy 60.89:  45%|████▌     | 18/40 [01:53<02:10,  5.92s/it]
Task 6, Epoch 19/40 => Loss 0.440, Train_accy 62.10:  45%|████▌     | 18/40 [01:57<02:10,  5.92s/it]
Task 6, Epoch 19/40 => Loss 0.440, Train_accy 62.10:  48%|████▊     | 19/40 [01:57<01:55,  5.49s/it]
Task 6, Epoch 20/40 => Loss 0.439, Train_accy 62.94:  48%|████▊     | 19/40 [02:02<01:55,  5.49s/it]
Task 6, Epoch 20/40 => Loss 0.439, Train_accy 62.94:  50%|█████     | 20/40 [02:02<01:44,  5.24s/it]
Task 6, Epoch 21/40 => Loss 0.403, Train_accy 64.06, Test_accy 69.80:  50%|█████     | 20/40 [02:15<01:44,  5.24s/it]
Task 6, Epoch 21/40 => Loss 0.403, Train_accy 64.06, Test_accy 69.80:  52%|█████▎    | 21/40 [02:15<02:21,  7.46s/it]
Task 6, Epoch 22/40 => Loss 0.421, Train_accy 62.76:  52%|█████▎    | 21/40 [02:19<02:21,  7.46s/it]                 
Task 6, Epoch 22/40 => Loss 0.421, Train_accy 62.76:  55%|█████▌    | 22/40 [02:19<01:57,  6.55s/it]
Task 6, Epoch 23/40 => Loss 0.410, Train_accy 63.22:  55%|█████▌    | 22/40 [02:24<01:57,  6.55s/it]
Task 6, Epoch 23/40 => Loss 0.410, Train_accy 63.22:  57%|█████▊    | 23/40 [02:24<01:40,  5.94s/it]
Task 6, Epoch 24/40 => Loss 0.396, Train_accy 64.25:  57%|█████▊    | 23/40 [02:28<01:40,  5.94s/it]
Task 6, Epoch 24/40 => Loss 0.396, Train_accy 64.25:  60%|██████    | 24/40 [02:28<01:27,  5.49s/it]
Task 6, Epoch 25/40 => Loss 0.389, Train_accy 63.41:  60%|██████    | 24/40 [02:33<01:27,  5.49s/it]
Task 6, Epoch 25/40 => Loss 0.389, Train_accy 63.41:  62%|██████▎   | 25/40 [02:33<01:17,  5.17s/it]
Task 6, Epoch 26/40 => Loss 0.396, Train_accy 64.20, Test_accy 69.89:  62%|██████▎   | 25/40 [02:45<01:17,  5.17s/it]
Task 6, Epoch 26/40 => Loss 0.396, Train_accy 64.20, Test_accy 69.89:  65%|██████▌   | 26/40 [02:45<01:43,  7.42s/it]
Task 6, Epoch 27/40 => Loss 0.402, Train_accy 63.73:  65%|██████▌   | 26/40 [02:50<01:43,  7.42s/it]                 
Task 6, Epoch 27/40 => Loss 0.402, Train_accy 63.73:  68%|██████▊   | 27/40 [02:50<01:24,  6.53s/it]
Task 6, Epoch 28/40 => Loss 0.380, Train_accy 64.11:  68%|██████▊   | 27/40 [02:54<01:24,  6.53s/it]
Task 6, Epoch 28/40 => Loss 0.380, Train_accy 64.11:  70%|███████   | 28/40 [02:54<01:10,  5.90s/it]
Task 6, Epoch 29/40 => Loss 0.392, Train_accy 65.22:  70%|███████   | 28/40 [02:59<01:10,  5.90s/it]
Task 6, Epoch 29/40 => Loss 0.392, Train_accy 65.22:  72%|███████▎  | 29/40 [02:59<01:00,  5.47s/it]
Task 6, Epoch 30/40 => Loss 0.370, Train_accy 64.39:  72%|███████▎  | 29/40 [03:03<01:00,  5.47s/it]
Task 6, Epoch 30/40 => Loss 0.370, Train_accy 64.39:  75%|███████▌  | 30/40 [03:03<00:51,  5.16s/it]
Task 6, Epoch 31/40 => Loss 0.392, Train_accy 66.67, Test_accy 69.92:  75%|███████▌  | 30/40 [03:16<00:51,  5.16s/it]
Task 6, Epoch 31/40 => Loss 0.392, Train_accy 66.67, Test_accy 69.92:  78%|███████▊  | 31/40 [03:16<01:06,  7.40s/it]
Task 6, Epoch 32/40 => Loss 0.382, Train_accy 65.78:  78%|███████▊  | 31/40 [03:20<01:06,  7.40s/it]                 
Task 6, Epoch 32/40 => Loss 0.382, Train_accy 65.78:  80%|████████  | 32/40 [03:20<00:52,  6.55s/it]
Task 6, Epoch 33/40 => Loss 0.373, Train_accy 65.32:  80%|████████  | 32/40 [03:25<00:52,  6.55s/it]
Task 6, Epoch 33/40 => Loss 0.373, Train_accy 65.32:  82%|████████▎ | 33/40 [03:25<00:41,  5.92s/it]
Task 6, Epoch 34/40 => Loss 0.370, Train_accy 64.53:  82%|████████▎ | 33/40 [03:29<00:41,  5.92s/it]
Task 6, Epoch 34/40 => Loss 0.370, Train_accy 64.53:  85%|████████▌ | 34/40 [03:29<00:33,  5.55s/it]
Task 6, Epoch 35/40 => Loss 0.349, Train_accy 66.25:  85%|████████▌ | 34/40 [03:34<00:33,  5.55s/it]
Task 6, Epoch 35/40 => Loss 0.349, Train_accy 66.25:  88%|████████▊ | 35/40 [03:34<00:26,  5.26s/it]
Task 6, Epoch 36/40 => Loss 0.356, Train_accy 64.76, Test_accy 69.89:  88%|████████▊ | 35/40 [03:46<00:26,  5.26s/it]
Task 6, Epoch 36/40 => Loss 0.356, Train_accy 64.76, Test_accy 69.89:  90%|█████████ | 36/40 [03:46<00:29,  7.44s/it]
Task 6, Epoch 37/40 => Loss 0.366, Train_accy 67.46:  90%|█████████ | 36/40 [03:51<00:29,  7.44s/it]                 
Task 6, Epoch 37/40 => Loss 0.366, Train_accy 67.46:  92%|█████████▎| 37/40 [03:51<00:19,  6.54s/it]
Task 6, Epoch 38/40 => Loss 0.356, Train_accy 65.88:  92%|█████████▎| 37/40 [03:55<00:19,  6.54s/it]
Task 6, Epoch 38/40 => Loss 0.356, Train_accy 65.88:  95%|█████████▌| 38/40 [03:55<00:11,  5.95s/it]
Task 6, Epoch 39/40 => Loss 0.378, Train_accy 65.18:  95%|█████████▌| 38/40 [04:00<00:11,  5.95s/it]
Task 6, Epoch 39/40 => Loss 0.378, Train_accy 65.18:  98%|█████████▊| 39/40 [04:00<00:05,  5.49s/it]
Task 6, Epoch 40/40 => Loss 0.400, Train_accy 65.69:  98%|█████████▊| 39/40 [04:04<00:05,  5.49s/it]
Task 6, Epoch 40/40 => Loss 0.400, Train_accy 65.69: 100%|██████████| 40/40 [04:04<00:00,  5.23s/it]
Task 6, Epoch 40/40 => Loss 0.400, Train_accy 65.69: 100%|██████████| 40/40 [04:04<00:00,  6.12s/it]
2025-11-09 11:36:58,279 [sdfourier.py] => Task 6, Epoch 40/40 => Loss 0.400, Train_accy 65.69
2025-11-09 11:36:58,282 [trainer.py] => All params: 185954828
2025-11-09 11:36:58,284 [trainer.py] => Trainable params: 118220
2025-11-09 11:37:06,403 [trainer.py] => No NME accuracy.
2025-11-09 11:37:06,403 [trainer.py] => CNN: {'total': np.float64(69.87), '00-19': np.float64(72.45), '20-39': np.float64(72.56), '40-59': np.float64(73.42), '60-79': np.float64(66.12), '80-99': np.float64(67.75), '100-119': np.float64(71.56), '120-139': np.float64(63.11), 'old': np.float64(69.87), 'new': np.float64(nan)}
2025-11-09 11:37:06,403 [trainer.py] => CNN top1 curve: [np.float64(87.03), np.float64(81.26), np.float64(78.06), np.float64(74.88), np.float64(73.41), np.float64(71.8), np.float64(69.87)]
2025-11-09 11:37:06,403 [trainer.py] => CNN top5 curve: [np.float64(95.46), np.float64(93.15), np.float64(91.43), np.float64(89.61), np.float64(88.5), np.float64(87.37), np.float64(85.84)]

Average Accuracy (CNN): 76.61571428571428
2025-11-09 11:37:06,403 [trainer.py] => Average Accuracy (CNN): 76.61571428571428 

task 7
2025-11-09 11:37:06,405 [sdfourier.py] => Learning on 140-160

总共重置了 12 个模块的qkv层权重

  0%|          | 0/40 [00:00<?, ?it/s]
Task 7, Epoch 1/40 => Loss 2.044, Train_accy 10.21, Test_accy 67.14:   0%|          | 0/40 [00:13<?, ?it/s]
Task 7, Epoch 1/40 => Loss 2.044, Train_accy 10.21, Test_accy 67.14:   2%|▎         | 1/40 [00:13<08:44, 13.46s/it]
Task 7, Epoch 2/40 => Loss 0.804, Train_accy 50.33:   2%|▎         | 1/40 [00:18<08:44, 13.46s/it]                 
Task 7, Epoch 2/40 => Loss 0.804, Train_accy 50.33:   5%|▌         | 2/40 [00:18<05:13,  8.25s/it]
Task 7, Epoch 3/40 => Loss 0.605, Train_accy 59.79:   5%|▌         | 2/40 [00:22<05:13,  8.25s/it]
Task 7, Epoch 3/40 => Loss 0.605, Train_accy 59.79:   8%|▊         | 3/40 [00:22<04:02,  6.54s/it]
Task 7, Epoch 4/40 => Loss 0.558, Train_accy 62.07:   8%|▊         | 3/40 [00:27<04:02,  6.54s/it]
Task 7, Epoch 4/40 => Loss 0.558, Train_accy 62.07:  10%|█         | 4/40 [00:27<03:27,  5.77s/it]
Task 7, Epoch 5/40 => Loss 0.500, Train_accy 62.44:  10%|█         | 4/40 [00:31<03:27,  5.77s/it]
Task 7, Epoch 5/40 => Loss 0.500, Train_accy 62.44:  12%|█▎        | 5/40 [00:31<03:06,  5.33s/it]
Task 7, Epoch 6/40 => Loss 0.467, Train_accy 63.47, Test_accy 69.58:  12%|█▎        | 5/40 [00:45<03:06,  5.33s/it]
Task 7, Epoch 6/40 => Loss 0.467, Train_accy 63.47, Test_accy 69.58:  15%|█▌        | 6/40 [00:45<04:36,  8.13s/it]
Task 7, Epoch 7/40 => Loss 0.447, Train_accy 64.59:  15%|█▌        | 6/40 [00:49<04:36,  8.13s/it]                 
Task 7, Epoch 7/40 => Loss 0.447, Train_accy 64.59:  18%|█▊        | 7/40 [00:49<03:50,  6.98s/it]
Task 7, Epoch 8/40 => Loss 0.440, Train_accy 65.42:  18%|█▊        | 7/40 [00:54<03:50,  6.98s/it]
Task 7, Epoch 8/40 => Loss 0.440, Train_accy 65.42:  20%|██        | 8/40 [00:54<03:18,  6.19s/it]
Task 7, Epoch 9/40 => Loss 0.424, Train_accy 64.77:  20%|██        | 8/40 [00:58<03:18,  6.19s/it]
Task 7, Epoch 9/40 => Loss 0.424, Train_accy 64.77:  22%|██▎       | 9/40 [00:58<02:55,  5.65s/it]
Task 7, Epoch 10/40 => Loss 0.385, Train_accy 67.19:  22%|██▎       | 9/40 [01:03<02:55,  5.65s/it]
Task 7, Epoch 10/40 => Loss 0.385, Train_accy 67.19:  25%|██▌       | 10/40 [01:03<02:38,  5.29s/it]
Task 7, Epoch 11/40 => Loss 0.383, Train_accy 65.38, Test_accy 69.50:  25%|██▌       | 10/40 [01:17<02:38,  5.29s/it]
Task 7, Epoch 11/40 => Loss 0.383, Train_accy 65.38, Test_accy 69.50:  28%|██▊       | 11/40 [01:17<03:48,  7.89s/it]
Task 7, Epoch 12/40 => Loss 0.381, Train_accy 66.73:  28%|██▊       | 11/40 [01:21<03:48,  7.89s/it]                 
Task 7, Epoch 12/40 => Loss 0.381, Train_accy 66.73:  30%|███       | 12/40 [01:21<03:11,  6.85s/it]
Task 7, Epoch 13/40 => Loss 0.322, Train_accy 69.34:  30%|███       | 12/40 [01:26<03:11,  6.85s/it]
Task 7, Epoch 13/40 => Loss 0.322, Train_accy 69.34:  32%|███▎      | 13/40 [01:26<02:45,  6.12s/it]
Task 7, Epoch 14/40 => Loss 0.356, Train_accy 68.36:  32%|███▎      | 13/40 [01:30<02:45,  6.12s/it]
Task 7, Epoch 14/40 => Loss 0.356, Train_accy 68.36:  35%|███▌      | 14/40 [01:30<02:25,  5.61s/it]
Task 7, Epoch 15/40 => Loss 0.326, Train_accy 67.66:  35%|███▌      | 14/40 [01:34<02:25,  5.61s/it]
Task 7, Epoch 15/40 => Loss 0.326, Train_accy 67.66:  38%|███▊      | 15/40 [01:34<02:11,  5.26s/it]
Task 7, Epoch 16/40 => Loss 0.345, Train_accy 68.64, Test_accy 69.77:  38%|███▊      | 15/40 [01:48<02:11,  5.26s/it]
Task 7, Epoch 16/40 => Loss 0.345, Train_accy 68.64, Test_accy 69.77:  40%|████      | 16/40 [01:48<03:05,  7.75s/it]
Task 7, Epoch 17/40 => Loss 0.325, Train_accy 69.57:  40%|████      | 16/40 [01:52<03:05,  7.75s/it]                 
Task 7, Epoch 17/40 => Loss 0.325, Train_accy 69.57:  42%|████▎     | 17/40 [01:52<02:35,  6.75s/it]
Task 7, Epoch 18/40 => Loss 0.338, Train_accy 69.43:  42%|████▎     | 17/40 [01:57<02:35,  6.75s/it]
Task 7, Epoch 18/40 => Loss 0.338, Train_accy 69.43:  45%|████▌     | 18/40 [01:57<02:13,  6.05s/it]
Task 7, Epoch 19/40 => Loss 0.305, Train_accy 70.27:  45%|████▌     | 18/40 [02:01<02:13,  6.05s/it]
Task 7, Epoch 19/40 => Loss 0.305, Train_accy 70.27:  48%|████▊     | 19/40 [02:01<01:56,  5.57s/it]
Task 7, Epoch 20/40 => Loss 0.309, Train_accy 70.08:  48%|████▊     | 19/40 [02:06<01:56,  5.57s/it]
Task 7, Epoch 20/40 => Loss 0.309, Train_accy 70.08:  50%|█████     | 20/40 [02:06<01:45,  5.28s/it]
Task 7, Epoch 21/40 => Loss 0.329, Train_accy 69.99, Test_accy 69.73:  50%|█████     | 20/40 [02:19<01:45,  5.28s/it]
Task 7, Epoch 21/40 => Loss 0.329, Train_accy 69.99, Test_accy 69.73:  52%|█████▎    | 21/40 [02:19<02:27,  7.77s/it]
Task 7, Epoch 22/40 => Loss 0.330, Train_accy 70.60:  52%|█████▎    | 21/40 [02:24<02:27,  7.77s/it]                 
Task 7, Epoch 22/40 => Loss 0.330, Train_accy 70.60:  55%|█████▌    | 22/40 [02:24<02:02,  6.80s/it]
Task 7, Epoch 23/40 => Loss 0.296, Train_accy 70.22:  55%|█████▌    | 22/40 [02:28<02:02,  6.80s/it]
Task 7, Epoch 23/40 => Loss 0.296, Train_accy 70.22:  57%|█████▊    | 23/40 [02:28<01:43,  6.11s/it]
Task 7, Epoch 24/40 => Loss 0.276, Train_accy 71.44:  57%|█████▊    | 23/40 [02:33<01:43,  6.11s/it]
Task 7, Epoch 24/40 => Loss 0.276, Train_accy 71.44:  60%|██████    | 24/40 [02:33<01:29,  5.61s/it]
Task 7, Epoch 25/40 => Loss 0.307, Train_accy 71.44:  60%|██████    | 24/40 [02:38<01:29,  5.61s/it]
Task 7, Epoch 25/40 => Loss 0.307, Train_accy 71.44:  62%|██████▎   | 25/40 [02:38<01:19,  5.30s/it]
Task 7, Epoch 26/40 => Loss 0.323, Train_accy 71.06, Test_accy 69.77:  62%|██████▎   | 25/40 [02:51<01:19,  5.30s/it]
Task 7, Epoch 26/40 => Loss 0.323, Train_accy 71.06, Test_accy 69.77:  65%|██████▌   | 26/40 [02:51<01:49,  7.82s/it]
Task 7, Epoch 27/40 => Loss 0.280, Train_accy 71.62:  65%|██████▌   | 26/40 [02:56<01:49,  7.82s/it]                 
Task 7, Epoch 27/40 => Loss 0.280, Train_accy 71.62:  68%|██████▊   | 27/40 [02:56<01:28,  6.83s/it]
Task 7, Epoch 28/40 => Loss 0.297, Train_accy 71.16:  68%|██████▊   | 27/40 [03:00<01:28,  6.83s/it]
Task 7, Epoch 28/40 => Loss 0.297, Train_accy 71.16:  70%|███████   | 28/40 [03:00<01:13,  6.12s/it]
Task 7, Epoch 29/40 => Loss 0.310, Train_accy 71.39:  70%|███████   | 28/40 [03:05<01:13,  6.12s/it]
Task 7, Epoch 29/40 => Loss 0.310, Train_accy 71.39:  72%|███████▎  | 29/40 [03:05<01:02,  5.64s/it]
Task 7, Epoch 30/40 => Loss 0.301, Train_accy 71.39:  72%|███████▎  | 29/40 [03:09<01:02,  5.64s/it]
Task 7, Epoch 30/40 => Loss 0.301, Train_accy 71.39:  75%|███████▌  | 30/40 [03:09<00:53,  5.31s/it]
Task 7, Epoch 31/40 => Loss 0.290, Train_accy 70.46, Test_accy 69.79:  75%|███████▌  | 30/40 [03:23<00:53,  5.31s/it]
Task 7, Epoch 31/40 => Loss 0.290, Train_accy 70.46, Test_accy 69.79:  78%|███████▊  | 31/40 [03:23<01:10,  7.84s/it]
Task 7, Epoch 32/40 => Loss 0.303, Train_accy 71.30:  78%|███████▊  | 31/40 [03:27<01:10,  7.84s/it]                 
Task 7, Epoch 32/40 => Loss 0.303, Train_accy 71.30:  80%|████████  | 32/40 [03:27<00:54,  6.81s/it]
Task 7, Epoch 33/40 => Loss 0.314, Train_accy 71.81:  80%|████████  | 32/40 [03:32<00:54,  6.81s/it]
Task 7, Epoch 33/40 => Loss 0.314, Train_accy 71.81:  82%|████████▎ | 33/40 [03:32<00:42,  6.12s/it]
Task 7, Epoch 34/40 => Loss 0.303, Train_accy 70.55:  82%|████████▎ | 33/40 [03:36<00:42,  6.12s/it]
Task 7, Epoch 34/40 => Loss 0.303, Train_accy 70.55:  85%|████████▌ | 34/40 [03:36<00:33,  5.61s/it]
Task 7, Epoch 35/40 => Loss 0.289, Train_accy 71.06:  85%|████████▌ | 34/40 [03:41<00:33,  5.61s/it]
Task 7, Epoch 35/40 => Loss 0.289, Train_accy 71.06:  88%|████████▊ | 35/40 [03:41<00:26,  5.28s/it]
Task 7, Epoch 36/40 => Loss 0.304, Train_accy 71.20, Test_accy 69.85:  88%|████████▊ | 35/40 [03:55<00:26,  5.28s/it]
Task 7, Epoch 36/40 => Loss 0.304, Train_accy 71.20, Test_accy 69.85:  90%|█████████ | 36/40 [03:55<00:31,  7.89s/it]
Task 7, Epoch 37/40 => Loss 0.282, Train_accy 71.62:  90%|█████████ | 36/40 [03:59<00:31,  7.89s/it]                 
Task 7, Epoch 37/40 => Loss 0.282, Train_accy 71.62:  92%|█████████▎| 37/40 [03:59<00:20,  6.84s/it]
Task 7, Epoch 38/40 => Loss 0.258, Train_accy 72.83:  92%|█████████▎| 37/40 [04:04<00:20,  6.84s/it]
Task 7, Epoch 38/40 => Loss 0.258, Train_accy 72.83:  95%|█████████▌| 38/40 [04:04<00:12,  6.20s/it]
Task 7, Epoch 39/40 => Loss 0.292, Train_accy 72.69:  95%|█████████▌| 38/40 [04:09<00:12,  6.20s/it]
Task 7, Epoch 39/40 => Loss 0.292, Train_accy 72.69:  98%|█████████▊| 39/40 [04:09<00:05,  5.77s/it]
Task 7, Epoch 40/40 => Loss 0.251, Train_accy 73.11:  98%|█████████▊| 39/40 [04:13<00:05,  5.77s/it]
Task 7, Epoch 40/40 => Loss 0.251, Train_accy 73.11: 100%|██████████| 40/40 [04:13<00:00,  5.38s/it]
Task 7, Epoch 40/40 => Loss 0.251, Train_accy 73.11: 100%|██████████| 40/40 [04:13<00:00,  6.34s/it]
2025-11-09 11:41:21,084 [sdfourier.py] => Task 7, Epoch 40/40 => Loss 0.251, Train_accy 73.11
2025-11-09 11:41:21,088 [trainer.py] => All params: 185987488
2025-11-09 11:41:21,089 [trainer.py] => Trainable params: 133600
2025-11-09 11:41:30,286 [trainer.py] => No NME accuracy.
2025-11-09 11:41:30,286 [trainer.py] => CNN: {'total': np.float64(69.83), '00-19': np.float64(71.8), '20-39': np.float64(71.7), '40-59': np.float64(72.49), '60-79': np.float64(65.97), '80-99': np.float64(66.5), '100-119': np.float64(70.62), '120-139': np.float64(62.33), '140-159': np.float64(75.22), 'old': np.float64(69.83), 'new': np.float64(nan)}
2025-11-09 11:41:30,286 [trainer.py] => CNN top1 curve: [np.float64(87.03), np.float64(81.26), np.float64(78.06), np.float64(74.88), np.float64(73.41), np.float64(71.8), np.float64(69.87), np.float64(69.83)]
2025-11-09 11:41:30,286 [trainer.py] => CNN top5 curve: [np.float64(95.46), np.float64(93.15), np.float64(91.43), np.float64(89.61), np.float64(88.5), np.float64(87.37), np.float64(85.84), np.float64(85.82)]

Average Accuracy (CNN): 75.7675
2025-11-09 11:41:30,286 [trainer.py] => Average Accuracy (CNN): 75.7675 

task 8
2025-11-09 11:41:30,287 [sdfourier.py] => Learning on 160-180

总共重置了 12 个模块的qkv层权重

  0%|          | 0/40 [00:00<?, ?it/s]
Task 8, Epoch 1/40 => Loss 2.351, Train_accy 10.27, Test_accy 66.21:   0%|          | 0/40 [00:14<?, ?it/s]
Task 8, Epoch 1/40 => Loss 2.351, Train_accy 10.27, Test_accy 66.21:   2%|▎         | 1/40 [00:14<09:44, 14.99s/it]
Task 8, Epoch 2/40 => Loss 0.993, Train_accy 42.27:   2%|▎         | 1/40 [00:19<09:44, 14.99s/it]                 
Task 8, Epoch 2/40 => Loss 0.993, Train_accy 42.27:   5%|▌         | 2/40 [00:19<05:43,  9.04s/it]
Task 8, Epoch 3/40 => Loss 0.849, Train_accy 49.79:   5%|▌         | 2/40 [00:24<05:43,  9.04s/it]
Task 8, Epoch 3/40 => Loss 0.849, Train_accy 49.79:   8%|▊         | 3/40 [00:24<04:23,  7.13s/it]
Task 8, Epoch 4/40 => Loss 0.743, Train_accy 50.71:   8%|▊         | 3/40 [00:29<04:23,  7.13s/it]
Task 8, Epoch 4/40 => Loss 0.743, Train_accy 50.71:  10%|█         | 4/40 [00:29<03:44,  6.24s/it]
Task 8, Epoch 5/40 => Loss 0.712, Train_accy 52.91:  10%|█         | 4/40 [00:34<03:44,  6.24s/it]
Task 8, Epoch 5/40 => Loss 0.712, Train_accy 52.91:  12%|█▎        | 5/40 [00:34<03:22,  5.77s/it]
Task 8, Epoch 6/40 => Loss 0.659, Train_accy 52.62, Test_accy 68.10:  12%|█▎        | 5/40 [00:49<03:22,  5.77s/it]
Task 8, Epoch 6/40 => Loss 0.659, Train_accy 52.62, Test_accy 68.10:  15%|█▌        | 6/40 [00:49<05:04,  8.95s/it]
Task 8, Epoch 7/40 => Loss 0.586, Train_accy 53.78:  15%|█▌        | 6/40 [00:54<05:04,  8.95s/it]                 
Task 8, Epoch 7/40 => Loss 0.586, Train_accy 53.78:  18%|█▊        | 7/40 [00:54<04:12,  7.65s/it]
Task 8, Epoch 8/40 => Loss 0.592, Train_accy 55.15:  18%|█▊        | 7/40 [00:59<04:12,  7.65s/it]
Task 8, Epoch 8/40 => Loss 0.592, Train_accy 55.15:  20%|██        | 8/40 [00:59<03:40,  6.88s/it]
Task 8, Epoch 9/40 => Loss 0.584, Train_accy 55.15:  20%|██        | 8/40 [01:04<03:40,  6.88s/it]
Task 8, Epoch 9/40 => Loss 0.584, Train_accy 55.15:  22%|██▎       | 9/40 [01:04<03:14,  6.26s/it]
Task 8, Epoch 10/40 => Loss 0.539, Train_accy 57.23:  22%|██▎       | 9/40 [01:09<03:14,  6.26s/it]
Task 8, Epoch 10/40 => Loss 0.539, Train_accy 57.23:  25%|██▌       | 10/40 [01:09<02:55,  5.84s/it]
Task 8, Epoch 11/40 => Loss 0.534, Train_accy 57.36, Test_accy 68.31:  25%|██▌       | 10/40 [01:24<02:55,  5.84s/it]
Task 8, Epoch 11/40 => Loss 0.534, Train_accy 57.36, Test_accy 68.31:  28%|██▊       | 11/40 [01:24<04:10,  8.63s/it]
Task 8, Epoch 12/40 => Loss 0.498, Train_accy 59.19:  28%|██▊       | 11/40 [01:29<04:10,  8.63s/it]                 
Task 8, Epoch 12/40 => Loss 0.498, Train_accy 59.19:  30%|███       | 12/40 [01:29<03:30,  7.50s/it]
Task 8, Epoch 13/40 => Loss 0.507, Train_accy 59.39:  30%|███       | 12/40 [01:34<03:30,  7.50s/it]
Task 8, Epoch 13/40 => Loss 0.507, Train_accy 59.39:  32%|███▎      | 13/40 [01:34<03:01,  6.72s/it]
Task 8, Epoch 14/40 => Loss 0.487, Train_accy 58.48:  32%|███▎      | 13/40 [01:39<03:01,  6.72s/it]
Task 8, Epoch 14/40 => Loss 0.487, Train_accy 58.48:  35%|███▌      | 14/40 [01:39<02:40,  6.19s/it]
Task 8, Epoch 15/40 => Loss 0.476, Train_accy 61.47:  35%|███▌      | 14/40 [01:44<02:40,  6.19s/it]
Task 8, Epoch 15/40 => Loss 0.476, Train_accy 61.47:  38%|███▊      | 15/40 [01:44<02:24,  5.78s/it]
Task 8, Epoch 16/40 => Loss 0.482, Train_accy 61.18, Test_accy 68.34:  38%|███▊      | 15/40 [01:59<02:24,  5.78s/it]
Task 8, Epoch 16/40 => Loss 0.482, Train_accy 61.18, Test_accy 68.34:  40%|████      | 16/40 [01:59<03:25,  8.56s/it]
Task 8, Epoch 17/40 => Loss 0.478, Train_accy 60.22:  40%|████      | 16/40 [02:04<03:25,  8.56s/it]                 
Task 8, Epoch 17/40 => Loss 0.478, Train_accy 60.22:  42%|████▎     | 17/40 [02:04<02:51,  7.47s/it]
Task 8, Epoch 18/40 => Loss 0.467, Train_accy 61.68:  42%|████▎     | 17/40 [02:09<02:51,  7.47s/it]
Task 8, Epoch 18/40 => Loss 0.467, Train_accy 61.68:  45%|████▌     | 18/40 [02:09<02:27,  6.71s/it]
Task 8, Epoch 19/40 => Loss 0.457, Train_accy 62.05:  45%|████▌     | 18/40 [02:14<02:27,  6.71s/it]
Task 8, Epoch 19/40 => Loss 0.457, Train_accy 62.05:  48%|████▊     | 19/40 [02:14<02:09,  6.17s/it]
Task 8, Epoch 20/40 => Loss 0.450, Train_accy 62.76:  48%|████▊     | 19/40 [02:19<02:09,  6.17s/it]
Task 8, Epoch 20/40 => Loss 0.450, Train_accy 62.76:  50%|█████     | 20/40 [02:19<01:56,  5.84s/it]
Task 8, Epoch 21/40 => Loss 0.446, Train_accy 61.64, Test_accy 68.55:  50%|█████     | 20/40 [02:34<01:56,  5.84s/it]
Task 8, Epoch 21/40 => Loss 0.446, Train_accy 61.64, Test_accy 68.55:  52%|█████▎    | 21/40 [02:34<02:44,  8.66s/it]
Task 8, Epoch 22/40 => Loss 0.443, Train_accy 63.34:  52%|█████▎    | 21/40 [02:39<02:44,  8.66s/it]                 
Task 8, Epoch 22/40 => Loss 0.443, Train_accy 63.34:  55%|█████▌    | 22/40 [02:39<02:16,  7.56s/it]
Task 8, Epoch 23/40 => Loss 0.447, Train_accy 63.47:  55%|█████▌    | 22/40 [02:44<02:16,  7.56s/it]
Task 8, Epoch 23/40 => Loss 0.447, Train_accy 63.47:  57%|█████▊    | 23/40 [02:44<01:55,  6.78s/it]
Task 8, Epoch 24/40 => Loss 0.465, Train_accy 61.85:  57%|█████▊    | 23/40 [02:49<01:55,  6.78s/it]
Task 8, Epoch 24/40 => Loss 0.465, Train_accy 61.85:  60%|██████    | 24/40 [02:49<01:40,  6.26s/it]
Task 8, Epoch 25/40 => Loss 0.436, Train_accy 63.26:  60%|██████    | 24/40 [02:54<01:40,  6.26s/it]
Task 8, Epoch 25/40 => Loss 0.436, Train_accy 63.26:  62%|██████▎   | 25/40 [02:54<01:29,  5.94s/it]
Task 8, Epoch 26/40 => Loss 0.419, Train_accy 63.13, Test_accy 68.38:  62%|██████▎   | 25/40 [03:09<01:29,  5.94s/it]
Task 8, Epoch 26/40 => Loss 0.419, Train_accy 63.13, Test_accy 68.38:  65%|██████▌   | 26/40 [03:09<02:02,  8.74s/it]
Task 8, Epoch 27/40 => Loss 0.421, Train_accy 63.47:  65%|██████▌   | 26/40 [03:14<02:02,  8.74s/it]                 
Task 8, Epoch 27/40 => Loss 0.421, Train_accy 63.47:  68%|██████▊   | 27/40 [03:14<01:38,  7.61s/it]
Task 8, Epoch 28/40 => Loss 0.413, Train_accy 63.63:  68%|██████▊   | 27/40 [03:19<01:38,  7.61s/it]
Task 8, Epoch 28/40 => Loss 0.413, Train_accy 63.63:  70%|███████   | 28/40 [03:19<01:22,  6.86s/it]
Task 8, Epoch 29/40 => Loss 0.412, Train_accy 63.92:  70%|███████   | 28/40 [03:24<01:22,  6.86s/it]
Task 8, Epoch 29/40 => Loss 0.412, Train_accy 63.92:  72%|███████▎  | 29/40 [03:24<01:08,  6.27s/it]
Task 8, Epoch 30/40 => Loss 0.379, Train_accy 64.63:  72%|███████▎  | 29/40 [03:29<01:08,  6.27s/it]
Task 8, Epoch 30/40 => Loss 0.379, Train_accy 64.63:  75%|███████▌  | 30/40 [03:29<00:58,  5.90s/it]
Task 8, Epoch 31/40 => Loss 0.402, Train_accy 65.09, Test_accy 68.38:  75%|███████▌  | 30/40 [03:44<00:58,  5.90s/it]
Task 8, Epoch 31/40 => Loss 0.402, Train_accy 65.09, Test_accy 68.38:  78%|███████▊  | 31/40 [03:44<01:18,  8.67s/it]
Task 8, Epoch 32/40 => Loss 0.425, Train_accy 64.46:  78%|███████▊  | 31/40 [03:49<01:18,  8.67s/it]                 
Task 8, Epoch 32/40 => Loss 0.425, Train_accy 64.46:  80%|████████  | 32/40 [03:49<01:00,  7.54s/it]
Task 8, Epoch 33/40 => Loss 0.387, Train_accy 65.59:  80%|████████  | 32/40 [03:54<01:00,  7.54s/it]
Task 8, Epoch 33/40 => Loss 0.387, Train_accy 65.59:  82%|████████▎ | 33/40 [03:54<00:47,  6.75s/it]
Task 8, Epoch 34/40 => Loss 0.404, Train_accy 64.51:  82%|████████▎ | 33/40 [04:00<00:47,  6.75s/it]
Task 8, Epoch 34/40 => Loss 0.404, Train_accy 64.51:  85%|████████▌ | 34/40 [04:00<00:38,  6.34s/it]
Task 8, Epoch 35/40 => Loss 0.401, Train_accy 63.72:  85%|████████▌ | 34/40 [04:05<00:38,  6.34s/it]
Task 8, Epoch 35/40 => Loss 0.401, Train_accy 63.72:  88%|████████▊ | 35/40 [04:05<00:29,  5.91s/it]
Task 8, Epoch 36/40 => Loss 0.386, Train_accy 63.80, Test_accy 68.46:  88%|████████▊ | 35/40 [04:20<00:29,  5.91s/it]
Task 8, Epoch 36/40 => Loss 0.386, Train_accy 63.80, Test_accy 68.46:  90%|█████████ | 36/40 [04:20<00:35,  8.78s/it]
Task 8, Epoch 37/40 => Loss 0.371, Train_accy 64.75:  90%|█████████ | 36/40 [04:25<00:35,  8.78s/it]                 
Task 8, Epoch 37/40 => Loss 0.371, Train_accy 64.75:  92%|█████████▎| 37/40 [04:25<00:22,  7.64s/it]
Task 8, Epoch 38/40 => Loss 0.378, Train_accy 65.50:  92%|█████████▎| 37/40 [04:30<00:22,  7.64s/it]
Task 8, Epoch 38/40 => Loss 0.378, Train_accy 65.50:  95%|█████████▌| 38/40 [04:30<00:13,  6.82s/it]
Task 8, Epoch 39/40 => Loss 0.404, Train_accy 65.38:  95%|█████████▌| 38/40 [04:35<00:13,  6.82s/it]
Task 8, Epoch 39/40 => Loss 0.404, Train_accy 65.38:  98%|█████████▊| 39/40 [04:35<00:06,  6.24s/it]
Task 8, Epoch 40/40 => Loss 0.426, Train_accy 64.34:  98%|█████████▊| 39/40 [04:40<00:06,  6.24s/it]
Task 8, Epoch 40/40 => Loss 0.426, Train_accy 64.34: 100%|██████████| 40/40 [04:40<00:00,  5.89s/it]
Task 8, Epoch 40/40 => Loss 0.426, Train_accy 64.34: 100%|██████████| 40/40 [04:40<00:00,  7.01s/it]
2025-11-09 11:46:11,907 [sdfourier.py] => Task 8, Epoch 40/40 => Loss 0.426, Train_accy 64.34
2025-11-09 11:46:11,911 [trainer.py] => All params: 186021108
2025-11-09 11:46:11,912 [trainer.py] => Trainable params: 148980
2025-11-09 11:46:22,271 [trainer.py] => No NME accuracy.
2025-11-09 11:46:22,271 [trainer.py] => CNN: {'total': np.float64(68.44), '00-19': np.float64(70.99), '20-39': np.float64(70.4), '40-59': np.float64(71.72), '60-79': np.float64(65.37), '80-99': np.float64(66.0), '100-119': np.float64(70.0), '120-139': np.float64(60.78), '140-159': np.float64(75.22), '160-179': np.float64(63.55), 'old': np.float64(68.44), 'new': np.float64(nan)}
2025-11-09 11:46:22,271 [trainer.py] => CNN top1 curve: [np.float64(87.03), np.float64(81.26), np.float64(78.06), np.float64(74.88), np.float64(73.41), np.float64(71.8), np.float64(69.87), np.float64(69.83), np.float64(68.44)]
2025-11-09 11:46:22,271 [trainer.py] => CNN top5 curve: [np.float64(95.46), np.float64(93.15), np.float64(91.43), np.float64(89.61), np.float64(88.5), np.float64(87.37), np.float64(85.84), np.float64(85.82), np.float64(84.45)]

Average Accuracy (CNN): 74.95333333333332
2025-11-09 11:46:22,271 [trainer.py] => Average Accuracy (CNN): 74.95333333333332 

task 9
2025-11-09 11:46:22,273 [sdfourier.py] => Learning on 180-200

总共重置了 12 个模块的qkv层权重

  0%|          | 0/40 [00:00<?, ?it/s]
Task 9, Epoch 1/40 => Loss 1.913, Train_accy 17.29, Test_accy 66.30:   0%|          | 0/40 [00:16<?, ?it/s]
Task 9, Epoch 1/40 => Loss 1.913, Train_accy 17.29, Test_accy 66.30:   2%|▎         | 1/40 [00:16<10:51, 16.71s/it]
Task 9, Epoch 2/40 => Loss 0.704, Train_accy 52.87:   2%|▎         | 1/40 [00:22<10:51, 16.71s/it]                 
Task 9, Epoch 2/40 => Loss 0.704, Train_accy 52.87:   5%|▌         | 2/40 [00:22<06:23, 10.08s/it]
Task 9, Epoch 3/40 => Loss 0.585, Train_accy 58.46:   5%|▌         | 2/40 [00:27<06:23, 10.08s/it]
Task 9, Epoch 3/40 => Loss 0.585, Train_accy 58.46:   8%|▊         | 3/40 [00:27<04:52,  7.90s/it]
Task 9, Epoch 4/40 => Loss 0.538, Train_accy 58.53:   8%|▊         | 3/40 [00:32<04:52,  7.90s/it]
Task 9, Epoch 4/40 => Loss 0.538, Train_accy 58.53:  10%|█         | 4/40 [00:32<04:07,  6.86s/it]
Task 9, Epoch 5/40 => Loss 0.464, Train_accy 60.89:  10%|█         | 4/40 [00:38<04:07,  6.86s/it]
Task 9, Epoch 5/40 => Loss 0.464, Train_accy 60.89:  12%|█▎        | 5/40 [00:38<03:41,  6.32s/it]
Task 9, Epoch 6/40 => Loss 0.443, Train_accy 60.59, Test_accy 67.82:  12%|█▎        | 5/40 [00:54<03:41,  6.32s/it]
Task 9, Epoch 6/40 => Loss 0.443, Train_accy 60.59, Test_accy 67.82:  15%|█▌        | 6/40 [00:54<05:35,  9.87s/it]
Task 9, Epoch 7/40 => Loss 0.450, Train_accy 62.87:  15%|█▌        | 6/40 [01:00<05:35,  9.87s/it]                 
Task 9, Epoch 7/40 => Loss 0.450, Train_accy 62.87:  18%|█▊        | 7/40 [01:00<04:37,  8.40s/it]
Task 9, Epoch 8/40 => Loss 0.402, Train_accy 63.13:  18%|█▊        | 7/40 [01:05<04:37,  8.40s/it]
Task 9, Epoch 8/40 => Loss 0.402, Train_accy 63.13:  20%|██        | 8/40 [01:05<03:57,  7.42s/it]
Task 9, Epoch 9/40 => Loss 0.395, Train_accy 63.85:  20%|██        | 8/40 [01:10<03:57,  7.42s/it]
Task 9, Epoch 9/40 => Loss 0.395, Train_accy 63.85:  22%|██▎       | 9/40 [01:10<03:30,  6.78s/it]
Task 9, Epoch 10/40 => Loss 0.393, Train_accy 63.85:  22%|██▎       | 9/40 [01:16<03:30,  6.78s/it]
Task 9, Epoch 10/40 => Loss 0.393, Train_accy 63.85:  25%|██▌       | 10/40 [01:16<03:09,  6.30s/it]
Task 9, Epoch 11/40 => Loss 0.354, Train_accy 65.26, Test_accy 68.25:  25%|██▌       | 10/40 [01:32<03:09,  6.30s/it]
Task 9, Epoch 11/40 => Loss 0.354, Train_accy 65.26, Test_accy 68.25:  28%|██▊       | 11/40 [01:32<04:32,  9.41s/it]
Task 9, Epoch 12/40 => Loss 0.325, Train_accy 66.51:  28%|██▊       | 11/40 [01:37<04:32,  9.41s/it]                 
Task 9, Epoch 12/40 => Loss 0.325, Train_accy 66.51:  30%|███       | 12/40 [01:37<03:48,  8.17s/it]
Task 9, Epoch 13/40 => Loss 0.351, Train_accy 65.94:  30%|███       | 12/40 [01:43<03:48,  8.17s/it]
Task 9, Epoch 13/40 => Loss 0.351, Train_accy 65.94:  32%|███▎      | 13/40 [01:43<03:16,  7.29s/it]
Task 9, Epoch 14/40 => Loss 0.361, Train_accy 66.25:  32%|███▎      | 13/40 [01:48<03:16,  7.29s/it]
Task 9, Epoch 14/40 => Loss 0.361, Train_accy 66.25:  35%|███▌      | 14/40 [01:48<02:54,  6.69s/it]
Task 9, Epoch 15/40 => Loss 0.345, Train_accy 67.20:  35%|███▌      | 14/40 [01:53<02:54,  6.69s/it]
Task 9, Epoch 15/40 => Loss 0.345, Train_accy 67.20:  38%|███▊      | 15/40 [01:53<02:36,  6.27s/it]
Task 9, Epoch 16/40 => Loss 0.353, Train_accy 66.51, Test_accy 68.15:  38%|███▊      | 15/40 [02:10<02:36,  6.27s/it]
Task 9, Epoch 16/40 => Loss 0.353, Train_accy 66.51, Test_accy 68.15:  40%|████      | 16/40 [02:10<03:45,  9.40s/it]
Task 9, Epoch 17/40 => Loss 0.317, Train_accy 68.45:  40%|████      | 16/40 [02:15<03:45,  9.40s/it]                 
Task 9, Epoch 17/40 => Loss 0.317, Train_accy 68.45:  42%|████▎     | 17/40 [02:15<03:07,  8.17s/it]
Task 9, Epoch 18/40 => Loss 0.335, Train_accy 66.82:  42%|████▎     | 17/40 [02:21<03:07,  8.17s/it]
Task 9, Epoch 18/40 => Loss 0.335, Train_accy 66.82:  45%|████▌     | 18/40 [02:21<02:40,  7.30s/it]
Task 9, Epoch 19/40 => Loss 0.330, Train_accy 69.63:  45%|████▌     | 18/40 [02:26<02:40,  7.30s/it]
Task 9, Epoch 19/40 => Loss 0.330, Train_accy 69.63:  48%|████▊     | 19/40 [02:26<02:20,  6.69s/it]
Task 9, Epoch 20/40 => Loss 0.299, Train_accy 69.63:  48%|████▊     | 19/40 [02:31<02:20,  6.69s/it]
Task 9, Epoch 20/40 => Loss 0.299, Train_accy 69.63:  50%|█████     | 20/40 [02:31<02:06,  6.31s/it]
Task 9, Epoch 21/40 => Loss 0.303, Train_accy 70.13, Test_accy 68.07:  50%|█████     | 20/40 [02:48<02:06,  6.31s/it]
Task 9, Epoch 21/40 => Loss 0.303, Train_accy 70.13, Test_accy 68.07:  52%|█████▎    | 21/40 [02:48<02:59,  9.44s/it]
Task 9, Epoch 22/40 => Loss 0.303, Train_accy 70.47:  52%|█████▎    | 21/40 [02:54<02:59,  9.44s/it]                 
Task 9, Epoch 22/40 => Loss 0.303, Train_accy 70.47:  55%|█████▌    | 22/40 [02:54<02:29,  8.31s/it]
Task 9, Epoch 23/40 => Loss 0.322, Train_accy 69.44:  55%|█████▌    | 22/40 [02:59<02:29,  8.31s/it]
Task 9, Epoch 23/40 => Loss 0.322, Train_accy 69.44:  57%|█████▊    | 23/40 [02:59<02:07,  7.52s/it]
Task 9, Epoch 24/40 => Loss 0.302, Train_accy 70.70:  57%|█████▊    | 23/40 [03:05<02:07,  7.52s/it]
Task 9, Epoch 24/40 => Loss 0.302, Train_accy 70.70:  60%|██████    | 24/40 [03:05<01:49,  6.87s/it]
Task 9, Epoch 25/40 => Loss 0.282, Train_accy 70.35:  60%|██████    | 24/40 [03:10<01:49,  6.87s/it]
Task 9, Epoch 25/40 => Loss 0.282, Train_accy 70.35:  62%|██████▎   | 25/40 [03:10<01:35,  6.40s/it]
Task 9, Epoch 26/40 => Loss 0.307, Train_accy 69.48, Test_accy 68.17:  62%|██████▎   | 25/40 [03:27<01:35,  6.40s/it]
Task 9, Epoch 26/40 => Loss 0.307, Train_accy 69.48, Test_accy 68.17:  65%|██████▌   | 26/40 [03:27<02:13,  9.51s/it]
Task 9, Epoch 27/40 => Loss 0.274, Train_accy 70.35:  65%|██████▌   | 26/40 [03:32<02:13,  9.51s/it]                 
Task 9, Epoch 27/40 => Loss 0.274, Train_accy 70.35:  68%|██████▊   | 27/40 [03:32<01:47,  8.29s/it]
Task 9, Epoch 28/40 => Loss 0.267, Train_accy 71.04:  68%|██████▊   | 27/40 [03:38<01:47,  8.29s/it]
Task 9, Epoch 28/40 => Loss 0.267, Train_accy 71.04:  70%|███████   | 28/40 [03:38<01:29,  7.43s/it]
Task 9, Epoch 29/40 => Loss 0.294, Train_accy 71.34:  70%|███████   | 28/40 [03:43<01:29,  7.43s/it]
Task 9, Epoch 29/40 => Loss 0.294, Train_accy 71.34:  72%|███████▎  | 29/40 [03:43<01:14,  6.80s/it]
Task 9, Epoch 30/40 => Loss 0.273, Train_accy 71.15:  72%|███████▎  | 29/40 [03:48<01:14,  6.80s/it]
Task 9, Epoch 30/40 => Loss 0.273, Train_accy 71.15:  75%|███████▌  | 30/40 [03:48<01:03,  6.34s/it]
Task 9, Epoch 31/40 => Loss 0.309, Train_accy 69.94, Test_accy 68.18:  75%|███████▌  | 30/40 [04:05<01:03,  6.34s/it]
Task 9, Epoch 31/40 => Loss 0.309, Train_accy 69.94, Test_accy 68.18:  78%|███████▊  | 31/40 [04:05<01:25,  9.49s/it]
Task 9, Epoch 32/40 => Loss 0.284, Train_accy 69.90:  78%|███████▊  | 31/40 [04:10<01:25,  9.49s/it]                 
Task 9, Epoch 32/40 => Loss 0.284, Train_accy 69.90:  80%|████████  | 32/40 [04:10<01:05,  8.23s/it]
Task 9, Epoch 33/40 => Loss 0.299, Train_accy 69.71:  80%|████████  | 32/40 [04:16<01:05,  8.23s/it]
Task 9, Epoch 33/40 => Loss 0.299, Train_accy 69.71:  82%|████████▎ | 33/40 [04:16<00:51,  7.34s/it]
Task 9, Epoch 34/40 => Loss 0.300, Train_accy 69.02:  82%|████████▎ | 33/40 [04:21<00:51,  7.34s/it]
Task 9, Epoch 34/40 => Loss 0.300, Train_accy 69.02:  85%|████████▌ | 34/40 [04:21<00:40,  6.77s/it]
Task 9, Epoch 35/40 => Loss 0.274, Train_accy 71.11:  85%|████████▌ | 34/40 [04:26<00:40,  6.77s/it]
Task 9, Epoch 35/40 => Loss 0.274, Train_accy 71.11:  88%|████████▊ | 35/40 [04:26<00:31,  6.33s/it]
Task 9, Epoch 36/40 => Loss 0.312, Train_accy 68.91, Test_accy 68.22:  88%|████████▊ | 35/40 [04:43<00:31,  6.33s/it]
Task 9, Epoch 36/40 => Loss 0.312, Train_accy 68.91, Test_accy 68.22:  90%|█████████ | 36/40 [04:43<00:37,  9.40s/it]
Task 9, Epoch 37/40 => Loss 0.250, Train_accy 71.68:  90%|█████████ | 36/40 [04:48<00:37,  9.40s/it]                 
Task 9, Epoch 37/40 => Loss 0.250, Train_accy 71.68:  92%|█████████▎| 37/40 [04:48<00:24,  8.20s/it]
Task 9, Epoch 38/40 => Loss 0.281, Train_accy 71.04:  92%|█████████▎| 37/40 [04:54<00:24,  8.20s/it]
Task 9, Epoch 38/40 => Loss 0.281, Train_accy 71.04:  95%|█████████▌| 38/40 [04:54<00:14,  7.35s/it]
Task 9, Epoch 39/40 => Loss 0.276, Train_accy 69.71:  95%|█████████▌| 38/40 [04:59<00:14,  7.35s/it]
Task 9, Epoch 39/40 => Loss 0.276, Train_accy 69.71:  98%|█████████▊| 39/40 [04:59<00:06,  6.72s/it]
Task 9, Epoch 40/40 => Loss 0.261, Train_accy 71.57:  98%|█████████▊| 39/40 [05:04<00:06,  6.72s/it]
Task 9, Epoch 40/40 => Loss 0.261, Train_accy 71.57: 100%|██████████| 40/40 [05:04<00:00,  6.32s/it]
Task 9, Epoch 40/40 => Loss 0.261, Train_accy 71.57: 100%|██████████| 40/40 [05:04<00:00,  7.62s/it]
2025-11-09 11:51:28,564 [sdfourier.py] => Task 9, Epoch 40/40 => Loss 0.261, Train_accy 71.57
2025-11-09 11:51:28,568 [trainer.py] => All params: 186055688
2025-11-09 11:51:28,569 [trainer.py] => Trainable params: 164360
2025-11-09 11:51:40,053 [trainer.py] => No NME accuracy.
2025-11-09 11:51:40,053 [trainer.py] => CNN: {'total': np.float64(68.2), '00-19': np.float64(69.85), '20-39': np.float64(69.4), '40-59': np.float64(71.25), '60-79': np.float64(64.32), '80-99': np.float64(65.25), '100-119': np.float64(69.06), '120-139': np.float64(59.61), '140-159': np.float64(75.04), '160-179': np.float64(63.21), '180-199': np.float64(72.67), 'old': np.float64(68.2), 'new': np.float64(nan)}
2025-11-09 11:51:40,053 [trainer.py] => CNN top1 curve: [np.float64(87.03), np.float64(81.26), np.float64(78.06), np.float64(74.88), np.float64(73.41), np.float64(71.8), np.float64(69.87), np.float64(69.83), np.float64(68.44), np.float64(68.2)]
2025-11-09 11:51:40,053 [trainer.py] => CNN top5 curve: [np.float64(95.46), np.float64(93.15), np.float64(91.43), np.float64(89.61), np.float64(88.5), np.float64(87.37), np.float64(85.84), np.float64(85.82), np.float64(84.45), np.float64(84.1)]

Average Accuracy (CNN): 74.27799999999999
2025-11-09 11:51:40,053 [trainer.py] => Average Accuracy (CNN): 74.27799999999999 

Accuracy Matrix (CNN):
[[87.03 80.55 76.5  75.04 74.07 72.93 72.45 71.8  70.99 69.85]
 [ 0.   81.9  78.45 76.58 75.86 72.5  71.56 70.62 70.   69.06]
 [ 0.    0.   79.13 77.43 76.66 74.28 63.11 62.33 60.78 59.61]
 [ 0.    0.    0.   70.46 69.27 73.88 72.56 75.22 75.22 75.04]
 [ 0.    0.    0.    0.   69.75 67.32 73.42 71.7  63.55 63.21]
 [ 0.    0.    0.    0.    0.   68.75 66.12 72.49 70.4  72.67]
 [ 0.    0.    0.    0.    0.    0.   67.75 65.97 71.72 69.4 ]
 [ 0.    0.    0.    0.    0.    0.    0.   66.5  65.37 71.25]
 [ 0.    0.    0.    0.    0.    0.    0.    0.   66.   64.32]
 [ 0.    0.    0.    0.    0.    0.    0.    0.    0.   65.25]]
2025-11-09 11:51:40,054 [trainer.py] => Forgetting (CNN): 7.1033333333333335